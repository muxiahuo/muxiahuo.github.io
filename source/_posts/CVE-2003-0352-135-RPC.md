---
title: CVE-2003-0352(135 RPC)
date: 2024-09-26 21:05:29
categories:
- 渗透
tags:
- CVE
description: " "
---

#### 漏洞介绍

​     Microsoft的RPC(远程调用协议)部分在通过TCP/IP处理信息交换时存在问题，远程攻击者可以利用这个漏洞以本地系统权限在系统上执行任意指令。

####     漏洞影响

​    	Microsoft Windows XP Professional SP1

​            Microsoft Windows XP Professional

​            Microsoft Windows XP Home SP1

​    	Microsoft Windows XP Home

​    	Microsoft Windows XP

​    	Microsoft Windows NT 4.0SP6a

​    	Microsoft Windows NT 4.0SP6

​    	Microsoft Windows NT 4.0SP5

​    	Microsoft Windows NT 4.0SP4

​    	Microsoft Windows NT 4.0SP3

​    	Microsoft Windows NT 4.0SP2

​    	Microsoft Windows NT 4.0SP1

​            Microsoft Windows NT 4.0

​    	Microsoft Windows 2003

​    	Microsoft Windows 2000SP3

​    	Microsoft Windows 2000SP2

​    	Microsoft Windows 2000SP1

​    	Microsoft Windows 2000

####   漏洞原理

​      微软修改dcerpc框架后形成自己的RPC框架来处理进程间的通信。微软的RPC框架在处理TCP/IP信息交换过程中存在的畸形消息时，未正确处理，导致缓冲区溢出漏洞；此漏洞影响使用RPC框架的DCOM接口，DCOM接口用来处理客户端机器发送给服务器的DCOM对象激活请求，如UNC路径。

####   漏洞复现

​     

![img](https://hynuxtsec.feishu.cn/space/api/box/stream/download/asynccode/?code=NzQ2NmMwNzI1N2JkMDRhYTcwNjg1NWRmNDZmYzI5NDJfbmRKWUd0a0kwMDd3N3NDMTlhZ3J1THZBUEZjRkNEZVNfVG9rZW46THczOGJjcDVab3JtcVh4Ynl6MmNRYmNPbm5nXzE3MjczNTYwMjI6MTcyNzM1OTYyMl9WNA)

​	先测试是否能ping通

![img](https://hynuxtsec.feishu.cn/space/api/box/stream/download/asynccode/?code=ZGE2MDE5MTUxZTQzNjI5MDc2NmM4YTQ2NGRkMjBhZGFfZ2ZRRmViU3NBVGxPT2p5Z2JxcFhrSXNERHQ2YTNEQzBfVG9rZW46VWFjUGJ0T2hFb1NJZHB4Sk5hVWNYa1dYbndnXzE3MjczNTYwMjI6MTcyNzM1OTYyMl9WNA)

 	扫描发现RPC服务开放，优先攻击1024以下的，也就是135端口

![img](https://hynuxtsec.feishu.cn/space/api/box/stream/download/asynccode/?code=NDE0NGY1YWI0ZTE2ZmIxNTJjNGY5N2M5MDE0NWEwZmVfMTlHQzBKTVVhUVRVUlN2STM1c0Fmdk92WEdwek16cVJfVG9rZW46UVNDUWJpMndpbzVUZDB4U0t1VGNmWkI0bkxmXzE3MjczNTYwMjI6MTcyNzM1OTYyMl9WNA)

​	使用msf模块，搜索RPC漏洞ms03_026_dcom

![img](https://hynuxtsec.feishu.cn/space/api/box/stream/download/asynccode/?code=N2IxZGQzZmQwYmJhMGY3MDRlZmY2N2YxMDYyZDliZDNfOURVVUZXdDZXUnpsTzAxSDJCSmJVZklxVGVNMjFBaWxfVG9rZW46SnBkSmI5aTVUb2wxTDl4Q0VjVWNwa3FybnhmXzE3MjczNTYwMjI6MTcyNzM1OTYyMl9WNA)

​	分别设置目标IP和端口

![img](https://hynuxtsec.feishu.cn/space/api/box/stream/download/asynccode/?code=NWI5ZTU2YTVkODc0NGVhYmM3MjgwMWIyMjg3N2ZiMDdfNFBtZ3JuVmtXazZ5eGZKUzZFbGtLc2loTGFZakhxUURfVG9rZW46WWxBN2JsV1dFb0xua0t4N3dOd2MzazRzblViXzE3MjczNTYwMjI6MTcyNzM1OTYyMl9WNA)

​	漏洞利用成功，但没有创建对话
​	推测可能不在同一个网段内（但能ping到）

![img](https://hynuxtsec.feishu.cn/space/api/box/stream/download/asynccode/?code=N2ZlNmM0YzNjM2QxYjRkN2FjM2JmZDY1MjIzOTA2M2FfSmRnS0FJY0NGR1ZMUUpCYWJWZmtiZ1dKUk1zYVdsTHdfVG9rZW46TkZHZWI5T3ZUb0NncVB4TmJvb2NGb3Y2bkxjXzE3MjczNTYwMjI6MTcyNzM1OTYyMl9WNA)

​	也不行

![img](https://hynuxtsec.feishu.cn/space/api/box/stream/download/asynccode/?code=ZjliZjljNmJiNThiY2JiNzZlYmRkNjlmNjQ0YTc5MzRfTXJPNnNXV3NzdUhYNDN1R2lSampvTlZGcGJZdTMyUldfVG9rZW46VFJwOWJPNE11b2NlNDN4SFdmZGNpS0w2bnRXXzE3MjczNTYwMjI6MTcyNzM1OTYyMl9WNA)

​	切换payload试一下，果然行了   set payload generic/shell_bind_tcp

![img](https://hynuxtsec.feishu.cn/space/api/box/stream/download/asynccode/?code=ZTM0YjIzOWUxNDM2ZjgwMmRjMjk1NDM2ZjE4MDU5NDNfNkNLUEpydlZiN0hVYWlqMm1lbWtBNFlOMmR2dmdFajdfVG9rZW46S0IyZmJrQmNBbzhSRnh4T2tCaWNQbDFabjNkXzE3MjczNTYwMjI6MTcyNzM1OTYyMl9WNA)

​	用type看flag.txt ,不然会是乱码
